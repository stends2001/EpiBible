<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Case Study: Dengue Fever in Brazil | Epidemiology in R: A Hands-on Approach</title>
  <meta name="description" content="Chapter 9 Case Study: Dengue Fever in Brazil | Epidemiology in R: A Hands-on Approach" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Case Study: Dengue Fever in Brazil | Epidemiology in R: A Hands-on Approach" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Case Study: Dengue Fever in Brazil | Epidemiology in R: A Hands-on Approach" />
  
  
  

<meta name="author" content="Sten de Schrijver" />


<meta name="date" content="2025-08-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="working-with-epidemiological-data.html"/>
<link rel="next" href="modelling.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Epidemiology in R: A Hands-on Approach</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="about-the-author.html"><a href="about-the-author.html"><i class="fa fa-check"></i>About the Author</a></li>
<li class="chapter" data-level="1" data-path="introduction-to-epidemiology.html"><a href="introduction-to-epidemiology.html"><i class="fa fa-check"></i><b>1</b> Introduction to Epidemiology</a></li>
<li class="chapter" data-level="2" data-path="working-with-this-book.html"><a href="working-with-this-book.html"><i class="fa fa-check"></i><b>2</b> Working with this book</a>
<ul>
<li class="chapter" data-level="2.1" data-path="working-with-this-book.html"><a href="working-with-this-book.html#what-is-bookdown"><i class="fa fa-check"></i><b>2.1</b> What is bookdown?</a></li>
<li class="chapter" data-level="2.2" data-path="working-with-this-book.html"><a href="working-with-this-book.html#code-snippets"><i class="fa fa-check"></i><b>2.2</b> Code snippets</a></li>
<li class="chapter" data-level="2.3" data-path="working-with-this-book.html"><a href="working-with-this-book.html#a-hands-on-approach"><i class="fa fa-check"></i><b>2.3</b> A Hand’s-on Approach</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html"><i class="fa fa-check"></i><b>3</b> Getting Started with R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#installing-r-and-rstudio"><i class="fa fa-check"></i><b>3.1</b> Installing R and Rstudio</a></li>
<li class="chapter" data-level="3.2" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#starting-to-code"><i class="fa fa-check"></i><b>3.2</b> Starting to code</a></li>
<li class="chapter" data-level="3.3" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#r-projects-and-organization"><i class="fa fa-check"></i><b>3.3</b> R Projects and Organization</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="r-fundamentals.html"><a href="r-fundamentals.html"><i class="fa fa-check"></i><b>4</b> R fundamentals</a>
<ul>
<li class="chapter" data-level="4.1" data-path="r-fundamentals.html"><a href="r-fundamentals.html#basic-datatypes-in-r"><i class="fa fa-check"></i><b>4.1</b> Basic Datatypes in R</a></li>
<li class="chapter" data-level="4.2" data-path="r-fundamentals.html"><a href="r-fundamentals.html#special-datatypes"><i class="fa fa-check"></i><b>4.2</b> Special datatypes</a></li>
<li class="chapter" data-level="4.3" data-path="r-fundamentals.html"><a href="r-fundamentals.html#converting-between-datatypes"><i class="fa fa-check"></i><b>4.3</b> Converting between datatypes</a></li>
<li class="chapter" data-level="4.4" data-path="r-fundamentals.html"><a href="r-fundamentals.html#data-structures-in-r"><i class="fa fa-check"></i><b>4.4</b> Data structures in R</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="r-fundamentals.html"><a href="r-fundamentals.html#vectors-the-building-blocks"><i class="fa fa-check"></i><b>4.4.1</b> Vectors: The Building Blocks</a></li>
<li class="chapter" data-level="4.4.2" data-path="r-fundamentals.html"><a href="r-fundamentals.html#lists-mixed-data-collections"><i class="fa fa-check"></i><b>4.4.2</b> Lists: Mixed Data Collections</a></li>
<li class="chapter" data-level="4.4.3" data-path="r-fundamentals.html"><a href="r-fundamentals.html#data-frames-the-excel-of-r"><i class="fa fa-check"></i><b>4.4.3</b> Data Frames: The Excel of R</a></li>
<li class="chapter" data-level="4.4.4" data-path="r-fundamentals.html"><a href="r-fundamentals.html#indexing-accessing-your-data"><i class="fa fa-check"></i><b>4.4.4</b> Indexing: Accessing Your Data</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="r-fundamentals.html"><a href="r-fundamentals.html#conditions-and-comparisons"><i class="fa fa-check"></i><b>4.5</b> Conditions and Comparisons</a></li>
<li class="chapter" data-level="4.6" data-path="r-fundamentals.html"><a href="r-fundamentals.html#conditional-execution-with"><i class="fa fa-check"></i><b>4.6</b> Conditional execution with</a></li>
<li class="chapter" data-level="4.7" data-path="r-fundamentals.html"><a href="r-fundamentals.html#repeating-lines-of-code"><i class="fa fa-check"></i><b>4.7</b> Repeating lines of code</a></li>
<li class="chapter" data-level="4.8" data-path="r-fundamentals.html"><a href="r-fundamentals.html#functions"><i class="fa fa-check"></i><b>4.8</b> Functions</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html"><i class="fa fa-check"></i><b>5</b> Introduction to the Tidyverse</a>
<ul>
<li class="chapter" data-level="5.1" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#data-structure-wide-vs.-tidy-data"><i class="fa fa-check"></i><b>5.1</b> Data Structure: Wide vs. Tidy Data</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#understanding-the-difference"><i class="fa fa-check"></i><b>5.1.1</b> Understanding the Difference</a></li>
<li class="chapter" data-level="5.1.2" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#reshaping-data-with-tidyr"><i class="fa fa-check"></i><b>5.1.2</b> Reshaping Data with tidyr</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#core-dplyr-functions-for-data-manipulation"><i class="fa fa-check"></i><b>5.2</b> Core dplyr Functions for Data Manipulation</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#the-pipe-operator"><i class="fa fa-check"></i><b>5.2.1</b> The Pipe Operator (<code>%&gt;%</code>)</a></li>
<li class="chapter" data-level="5.2.2" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#select-choose-columns"><i class="fa fa-check"></i><b>5.2.2</b> <code>select()</code>: Choose Columns</a></li>
<li class="chapter" data-level="5.2.3" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#filter-choose-rows"><i class="fa fa-check"></i><b>5.2.3</b> <code>filter()</code>: Choose Rows</a></li>
<li class="chapter" data-level="5.2.4" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#mutate-create-or-modify-columns"><i class="fa fa-check"></i><b>5.2.4</b> <code>mutate()</code>: Create or Modify Columns</a></li>
<li class="chapter" data-level="5.2.5" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#transmute-create-new-columns-drop-others"><i class="fa fa-check"></i><b>5.2.5</b> <code>transmute()</code>: Create New Columns (Drop Others)</a></li>
<li class="chapter" data-level="5.2.6" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#arrange-sort-rows"><i class="fa fa-check"></i><b>5.2.6</b> <code>arrange()</code>: Sort Rows</a></li>
<li class="chapter" data-level="5.2.7" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#group_by-and-summarise-group-operations"><i class="fa fa-check"></i><b>5.2.7</b> <code>group_by()</code> and <code>summarise()</code>: Group Operations</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#additional-essential-functions"><i class="fa fa-check"></i><b>5.3</b> Additional Essential Functions</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#rename-change-column-names"><i class="fa fa-check"></i><b>5.3.1</b> <code>rename()</code>: Change Column Names</a></li>
<li class="chapter" data-level="5.3.2" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#data-type-conversions"><i class="fa fa-check"></i><b>5.3.2</b> Data Type Conversions</a></li>
<li class="chapter" data-level="5.3.3" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#across-apply-functions-to-multiple-columns"><i class="fa fa-check"></i><b>5.3.3</b> <code>across()</code>: Apply Functions to Multiple Columns</a></li>
<li class="chapter" data-level="5.3.4" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#recode-recode-values"><i class="fa fa-check"></i><b>5.3.4</b> <code>recode()</code>: Recode Values</a></li>
<li class="chapter" data-level="5.3.5" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#case_when-multiple-conditional-logic"><i class="fa fa-check"></i><b>5.3.5</b> <code>case_when()</code>: Multiple Conditional Logic</a></li>
<li class="chapter" data-level="5.3.6" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#replace_na-handle-missing-values"><i class="fa fa-check"></i><b>5.3.6</b> <code>replace_na()</code>: Handle Missing Values</a></li>
<li class="chapter" data-level="5.3.7" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#which-find-positions"><i class="fa fa-check"></i><b>5.3.7</b> <code>which()</code>: Find Positions</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#practical-example-data-analysis-workflow"><i class="fa fa-check"></i><b>5.4</b> Practical Example: Data Analysis Workflow</a></li>
<li class="chapter" data-level="5.5" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#function-summary-table"><i class="fa fa-check"></i><b>5.5</b> Function Summary Table</a></li>
<li class="chapter" data-level="5.6" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#conclusion"><i class="fa fa-check"></i><b>5.6</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html"><i class="fa fa-check"></i><b>6</b> Data Visualization in R</a>
<ul>
<li class="chapter" data-level="6.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#ggplot2-the-grammar-of-graphics"><i class="fa fa-check"></i><b>6.1</b> ggplot2: The Grammar of Graphics</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#basic-ggplot2-structure"><i class="fa fa-check"></i><b>6.1.1</b> Basic ggplot2 Structure</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#basic-plot-types"><i class="fa fa-check"></i><b>6.2</b> Basic Plot Types</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#scatter-plots-with-geom_point"><i class="fa fa-check"></i><b>6.2.1</b> Scatter Plots with <code>geom_point()</code></a></li>
<li class="chapter" data-level="6.2.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#line-plots-with-geom_line"><i class="fa fa-check"></i><b>6.2.2</b> Line Plots with <code>geom_line()</code></a></li>
<li class="chapter" data-level="6.2.3" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#bar-plots-with-geom_col-and-geom_bar"><i class="fa fa-check"></i><b>6.2.3</b> Bar Plots with <code>geom_col()</code> and <code>geom_bar()</code></a></li>
<li class="chapter" data-level="6.2.4" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#histograms-with-geom_histogram"><i class="fa fa-check"></i><b>6.2.4</b> Histograms with <code>geom_histogram()</code></a></li>
<li class="chapter" data-level="6.2.5" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#box-plots-with-geom_boxplot"><i class="fa fa-check"></i><b>6.2.5</b> Box Plots with <code>geom_boxplot()</code></a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#aesthetic-mappings"><i class="fa fa-check"></i><b>6.3</b> Aesthetic Mappings</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#understanding-aes"><i class="fa fa-check"></i><b>6.3.1</b> Understanding <code>aes()</code></a></li>
<li class="chapter" data-level="6.3.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#fixed-vs.-mapped-aesthetics"><i class="fa fa-check"></i><b>6.3.2</b> Fixed vs. Mapped Aesthetics</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#faceting-small-multiples"><i class="fa fa-check"></i><b>6.4</b> Faceting: Small Multiples</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#facet_wrap"><i class="fa fa-check"></i><b>6.4.1</b> <code>facet_wrap()</code></a></li>
<li class="chapter" data-level="6.4.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#facet_grid"><i class="fa fa-check"></i><b>6.4.2</b> <code>facet_grid()</code></a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#statistical-transformations"><i class="fa fa-check"></i><b>6.5</b> Statistical Transformations</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#smooth-lines-with-geom_smooth"><i class="fa fa-check"></i><b>6.5.1</b> Smooth Lines with <code>geom_smooth()</code></a></li>
<li class="chapter" data-level="6.5.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#statistical-summaries"><i class="fa fa-check"></i><b>6.5.2</b> Statistical Summaries</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#scales-controlling-aesthetic-mappings"><i class="fa fa-check"></i><b>6.6</b> Scales: Controlling Aesthetic Mappings</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#color-scales"><i class="fa fa-check"></i><b>6.6.1</b> Color Scales</a></li>
<li class="chapter" data-level="6.6.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#axis-scales"><i class="fa fa-check"></i><b>6.6.2</b> Axis Scales</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#coordinates-and-transformations"><i class="fa fa-check"></i><b>6.7</b> Coordinates and Transformations</a></li>
<li class="chapter" data-level="6.8" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#labels-and-themes"><i class="fa fa-check"></i><b>6.8</b> Labels and Themes</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#adding-labels"><i class="fa fa-check"></i><b>6.8.1</b> Adding Labels</a></li>
<li class="chapter" data-level="6.8.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#theme-customization"><i class="fa fa-check"></i><b>6.8.2</b> Theme Customization</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#heatmaps"><i class="fa fa-check"></i><b>6.9</b> Heatmaps</a></li>
<li class="chapter" data-level="6.10" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#combining-multiple-geoms"><i class="fa fa-check"></i><b>6.10</b> Combining Multiple Geoms</a></li>
<li class="chapter" data-level="6.11" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#text-and-annotations"><i class="fa fa-check"></i><b>6.11</b> Text and Annotations</a></li>
<li class="chapter" data-level="6.12" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#practical-example-complex-multi-layered-plot"><i class="fa fa-check"></i><b>6.12</b> Practical Example: Complex Multi-layered Plot</a></li>
<li class="chapter" data-level="6.13" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#ggplot2-function-summary-table"><i class="fa fa-check"></i><b>6.13</b> ggplot2 Function Summary Table</a></li>
<li class="chapter" data-level="6.14" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#tips-and-tricks"><i class="fa fa-check"></i><b>6.14</b> Tips and Tricks</a></li>
<li class="chapter" data-level="6.15" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#conclusion-1"><i class="fa fa-check"></i><b>6.15</b> Conclusion</a></li>
<li class="chapter" data-level="6.16" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#my-favorite-figures-i-ever-made"><i class="fa fa-check"></i><b>6.16</b> My favorite figures I ever made</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>7</b> Statistics</a>
<ul>
<li class="chapter" data-level="7.1" data-path="statistics.html"><a href="statistics.html#descriptive-statistics-and-outbreak-investigation"><i class="fa fa-check"></i><b>7.1</b> Descriptive statistics and outbreak investigation</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="statistics.html"><a href="statistics.html#introduction"><i class="fa fa-check"></i><b>7.1.1</b> Introduction</a></li>
<li class="chapter" data-level="7.1.2" data-path="statistics.html"><a href="statistics.html#loading-and-exploring-the-data"><i class="fa fa-check"></i><b>7.1.2</b> Loading and Exploring the Data</a></li>
<li class="chapter" data-level="7.1.3" data-path="statistics.html"><a href="statistics.html#data-preparation-creating-a-tidy-dataset"><i class="fa fa-check"></i><b>7.1.3</b> Data Preparation: Creating a Tidy Dataset</a></li>
<li class="chapter" data-level="7.1.4" data-path="statistics.html"><a href="statistics.html#initial-visual-exploration"><i class="fa fa-check"></i><b>7.1.4</b> Initial Visual Exploration</a></li>
<li class="chapter" data-level="7.1.5" data-path="statistics.html"><a href="statistics.html#comparing-cases-and-controls"><i class="fa fa-check"></i><b>7.1.5</b> Comparing Cases and Controls</a></li>
<li class="chapter" data-level="7.1.6" data-path="statistics.html"><a href="statistics.html#statistical-analysis-attack-rates-and-odds-ratios"><i class="fa fa-check"></i><b>7.1.6</b> Statistical Analysis: Attack Rates and Odds Ratios</a></li>
<li class="chapter" data-level="7.1.7" data-path="statistics.html"><a href="statistics.html#calculating-statistics-for-our-data"><i class="fa fa-check"></i><b>7.1.7</b> Calculating Statistics for Our Data</a></li>
<li class="chapter" data-level="7.1.8" data-path="statistics.html"><a href="statistics.html#interpretation-of-results"><i class="fa fa-check"></i><b>7.1.8</b> Interpretation of Results</a></li>
<li class="chapter" data-level="7.1.9" data-path="statistics.html"><a href="statistics.html#conclusion-2"><i class="fa fa-check"></i><b>7.1.9</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="statistics.html"><a href="statistics.html#inferential-statistics-in-epidemiology"><i class="fa fa-check"></i><b>7.2</b> Inferential statistics in epidemiology</a></li>
<li class="chapter" data-level="7.3" data-path="statistics.html"><a href="statistics.html#inferential-statistics-in-epidemiology-1"><i class="fa fa-check"></i><b>7.3</b> Inferential Statistics in Epidemiology</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="statistics.html"><a href="statistics.html#understanding-statistical-significance"><i class="fa fa-check"></i><b>7.3.1</b> Understanding Statistical Significance</a></li>
<li class="chapter" data-level="7.3.2" data-path="statistics.html"><a href="statistics.html#comparing-demographics-between-cases-and-controls"><i class="fa fa-check"></i><b>7.3.2</b> Comparing Demographics Between Cases and Controls</a></li>
<li class="chapter" data-level="7.3.3" data-path="statistics.html"><a href="statistics.html#testing-food-exposures-statistical-significance-of-associations"><i class="fa fa-check"></i><b>7.3.3</b> Testing Food Exposures: Statistical Significance of Associations</a></li>
<li class="chapter" data-level="7.3.4" data-path="statistics.html"><a href="statistics.html#confidence-intervals-for-odds-ratios"><i class="fa fa-check"></i><b>7.3.4</b> Confidence Intervals for Odds Ratios</a></li>
<li class="chapter" data-level="7.3.5" data-path="statistics.html"><a href="statistics.html#interpreting-the-results"><i class="fa fa-check"></i><b>7.3.5</b> Interpreting the Results</a></li>
<li class="chapter" data-level="7.3.6" data-path="statistics.html"><a href="statistics.html#key-statistical-concepts-for-interpretation"><i class="fa fa-check"></i><b>7.3.6</b> Key Statistical Concepts for Interpretation</a></li>
<li class="chapter" data-level="7.3.7" data-path="statistics.html"><a href="statistics.html#summary"><i class="fa fa-check"></i><b>7.3.7</b> Summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="working-with-epidemiological-data.html"><a href="working-with-epidemiological-data.html"><i class="fa fa-check"></i><b>8</b> Working with epidemiological data</a>
<ul>
<li class="chapter" data-level="8.1" data-path="working-with-epidemiological-data.html"><a href="working-with-epidemiological-data.html#acessing-data"><i class="fa fa-check"></i><b>8.1</b> Acessing data</a></li>
<li class="chapter" data-level="8.2" data-path="working-with-epidemiological-data.html"><a href="working-with-epidemiological-data.html#imperfect-epidemiological-data"><i class="fa fa-check"></i><b>8.2</b> (Imperfect) epidemiological data</a></li>
<li class="chapter" data-level="8.3" data-path="working-with-epidemiological-data.html"><a href="working-with-epidemiological-data.html#case-study-1-yellow-fever"><i class="fa fa-check"></i><b>8.3</b> Case Study 1: Yellow Fever</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="case-study-dengue-fever-in-brazil.html"><a href="case-study-dengue-fever-in-brazil.html"><i class="fa fa-check"></i><b>9</b> Case Study: Dengue Fever in Brazil</a>
<ul>
<li class="chapter" data-level="9.1" data-path="case-study-dengue-fever-in-brazil.html"><a href="case-study-dengue-fever-in-brazil.html#introduction-1"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="case-study-dengue-fever-in-brazil.html"><a href="case-study-dengue-fever-in-brazil.html#data-sources-and-structure"><i class="fa fa-check"></i><b>9.2</b> Data Sources and Structure</a></li>
<li class="chapter" data-level="9.3" data-path="case-study-dengue-fever-in-brazil.html"><a href="case-study-dengue-fever-in-brazil.html#data-import-and-preparation"><i class="fa fa-check"></i><b>9.3</b> Data Import and Preparation</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="case-study-dengue-fever-in-brazil.html"><a href="case-study-dengue-fever-in-brazil.html#data-type-standardization"><i class="fa fa-check"></i><b>9.3.1</b> Data Type Standardization</a></li>
<li class="chapter" data-level="9.3.2" data-path="case-study-dengue-fever-in-brazil.html"><a href="case-study-dengue-fever-in-brazil.html#geographic-data-import"><i class="fa fa-check"></i><b>9.3.2</b> Geographic Data Import</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="case-study-dengue-fever-in-brazil.html"><a href="case-study-dengue-fever-in-brazil.html#temporal-analysis-national-dengue-trends"><i class="fa fa-check"></i><b>9.4</b> Temporal Analysis: National Dengue Trends</a></li>
<li class="chapter" data-level="9.5" data-path="case-study-dengue-fever-in-brazil.html"><a href="case-study-dengue-fever-in-brazil.html#spatial-analysis-environmental-context"><i class="fa fa-check"></i><b>9.5</b> Spatial Analysis: Environmental Context</a></li>
<li class="chapter" data-level="9.6" data-path="case-study-dengue-fever-in-brazil.html"><a href="case-study-dengue-fever-in-brazil.html#temporal-spatial-analysis-annual-incidence-maps"><i class="fa fa-check"></i><b>9.6</b> Temporal-Spatial Analysis: Annual Incidence Maps</a></li>
<li class="chapter" data-level="9.7" data-path="case-study-dengue-fever-in-brazil.html"><a href="case-study-dengue-fever-in-brazil.html#climate-oscillations-large-scale-environmental-drivers"><i class="fa fa-check"></i><b>9.7</b> Climate Oscillations: Large-Scale Environmental Drivers</a></li>
<li class="chapter" data-level="9.8" data-path="case-study-dengue-fever-in-brazil.html"><a href="case-study-dengue-fever-in-brazil.html#ecological-analysis-incidence-by-environmental-zones"><i class="fa fa-check"></i><b>9.8</b> Ecological Analysis: Incidence by Environmental Zones</a></li>
<li class="chapter" data-level="9.9" data-path="case-study-dengue-fever-in-brazil.html"><a href="case-study-dengue-fever-in-brazil.html#seasonal-analysis-weekly-patterns-by-biome"><i class="fa fa-check"></i><b>9.9</b> Seasonal Analysis: Weekly Patterns by Biome</a></li>
<li class="chapter" data-level="9.10" data-path="case-study-dengue-fever-in-brazil.html"><a href="case-study-dengue-fever-in-brazil.html#discussion-and-key-findings"><i class="fa fa-check"></i><b>9.10</b> Discussion and Key Findings</a></li>
<li class="chapter" data-level="9.11" data-path="case-study-dengue-fever-in-brazil.html"><a href="case-study-dengue-fever-in-brazil.html#further-analysis-opportunities"><i class="fa fa-check"></i><b>9.11</b> Further Analysis Opportunities</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="modelling.html"><a href="modelling.html"><i class="fa fa-check"></i><b>10</b> Modelling</a>
<ul>
<li class="chapter" data-level="10.1" data-path="modelling.html"><a href="modelling.html#compartmental-models"><i class="fa fa-check"></i><b>10.1</b> Compartmental models</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="modelling.html"><a href="modelling.html#sir-model-in-theory"><i class="fa fa-check"></i><b>10.1.1</b> SIR model in theory</a></li>
<li class="chapter" data-level="10.1.2" data-path="modelling.html"><a href="modelling.html#sir-model-in-r"><i class="fa fa-check"></i><b>10.1.2</b> SIR model in R</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="modelling.html"><a href="modelling.html#time-series---forecasting"><i class="fa fa-check"></i><b>10.2</b> Time series - Forecasting</a></li>
<li class="chapter" data-level="10.3" data-path="modelling.html"><a href="modelling.html#using-and-applying-models"><i class="fa fa-check"></i><b>10.3</b> Using and applying models</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="communication-and-sharing-of-code-and-data.html"><a href="communication-and-sharing-of-code-and-data.html"><i class="fa fa-check"></i><b>11</b> Communication and sharing of code and data</a>
<ul>
<li class="chapter" data-level="11.1" data-path="communication-and-sharing-of-code-and-data.html"><a href="communication-and-sharing-of-code-and-data.html#writing-code-best-practices"><i class="fa fa-check"></i><b>11.1</b> Writing code: best practices</a></li>
<li class="chapter" data-level="11.2" data-path="communication-and-sharing-of-code-and-data.html"><a href="communication-and-sharing-of-code-and-data.html#github"><i class="fa fa-check"></i><b>11.2</b> Github</a></li>
<li class="chapter" data-level="11.3" data-path="communication-and-sharing-of-code-and-data.html"><a href="communication-and-sharing-of-code-and-data.html#reports-using-markdown"><i class="fa fa-check"></i><b>11.3</b> Reports using Markdown</a></li>
<li class="chapter" data-level="11.4" data-path="communication-and-sharing-of-code-and-data.html"><a href="communication-and-sharing-of-code-and-data.html#open-science"><i class="fa fa-check"></i><b>11.4</b> Open science</a></li>
<li class="chapter" data-level="11.5" data-path="communication-and-sharing-of-code-and-data.html"><a href="communication-and-sharing-of-code-and-data.html#communities-and-forums"><i class="fa fa-check"></i><b>11.5</b> Communities and forums</a></li>
<li class="chapter" data-level="11.6" data-path="communication-and-sharing-of-code-and-data.html"><a href="communication-and-sharing-of-code-and-data.html#how-to-use-chat-gpt"><i class="fa fa-check"></i><b>11.6</b> How to use Chat-GPT</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="recommended-reading.html"><a href="recommended-reading.html"><i class="fa fa-check"></i><b>12</b> Recommended Reading</a>
<ul>
<li class="chapter" data-level="12.1" data-path="recommended-reading.html"><a href="recommended-reading.html#recommended-textbooks-and-courses"><i class="fa fa-check"></i><b>12.1</b> Recommended textbooks and courses</a></li>
<li class="chapter" data-level="12.2" data-path="recommended-reading.html"><a href="recommended-reading.html#datasources"><i class="fa fa-check"></i><b>12.2</b> Datasources</a></li>
<li class="chapter" data-level="12.3" data-path="recommended-reading.html"><a href="recommended-reading.html#useful-packages"><i class="fa fa-check"></i><b>12.3</b> Useful packages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Epidemiology in R: A Hands-on Approach</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="case-study-dengue-fever-in-brazil" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Chapter 9</span> Case Study: Dengue Fever in Brazil<a href="case-study-dengue-fever-in-brazil.html#case-study-dengue-fever-in-brazil" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction-1" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Introduction<a href="case-study-dengue-fever-in-brazil.html#introduction-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Dengue is a mosquito-borne viral disease that affects millions of people worldwide every year. It is primarily transmitted by the <em>Aedes aegypti</em> mosquito, which thrives in tropical and subtropical climates. Globally, dengue is a growing public health concern: the World Health Organization estimates that nearly half of the world’s population is at risk, and this number keeps increasing. Outbreaks are known to occur in over 100 countries. The disease ranges from mild flu-like symptoms to severe forms, including dengue hemorrhagic fever, which can be life-threatening.</p>
<p>Brazil represents a particularly important context for studying dengue. Its vast territory spans multiple climatic zones, from tropical rainforests to semi-arid regions, and contains a diverse range of biomes. Seasonal rainfall patterns, temperature variations, and population density all contribute to the dynamics of dengue transmission across municipalities. Additionally, large-scale climate phenomena such as El Niño and La Niña can influence local weather conditions, indirectly affecting mosquito populations and disease incidence.</p>
<p>In this case study, you will explore a rich dataset containing weekly dengue case counts, climate variables, population data, and ecological information for municipalities across Brazil. Using this data, we will investigate patterns of disease incidence, examine the relationship between environmental factors and dengue transmission, and apply statistical and modeling tools to draw insights.</p>
<p><strong>Learning objectives:</strong></p>
<ul>
<li>Analyze temporal and spatial patterns of dengue incidence across different ecological zones</li>
<li>Explore the relationship between environmental factors and disease transmission</li>
<li>Apply data visualization techniques to identify epidemiological patterns</li>
<li>Integrate multiple data sources for comprehensive epidemiological analysis</li>
</ul>
</div>
<div id="data-sources-and-structure" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Data Sources and Structure<a href="case-study-dengue-fever-in-brazil.html#data-sources-and-structure" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This analysis uses data from the Mosqlimate project (<a href="https://sprint.mosqlimate.org/data/" class="uri">https://sprint.mosqlimate.org/data/</a>), which provides comprehensive surveillance data for vector-borne diseases in Brazil. Our dataset includes:</p>
<ul>
<li><strong>Case data</strong>: Weekly dengue case counts by municipality (2010-2025)</li>
<li><strong>Population data</strong>: Annual population estimates for incidence calculations</li>
<li><strong>Climate data</strong>: Temperature, precipitation, and humidity measurements</li>
<li><strong>Environmental data</strong>: Biome classifications and Köppen climate zones</li>
<li><strong>Ocean climate data</strong>: Large-scale climate oscillation indices (El Niño, La Niña)</li>
<li><strong>Geographic data</strong>: Shapefiles for mapping and spatial analysis</li>
</ul>
</div>
<div id="data-import-and-preparation" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> Data Import and Preparation<a href="case-study-dengue-fever-in-brazil.html#data-import-and-preparation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="case-study-dengue-fever-in-brazil.html#cb267-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb267-2"><a href="case-study-dengue-fever-in-brazil.html#cb267-2" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb267-3"><a href="case-study-dengue-fever-in-brazil.html#cb267-3" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb267-4"><a href="case-study-dengue-fever-in-brazil.html#cb267-4" tabindex="-1"></a></span>
<span id="cb267-5"><a href="case-study-dengue-fever-in-brazil.html#cb267-5" tabindex="-1"></a><span class="co"># Set data path</span></span>
<span id="cb267-6"><a href="case-study-dengue-fever-in-brazil.html#cb267-6" tabindex="-1"></a>compressed_data_path <span class="ot">&lt;-</span> <span class="st">&quot;data/dengue_compressed/&quot;</span></span>
<span id="cb267-7"><a href="case-study-dengue-fever-in-brazil.html#cb267-7" tabindex="-1"></a></span>
<span id="cb267-8"><a href="case-study-dengue-fever-in-brazil.html#cb267-8" tabindex="-1"></a><span class="co"># Import datasets</span></span>
<span id="cb267-9"><a href="case-study-dengue-fever-in-brazil.html#cb267-9" tabindex="-1"></a>population_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">paste0</span>(compressed_data_path, <span class="st">&quot;datasus_population_2001_2024.csv.gz&quot;</span>))</span>
<span id="cb267-10"><a href="case-study-dengue-fever-in-brazil.html#cb267-10" tabindex="-1"></a>case_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">paste0</span>(compressed_data_path, <span class="st">&quot;dengue.csv.gz&quot;</span>))</span>
<span id="cb267-11"><a href="case-study-dengue-fever-in-brazil.html#cb267-11" tabindex="-1"></a>climate_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">paste0</span>(compressed_data_path, <span class="st">&quot;climate.csv.gz&quot;</span>))</span>
<span id="cb267-12"><a href="case-study-dengue-fever-in-brazil.html#cb267-12" tabindex="-1"></a>environment_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">paste0</span>(compressed_data_path, <span class="st">&quot;environ_vars.csv.gz&quot;</span>))</span>
<span id="cb267-13"><a href="case-study-dengue-fever-in-brazil.html#cb267-13" tabindex="-1"></a>ocean_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">paste0</span>(compressed_data_path, <span class="st">&quot;ocean_climate_oscillations.csv.gz&quot;</span>))</span>
<span id="cb267-14"><a href="case-study-dengue-fever-in-brazil.html#cb267-14" tabindex="-1"></a></span>
<span id="cb267-15"><a href="case-study-dengue-fever-in-brazil.html#cb267-15" tabindex="-1"></a><span class="co"># Remove unnecessary columns from case data</span></span>
<span id="cb267-16"><a href="case-study-dengue-fever-in-brazil.html#cb267-16" tabindex="-1"></a>cols_to_remove <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;train_1&#39;</span>, <span class="st">&#39;target_1&#39;</span>, <span class="st">&#39;train_2&#39;</span>, <span class="st">&#39;target_2&#39;</span>, <span class="st">&#39;train_3&#39;</span>, <span class="st">&#39;target_3&#39;</span>, <span class="st">&#39;epiweek&#39;</span>)</span>
<span id="cb267-17"><a href="case-study-dengue-fever-in-brazil.html#cb267-17" tabindex="-1"></a>case_data <span class="ot">&lt;-</span> case_data <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span><span class="fu">all_of</span>(cols_to_remove))</span></code></pre></div>
<div id="data-type-standardization" class="section level3 hasAnchor" number="9.3.1">
<h3><span class="header-section-number">9.3.1</span> Data Type Standardization<a href="case-study-dengue-fever-in-brazil.html#data-type-standardization" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To ensure consistent analysis, we’ll standardize column types across all datasets:</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="case-study-dengue-fever-in-brazil.html#cb268-1" tabindex="-1"></a>change_columntypes <span class="ot">&lt;-</span> <span class="cf">function</span>(dataframe) {</span>
<span id="cb268-2"><a href="case-study-dengue-fever-in-brazil.html#cb268-2" tabindex="-1"></a>  <span class="co"># Convert date column to Date object if present</span></span>
<span id="cb268-3"><a href="case-study-dengue-fever-in-brazil.html#cb268-3" tabindex="-1"></a>  <span class="cf">if</span> (<span class="st">&#39;date&#39;</span> <span class="sc">%in%</span> <span class="fu">colnames</span>(dataframe)) {</span>
<span id="cb268-4"><a href="case-study-dengue-fever-in-brazil.html#cb268-4" tabindex="-1"></a>    dataframe <span class="ot">&lt;-</span> dataframe <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(date))</span>
<span id="cb268-5"><a href="case-study-dengue-fever-in-brazil.html#cb268-5" tabindex="-1"></a>  }</span>
<span id="cb268-6"><a href="case-study-dengue-fever-in-brazil.html#cb268-6" tabindex="-1"></a>  </span>
<span id="cb268-7"><a href="case-study-dengue-fever-in-brazil.html#cb268-7" tabindex="-1"></a>  <span class="co"># Convert geographic and categorical variables to factors</span></span>
<span id="cb268-8"><a href="case-study-dengue-fever-in-brazil.html#cb268-8" tabindex="-1"></a>  factor_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;geocode&#39;</span>, <span class="st">&#39;uf&#39;</span>, <span class="st">&#39;macroregional_geocode&#39;</span>, <span class="st">&#39;regional_geocode&#39;</span>,</span>
<span id="cb268-9"><a href="case-study-dengue-fever-in-brazil.html#cb268-9" tabindex="-1"></a>                     <span class="st">&#39;uf_code&#39;</span>, <span class="st">&#39;koppen&#39;</span>, <span class="st">&#39;biome&#39;</span>)</span>
<span id="cb268-10"><a href="case-study-dengue-fever-in-brazil.html#cb268-10" tabindex="-1"></a>  </span>
<span id="cb268-11"><a href="case-study-dengue-fever-in-brazil.html#cb268-11" tabindex="-1"></a>  <span class="cf">for</span> (column <span class="cf">in</span> factor_columns) {</span>
<span id="cb268-12"><a href="case-study-dengue-fever-in-brazil.html#cb268-12" tabindex="-1"></a>    <span class="cf">if</span> (column <span class="sc">%in%</span> <span class="fu">colnames</span>(dataframe)) {</span>
<span id="cb268-13"><a href="case-study-dengue-fever-in-brazil.html#cb268-13" tabindex="-1"></a>      dataframe <span class="ot">&lt;-</span> dataframe <span class="sc">%&gt;%</span> </span>
<span id="cb268-14"><a href="case-study-dengue-fever-in-brazil.html#cb268-14" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="sc">!!</span><span class="at">column :=</span> <span class="fu">as.factor</span>(.data[[column]]))</span>
<span id="cb268-15"><a href="case-study-dengue-fever-in-brazil.html#cb268-15" tabindex="-1"></a>    }</span>
<span id="cb268-16"><a href="case-study-dengue-fever-in-brazil.html#cb268-16" tabindex="-1"></a>  }</span>
<span id="cb268-17"><a href="case-study-dengue-fever-in-brazil.html#cb268-17" tabindex="-1"></a>  </span>
<span id="cb268-18"><a href="case-study-dengue-fever-in-brazil.html#cb268-18" tabindex="-1"></a>  <span class="fu">return</span>(dataframe)</span>
<span id="cb268-19"><a href="case-study-dengue-fever-in-brazil.html#cb268-19" tabindex="-1"></a>}</span>
<span id="cb268-20"><a href="case-study-dengue-fever-in-brazil.html#cb268-20" tabindex="-1"></a></span>
<span id="cb268-21"><a href="case-study-dengue-fever-in-brazil.html#cb268-21" tabindex="-1"></a><span class="co"># Apply standardization to all datasets</span></span>
<span id="cb268-22"><a href="case-study-dengue-fever-in-brazil.html#cb268-22" tabindex="-1"></a>population_data <span class="ot">&lt;-</span> <span class="fu">change_columntypes</span>(population_data)</span>
<span id="cb268-23"><a href="case-study-dengue-fever-in-brazil.html#cb268-23" tabindex="-1"></a>case_data <span class="ot">&lt;-</span> <span class="fu">change_columntypes</span>(case_data)</span>
<span id="cb268-24"><a href="case-study-dengue-fever-in-brazil.html#cb268-24" tabindex="-1"></a>climate_data <span class="ot">&lt;-</span> <span class="fu">change_columntypes</span>(climate_data)</span>
<span id="cb268-25"><a href="case-study-dengue-fever-in-brazil.html#cb268-25" tabindex="-1"></a>environment_data <span class="ot">&lt;-</span> <span class="fu">change_columntypes</span>(environment_data)</span>
<span id="cb268-26"><a href="case-study-dengue-fever-in-brazil.html#cb268-26" tabindex="-1"></a>ocean_data <span class="ot">&lt;-</span> <span class="fu">change_columntypes</span>(ocean_data)</span></code></pre></div>
</div>
<div id="geographic-data-import" class="section level3 hasAnchor" number="9.3.2">
<h3><span class="header-section-number">9.3.2</span> Geographic Data Import<a href="case-study-dengue-fever-in-brazil.html#geographic-data-import" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="case-study-dengue-fever-in-brazil.html#cb269-1" tabindex="-1"></a><span class="co"># Import shapefiles for mapping</span></span>
<span id="cb269-2"><a href="case-study-dengue-fever-in-brazil.html#cb269-2" tabindex="-1"></a>shapefile_municipalities <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="fu">paste0</span>(compressed_data_path, <span class="st">&#39;shape_muni.gpkg&#39;</span>))</span>
<span id="cb269-3"><a href="case-study-dengue-fever-in-brazil.html#cb269-3" tabindex="-1"></a>shapefile_regions <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="fu">paste0</span>(compressed_data_path, <span class="st">&#39;shape_regional_health.gpkg&#39;</span>))</span>
<span id="cb269-4"><a href="case-study-dengue-fever-in-brazil.html#cb269-4" tabindex="-1"></a>shapefile_macroregions <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="fu">paste0</span>(compressed_data_path, <span class="st">&#39;shape_macroregional_health.gpkg&#39;</span>))</span>
<span id="cb269-5"><a href="case-study-dengue-fever-in-brazil.html#cb269-5" tabindex="-1"></a></span>
<span id="cb269-6"><a href="case-study-dengue-fever-in-brazil.html#cb269-6" tabindex="-1"></a><span class="co"># Ensure consistent data types for geographic identifiers</span></span>
<span id="cb269-7"><a href="case-study-dengue-fever-in-brazil.html#cb269-7" tabindex="-1"></a>shapefile_municipalities<span class="sc">$</span>geocode <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(shapefile_municipalities<span class="sc">$</span>geocode)</span>
<span id="cb269-8"><a href="case-study-dengue-fever-in-brazil.html#cb269-8" tabindex="-1"></a>shapefile_municipalities<span class="sc">$</span>uf_code <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(shapefile_municipalities<span class="sc">$</span>uf_code)</span></code></pre></div>
</div>
</div>
<div id="temporal-analysis-national-dengue-trends" class="section level2 hasAnchor" number="9.4">
<h2><span class="header-section-number">9.4</span> Temporal Analysis: National Dengue Trends<a href="case-study-dengue-fever-in-brazil.html#temporal-analysis-national-dengue-trends" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s begin by examining the overall temporal patterns of dengue incidence in Brazil:</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="case-study-dengue-fever-in-brazil.html#cb270-1" tabindex="-1"></a><span class="co"># Calculate national case totals by week</span></span>
<span id="cb270-2"><a href="case-study-dengue-fever-in-brazil.html#cb270-2" tabindex="-1"></a>national_cases <span class="ot">&lt;-</span> case_data <span class="sc">%&gt;%</span> </span>
<span id="cb270-3"><a href="case-study-dengue-fever-in-brazil.html#cb270-3" tabindex="-1"></a>  <span class="fu">group_by</span>(date) <span class="sc">%&gt;%</span> </span>
<span id="cb270-4"><a href="case-study-dengue-fever-in-brazil.html#cb270-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">cases =</span> <span class="fu">sum</span>(casos), <span class="at">.groups =</span> <span class="st">&#39;drop&#39;</span>)</span>
<span id="cb270-5"><a href="case-study-dengue-fever-in-brazil.html#cb270-5" tabindex="-1"></a></span>
<span id="cb270-6"><a href="case-study-dengue-fever-in-brazil.html#cb270-6" tabindex="-1"></a><span class="co"># Visualize national trends</span></span>
<span id="cb270-7"><a href="case-study-dengue-fever-in-brazil.html#cb270-7" tabindex="-1"></a><span class="fu">ggplot</span>(national_cases, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> cases)) <span class="sc">+</span></span>
<span id="cb270-8"><a href="case-study-dengue-fever-in-brazil.html#cb270-8" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linewidth =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb270-9"><a href="case-study-dengue-fever-in-brazil.html#cb270-9" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">date_breaks =</span> <span class="st">&quot;1 year&quot;</span>, <span class="at">date_labels =</span> <span class="st">&quot;%Y&quot;</span>) <span class="sc">+</span></span>
<span id="cb270-10"><a href="case-study-dengue-fever-in-brazil.html#cb270-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Year&quot;</span>, </span>
<span id="cb270-11"><a href="case-study-dengue-fever-in-brazil.html#cb270-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Weekly Cases&quot;</span>, </span>
<span id="cb270-12"><a href="case-study-dengue-fever-in-brazil.html#cb270-12" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Dengue Cases in Brazil - National Trends&quot;</span>,</span>
<span id="cb270-13"><a href="case-study-dengue-fever-in-brazil.html#cb270-13" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Weekly reported cases 2010-2025&quot;</span>) <span class="sc">+</span></span>
<span id="cb270-14"><a href="case-study-dengue-fever-in-brazil.html#cb270-14" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb270-15"><a href="case-study-dengue-fever-in-brazil.html#cb270-15" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code></pre></div>
<p><img src="09-casestudy-dengue_files/figure-html/unnamed-chunk-4-1.png" width="1152" style="display: block; margin: auto;" /></p>
<p>You’ll note that while Dengue has been a consistent burden over the past two decades in Brazil, interestingly with the exceptions of 2017 and 2018, there was an unprecedented peak of cases in 2024. What is fascinating is that no one really knows why that was…</p>
</div>
<div id="spatial-analysis-environmental-context" class="section level2 hasAnchor" number="9.5">
<h2><span class="header-section-number">9.5</span> Spatial Analysis: Environmental Context<a href="case-study-dengue-fever-in-brazil.html#spatial-analysis-environmental-context" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Brazil’s diverse geography creates distinct ecological zones that influence dengue transmission. Let’s visualize the environmental context:</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="case-study-dengue-fever-in-brazil.html#cb271-1" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb271-2"><a href="case-study-dengue-fever-in-brazil.html#cb271-2" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb271-3"><a href="case-study-dengue-fever-in-brazil.html#cb271-3" tabindex="-1"></a></span>
<span id="cb271-4"><a href="case-study-dengue-fever-in-brazil.html#cb271-4" tabindex="-1"></a><span class="co"># Join environmental data with geographic boundaries</span></span>
<span id="cb271-5"><a href="case-study-dengue-fever-in-brazil.html#cb271-5" tabindex="-1"></a>map_environment_data <span class="ot">&lt;-</span> shapefile_municipalities <span class="sc">%&gt;%</span></span>
<span id="cb271-6"><a href="case-study-dengue-fever-in-brazil.html#cb271-6" tabindex="-1"></a>  <span class="fu">left_join</span>(environment_data, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;geocode&quot;</span>, <span class="st">&quot;uf_code&quot;</span>))</span>
<span id="cb271-7"><a href="case-study-dengue-fever-in-brazil.html#cb271-7" tabindex="-1"></a></span>
<span id="cb271-8"><a href="case-study-dengue-fever-in-brazil.html#cb271-8" tabindex="-1"></a><span class="co"># Plot 1: Brazilian states</span></span>
<span id="cb271-9"><a href="case-study-dengue-fever-in-brazil.html#cb271-9" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb271-10"><a href="case-study-dengue-fever-in-brazil.html#cb271-10" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> map_environment_data, <span class="fu">aes</span>(<span class="at">fill =</span> uf_code), </span>
<span id="cb271-11"><a href="case-study-dengue-fever-in-brazil.html#cb271-11" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">&#39;grey&#39;</span>, <span class="at">linewidth =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb271-12"><a href="case-study-dengue-fever-in-brazil.html#cb271-12" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> shapefile_regions, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb271-13"><a href="case-study-dengue-fever-in-brazil.html#cb271-13" tabindex="-1"></a>          <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span></span>
<span id="cb271-14"><a href="case-study-dengue-fever-in-brazil.html#cb271-14" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> shapefile_macroregions, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb271-15"><a href="case-study-dengue-fever-in-brazil.html#cb271-15" tabindex="-1"></a>          <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb271-16"><a href="case-study-dengue-fever-in-brazil.html#cb271-16" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_d</span>(<span class="at">option =</span> <span class="st">&quot;turbo&quot;</span>) <span class="sc">+</span></span>
<span id="cb271-17"><a href="case-study-dengue-fever-in-brazil.html#cb271-17" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb271-18"><a href="case-study-dengue-fever-in-brazil.html#cb271-18" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Administrative Units - Brazilian States&quot;</span>, <span class="at">fill =</span> <span class="st">&#39;State Code&#39;</span>) <span class="sc">+</span></span>
<span id="cb271-19"><a href="case-study-dengue-fever-in-brazil.html#cb271-19" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)  <span class="co"># Too many states for readable legend</span></span>
<span id="cb271-20"><a href="case-study-dengue-fever-in-brazil.html#cb271-20" tabindex="-1"></a></span>
<span id="cb271-21"><a href="case-study-dengue-fever-in-brazil.html#cb271-21" tabindex="-1"></a><span class="co"># Plot 2: Biome classification</span></span>
<span id="cb271-22"><a href="case-study-dengue-fever-in-brazil.html#cb271-22" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb271-23"><a href="case-study-dengue-fever-in-brazil.html#cb271-23" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> map_environment_data, <span class="fu">aes</span>(<span class="at">fill =</span> biome), </span>
<span id="cb271-24"><a href="case-study-dengue-fever-in-brazil.html#cb271-24" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">linewidth =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb271-25"><a href="case-study-dengue-fever-in-brazil.html#cb271-25" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> shapefile_macroregions, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb271-26"><a href="case-study-dengue-fever-in-brazil.html#cb271-26" tabindex="-1"></a>          <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb271-27"><a href="case-study-dengue-fever-in-brazil.html#cb271-27" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&#39;Set3&#39;</span>) <span class="sc">+</span></span>
<span id="cb271-28"><a href="case-study-dengue-fever-in-brazil.html#cb271-28" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb271-29"><a href="case-study-dengue-fever-in-brazil.html#cb271-29" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Biome Classification&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;Biome&quot;</span>)</span>
<span id="cb271-30"><a href="case-study-dengue-fever-in-brazil.html#cb271-30" tabindex="-1"></a></span>
<span id="cb271-31"><a href="case-study-dengue-fever-in-brazil.html#cb271-31" tabindex="-1"></a><span class="co"># Plot 3: Köppen climate zones</span></span>
<span id="cb271-32"><a href="case-study-dengue-fever-in-brazil.html#cb271-32" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb271-33"><a href="case-study-dengue-fever-in-brazil.html#cb271-33" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> map_environment_data, <span class="fu">aes</span>(<span class="at">fill =</span> koppen), </span>
<span id="cb271-34"><a href="case-study-dengue-fever-in-brazil.html#cb271-34" tabindex="-1"></a>          <span class="at">color =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">linewidth =</span> <span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb271-35"><a href="case-study-dengue-fever-in-brazil.html#cb271-35" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> shapefile_macroregions, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb271-36"><a href="case-study-dengue-fever-in-brazil.html#cb271-36" tabindex="-1"></a>          <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb271-37"><a href="case-study-dengue-fever-in-brazil.html#cb271-37" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&#39;Paired&#39;</span>) <span class="sc">+</span></span>
<span id="cb271-38"><a href="case-study-dengue-fever-in-brazil.html#cb271-38" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb271-39"><a href="case-study-dengue-fever-in-brazil.html#cb271-39" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Köppen Climate Classification&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;Climate Zone&quot;</span>)</span>
<span id="cb271-40"><a href="case-study-dengue-fever-in-brazil.html#cb271-40" tabindex="-1"></a></span>
<span id="cb271-41"><a href="case-study-dengue-fever-in-brazil.html#cb271-41" tabindex="-1"></a><span class="co"># Combine plots</span></span>
<span id="cb271-42"><a href="case-study-dengue-fever-in-brazil.html#cb271-42" tabindex="-1"></a>combined_plot <span class="ot">&lt;-</span> p1 <span class="sc">/</span> p2 <span class="sc">/</span> p3</span>
<span id="cb271-43"><a href="case-study-dengue-fever-in-brazil.html#cb271-43" tabindex="-1"></a>combined_plot</span></code></pre></div>
<p><img src="09-casestudy-dengue_files/figure-html/unnamed-chunk-5-1.png" width="960" style="display: block; margin: auto;" /></p>
</div>
<div id="temporal-spatial-analysis-annual-incidence-maps" class="section level2 hasAnchor" number="9.6">
<h2><span class="header-section-number">9.6</span> Temporal-Spatial Analysis: Annual Incidence Maps<a href="case-study-dengue-fever-in-brazil.html#temporal-spatial-analysis-annual-incidence-maps" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To understand how dengue incidence varies across space and time, we’ll create annual incidence maps:</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="case-study-dengue-fever-in-brazil.html#cb272-1" tabindex="-1"></a><span class="co"># Calculate yearly incidence rates</span></span>
<span id="cb272-2"><a href="case-study-dengue-fever-in-brazil.html#cb272-2" tabindex="-1"></a>yearly_case_data <span class="ot">&lt;-</span> case_data <span class="sc">%&gt;%</span> </span>
<span id="cb272-3"><a href="case-study-dengue-fever-in-brazil.html#cb272-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">year</span>(date)) <span class="sc">%&gt;%</span></span>
<span id="cb272-4"><a href="case-study-dengue-fever-in-brazil.html#cb272-4" tabindex="-1"></a>  <span class="fu">group_by</span>(year, geocode) <span class="sc">%&gt;%</span></span>
<span id="cb272-5"><a href="case-study-dengue-fever-in-brazil.html#cb272-5" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">cases =</span> <span class="fu">sum</span>(casos), <span class="at">.groups =</span> <span class="st">&#39;drop&#39;</span>)</span>
<span id="cb272-6"><a href="case-study-dengue-fever-in-brazil.html#cb272-6" tabindex="-1"></a></span>
<span id="cb272-7"><a href="case-study-dengue-fever-in-brazil.html#cb272-7" tabindex="-1"></a>yearly_incidence <span class="ot">&lt;-</span> yearly_case_data <span class="sc">%&gt;%</span> </span>
<span id="cb272-8"><a href="case-study-dengue-fever-in-brazil.html#cb272-8" tabindex="-1"></a>  <span class="fu">left_join</span>(population_data, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&#39;year&#39;</span>, <span class="st">&#39;geocode&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb272-9"><a href="case-study-dengue-fever-in-brazil.html#cb272-9" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">incidence =</span> cases <span class="sc">/</span> population <span class="sc">*</span> <span class="dv">10000</span>,</span>
<span id="cb272-10"><a href="case-study-dengue-fever-in-brazil.html#cb272-10" tabindex="-1"></a>         <span class="at">geocode =</span> <span class="fu">as.factor</span>(geocode))</span>
<span id="cb272-11"><a href="case-study-dengue-fever-in-brazil.html#cb272-11" tabindex="-1"></a></span>
<span id="cb272-12"><a href="case-study-dengue-fever-in-brazil.html#cb272-12" tabindex="-1"></a><span class="co"># Join with geographic data for mapping</span></span>
<span id="cb272-13"><a href="case-study-dengue-fever-in-brazil.html#cb272-13" tabindex="-1"></a>map_incidence_data <span class="ot">&lt;-</span> shapefile_municipalities <span class="sc">%&gt;%</span></span>
<span id="cb272-14"><a href="case-study-dengue-fever-in-brazil.html#cb272-14" tabindex="-1"></a>  <span class="fu">left_join</span>(yearly_incidence, <span class="at">by =</span> <span class="st">&quot;geocode&quot;</span>)</span>
<span id="cb272-15"><a href="case-study-dengue-fever-in-brazil.html#cb272-15" tabindex="-1"></a></span>
<span id="cb272-16"><a href="case-study-dengue-fever-in-brazil.html#cb272-16" tabindex="-1"></a><span class="co"># Create annual incidence maps</span></span>
<span id="cb272-17"><a href="case-study-dengue-fever-in-brazil.html#cb272-17" tabindex="-1"></a><span class="fu">ggplot</span>(map_incidence_data, <span class="fu">aes</span>(<span class="at">fill =</span> incidence)) <span class="sc">+</span></span>
<span id="cb272-18"><a href="case-study-dengue-fever-in-brazil.html#cb272-18" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">color =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb272-19"><a href="case-study-dengue-fever-in-brazil.html#cb272-19" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb272-20"><a href="case-study-dengue-fever-in-brazil.html#cb272-20" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> year, <span class="at">ncol =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb272-21"><a href="case-study-dengue-fever-in-brazil.html#cb272-21" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">option =</span> <span class="st">&quot;magma&quot;</span>, <span class="at">trans =</span> <span class="st">&quot;sqrt&quot;</span>, <span class="at">na.value =</span> <span class="st">&quot;grey80&quot;</span>) <span class="sc">+</span></span>
<span id="cb272-22"><a href="case-study-dengue-fever-in-brazil.html#cb272-22" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb272-23"><a href="case-study-dengue-fever-in-brazil.html#cb272-23" tabindex="-1"></a>    <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb272-24"><a href="case-study-dengue-fever-in-brazil.html#cb272-24" tabindex="-1"></a>    <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb272-25"><a href="case-study-dengue-fever-in-brazil.html#cb272-25" tabindex="-1"></a>    <span class="at">legend.key.width =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb272-26"><a href="case-study-dengue-fever-in-brazil.html#cb272-26" tabindex="-1"></a>    <span class="at">legend.key.height =</span> <span class="fu">unit</span>(<span class="dv">8</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb272-27"><a href="case-study-dengue-fever-in-brazil.html#cb272-27" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb272-28"><a href="case-study-dengue-fever-in-brazil.html#cb272-28" tabindex="-1"></a>    <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>()</span>
<span id="cb272-29"><a href="case-study-dengue-fever-in-brazil.html#cb272-29" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb272-30"><a href="case-study-dengue-fever-in-brazil.html#cb272-30" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Annual Dengue Incidence per Municipality in Brazil&#39;</span>, </span>
<span id="cb272-31"><a href="case-study-dengue-fever-in-brazil.html#cb272-31" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&#39;2010-2024 (incidence per 10,000 population, square root scale)&#39;</span>,</span>
<span id="cb272-32"><a href="case-study-dengue-fever-in-brazil.html#cb272-32" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">&quot;Incidence</span><span class="sc">\n</span><span class="st">(per 10,000)&quot;</span>)</span></code></pre></div>
<p><img src="09-casestudy-dengue_files/figure-html/unnamed-chunk-6-1.png" width="1920" /></p>
<p>What you’ll see here is that throughout the years, different regions were affected. The situation in 2024 was one in which many different municipalities suffered extremely in comparison to previous years, though there’s definitely a cluster in the south east of Brazil.</p>
</div>
<div id="climate-oscillations-large-scale-environmental-drivers" class="section level2 hasAnchor" number="9.7">
<h2><span class="header-section-number">9.7</span> Climate Oscillations: Large-Scale Environmental Drivers<a href="case-study-dengue-fever-in-brazil.html#climate-oscillations-large-scale-environmental-drivers" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Large-scale climate phenomena like El Niño and La Niña can influence regional weather patterns and dengue transmission, which has been established in some literature. Each ocean has its own index (a single value) reflecting the state its climate is in. Lets look at how that varied over time.</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="case-study-dengue-fever-in-brazil.html#cb273-1" tabindex="-1"></a><span class="co"># Prepare ocean climate data for visualization</span></span>
<span id="cb273-2"><a href="case-study-dengue-fever-in-brazil.html#cb273-2" tabindex="-1"></a>ocean_data_long <span class="ot">&lt;-</span> ocean_data <span class="sc">%&gt;%</span> </span>
<span id="cb273-3"><a href="case-study-dengue-fever-in-brazil.html#cb273-3" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>date, <span class="at">names_to =</span> <span class="st">&#39;ocean_variable&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;value&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb273-4"><a href="case-study-dengue-fever-in-brazil.html#cb273-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(date),</span>
<span id="cb273-5"><a href="case-study-dengue-fever-in-brazil.html#cb273-5" tabindex="-1"></a>         <span class="at">ocean_variable =</span> <span class="fu">as.factor</span>(ocean_variable))</span>
<span id="cb273-6"><a href="case-study-dengue-fever-in-brazil.html#cb273-6" tabindex="-1"></a></span>
<span id="cb273-7"><a href="case-study-dengue-fever-in-brazil.html#cb273-7" tabindex="-1"></a><span class="co"># Plot climate oscillation indices</span></span>
<span id="cb273-8"><a href="case-study-dengue-fever-in-brazil.html#cb273-8" tabindex="-1"></a><span class="fu">ggplot</span>(ocean_data_long, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> value, <span class="at">color =</span> ocean_variable)) <span class="sc">+</span></span>
<span id="cb273-9"><a href="case-study-dengue-fever-in-brazil.html#cb273-9" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb273-10"><a href="case-study-dengue-fever-in-brazil.html#cb273-10" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>ocean_variable, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb273-11"><a href="case-study-dengue-fever-in-brazil.html#cb273-11" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb273-12"><a href="case-study-dengue-fever-in-brazil.html#cb273-12" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Ocean Climate Oscillation Indices&quot;</span>,</span>
<span id="cb273-13"><a href="case-study-dengue-fever-in-brazil.html#cb273-13" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Large-scale climate patterns affecting regional weather&quot;</span>,</span>
<span id="cb273-14"><a href="case-study-dengue-fever-in-brazil.html#cb273-14" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Date&quot;</span>,</span>
<span id="cb273-15"><a href="case-study-dengue-fever-in-brazil.html#cb273-15" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Index Value&quot;</span>) <span class="sc">+</span></span>
<span id="cb273-16"><a href="case-study-dengue-fever-in-brazil.html#cb273-16" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="09-casestudy-dengue_files/figure-html/unnamed-chunk-7-1.png" width="1440" /></p>
</div>
<div id="ecological-analysis-incidence-by-environmental-zones" class="section level2 hasAnchor" number="9.8">
<h2><span class="header-section-number">9.8</span> Ecological Analysis: Incidence by Environmental Zones<a href="case-study-dengue-fever-in-brazil.html#ecological-analysis-incidence-by-environmental-zones" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now let’s examine how dengue incidence varies across different biomes and climate zones. Note that the big outbreak observed in 2024 was not seen for every biome in Brazil.</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="case-study-dengue-fever-in-brazil.html#cb274-1" tabindex="-1"></a><span class="co"># Prepare data with environmental classifications</span></span>
<span id="cb274-2"><a href="case-study-dengue-fever-in-brazil.html#cb274-2" tabindex="-1"></a>cases_environment_data <span class="ot">&lt;-</span> case_data <span class="sc">%&gt;%</span></span>
<span id="cb274-3"><a href="case-study-dengue-fever-in-brazil.html#cb274-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">year</span>(date)) <span class="sc">%&gt;%</span></span>
<span id="cb274-4"><a href="case-study-dengue-fever-in-brazil.html#cb274-4" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&lt;</span> <span class="dv">2025</span>) <span class="sc">%&gt;%</span></span>
<span id="cb274-5"><a href="case-study-dengue-fever-in-brazil.html#cb274-5" tabindex="-1"></a>  <span class="fu">left_join</span>(population_data, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&#39;year&#39;</span>, <span class="st">&#39;geocode&#39;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb274-6"><a href="case-study-dengue-fever-in-brazil.html#cb274-6" tabindex="-1"></a>  <span class="fu">left_join</span>(environment_data, <span class="at">by =</span> <span class="st">&#39;geocode&#39;</span>)</span>
<span id="cb274-7"><a href="case-study-dengue-fever-in-brazil.html#cb274-7" tabindex="-1"></a></span>
<span id="cb274-8"><a href="case-study-dengue-fever-in-brazil.html#cb274-8" tabindex="-1"></a><span class="co"># Calculate incidence rates by biome</span></span>
<span id="cb274-9"><a href="case-study-dengue-fever-in-brazil.html#cb274-9" tabindex="-1"></a>incidence_rates_by_biome <span class="ot">&lt;-</span> cases_environment_data <span class="sc">%&gt;%</span></span>
<span id="cb274-10"><a href="case-study-dengue-fever-in-brazil.html#cb274-10" tabindex="-1"></a>  <span class="fu">group_by</span>(date, year, biome) <span class="sc">%&gt;%</span></span>
<span id="cb274-11"><a href="case-study-dengue-fever-in-brazil.html#cb274-11" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">incidence =</span> <span class="fu">sum</span>(casos, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">sum</span>(population, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">10000</span>,</span>
<span id="cb274-12"><a href="case-study-dengue-fever-in-brazil.html#cb274-12" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">&#39;drop&#39;</span>)</span>
<span id="cb274-13"><a href="case-study-dengue-fever-in-brazil.html#cb274-13" tabindex="-1"></a></span>
<span id="cb274-14"><a href="case-study-dengue-fever-in-brazil.html#cb274-14" tabindex="-1"></a><span class="co"># Calculate incidence rates by Köppen climate zone</span></span>
<span id="cb274-15"><a href="case-study-dengue-fever-in-brazil.html#cb274-15" tabindex="-1"></a>incidence_rates_by_koppen <span class="ot">&lt;-</span> cases_environment_data <span class="sc">%&gt;%</span></span>
<span id="cb274-16"><a href="case-study-dengue-fever-in-brazil.html#cb274-16" tabindex="-1"></a>  <span class="fu">group_by</span>(date, koppen) <span class="sc">%&gt;%</span></span>
<span id="cb274-17"><a href="case-study-dengue-fever-in-brazil.html#cb274-17" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">incidence =</span> <span class="fu">sum</span>(casos, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> <span class="fu">sum</span>(population, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">*</span> <span class="dv">10000</span>,</span>
<span id="cb274-18"><a href="case-study-dengue-fever-in-brazil.html#cb274-18" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">&#39;drop&#39;</span>)</span>
<span id="cb274-19"><a href="case-study-dengue-fever-in-brazil.html#cb274-19" tabindex="-1"></a></span>
<span id="cb274-20"><a href="case-study-dengue-fever-in-brazil.html#cb274-20" tabindex="-1"></a><span class="co"># Plot incidence trends by biome</span></span>
<span id="cb274-21"><a href="case-study-dengue-fever-in-brazil.html#cb274-21" tabindex="-1"></a>p_biome <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(incidence_rates_by_biome) <span class="sc">+</span></span>
<span id="cb274-22"><a href="case-study-dengue-fever-in-brazil.html#cb274-22" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> incidence, <span class="at">group =</span> biome), </span>
<span id="cb274-23"><a href="case-study-dengue-fever-in-brazil.html#cb274-23" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&#39;black&#39;</span>, <span class="at">linewidth =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb274-24"><a href="case-study-dengue-fever-in-brazil.html#cb274-24" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> incidence, <span class="at">group =</span> biome, <span class="at">color =</span> biome), </span>
<span id="cb274-25"><a href="case-study-dengue-fever-in-brazil.html#cb274-25" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb274-26"><a href="case-study-dengue-fever-in-brazil.html#cb274-26" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&#39;Set3&#39;</span>) <span class="sc">+</span></span>
<span id="cb274-27"><a href="case-study-dengue-fever-in-brazil.html#cb274-27" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>biome, <span class="at">nrow =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb274-28"><a href="case-study-dengue-fever-in-brazil.html#cb274-28" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb274-29"><a href="case-study-dengue-fever-in-brazil.html#cb274-29" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Dengue Incidence by Biome&quot;</span>,</span>
<span id="cb274-30"><a href="case-study-dengue-fever-in-brazil.html#cb274-30" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Date&quot;</span>,</span>
<span id="cb274-31"><a href="case-study-dengue-fever-in-brazil.html#cb274-31" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Incidence per 10,000&quot;</span>) <span class="sc">+</span></span>
<span id="cb274-32"><a href="case-study-dengue-fever-in-brazil.html#cb274-32" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb274-33"><a href="case-study-dengue-fever-in-brazil.html#cb274-33" tabindex="-1"></a></span>
<span id="cb274-34"><a href="case-study-dengue-fever-in-brazil.html#cb274-34" tabindex="-1"></a><span class="co"># Plot incidence trends by Köppen climate zone</span></span>
<span id="cb274-35"><a href="case-study-dengue-fever-in-brazil.html#cb274-35" tabindex="-1"></a>p_koppen <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(incidence_rates_by_koppen) <span class="sc">+</span></span>
<span id="cb274-36"><a href="case-study-dengue-fever-in-brazil.html#cb274-36" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> incidence, <span class="at">group =</span> koppen), </span>
<span id="cb274-37"><a href="case-study-dengue-fever-in-brazil.html#cb274-37" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">&#39;black&#39;</span>, <span class="at">linewidth =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb274-38"><a href="case-study-dengue-fever-in-brazil.html#cb274-38" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> incidence, <span class="at">group =</span> koppen, <span class="at">color =</span> koppen), </span>
<span id="cb274-39"><a href="case-study-dengue-fever-in-brazil.html#cb274-39" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb274-40"><a href="case-study-dengue-fever-in-brazil.html#cb274-40" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&#39;Paired&#39;</span>) <span class="sc">+</span></span>
<span id="cb274-41"><a href="case-study-dengue-fever-in-brazil.html#cb274-41" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>koppen, <span class="at">nrow =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb274-42"><a href="case-study-dengue-fever-in-brazil.html#cb274-42" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb274-43"><a href="case-study-dengue-fever-in-brazil.html#cb274-43" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Dengue Incidence by Köppen Climate Zone&quot;</span>,</span>
<span id="cb274-44"><a href="case-study-dengue-fever-in-brazil.html#cb274-44" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Date&quot;</span>,</span>
<span id="cb274-45"><a href="case-study-dengue-fever-in-brazil.html#cb274-45" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Incidence per 10,000&quot;</span>) <span class="sc">+</span></span>
<span id="cb274-46"><a href="case-study-dengue-fever-in-brazil.html#cb274-46" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb274-47"><a href="case-study-dengue-fever-in-brazil.html#cb274-47" tabindex="-1"></a></span>
<span id="cb274-48"><a href="case-study-dengue-fever-in-brazil.html#cb274-48" tabindex="-1"></a>p_biome</span></code></pre></div>
<p><img src="09-casestudy-dengue_files/figure-html/unnamed-chunk-8-1.png" width="1920" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="case-study-dengue-fever-in-brazil.html#cb275-1" tabindex="-1"></a>p_koppen</span></code></pre></div>
<p><img src="09-casestudy-dengue_files/figure-html/unnamed-chunk-8-2.png" width="1920" style="display: block; margin: auto;" /></p>
</div>
<div id="seasonal-analysis-weekly-patterns-by-biome" class="section level2 hasAnchor" number="9.9">
<h2><span class="header-section-number">9.9</span> Seasonal Analysis: Weekly Patterns by Biome<a href="case-study-dengue-fever-in-brazil.html#seasonal-analysis-weekly-patterns-by-biome" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Dengue transmission is highly seasonal, influenced by rainfall, temperature, and mosquito breeding cycles. Let’s examine the seasonal patterns across different biomes:</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="case-study-dengue-fever-in-brazil.html#cb276-1" tabindex="-1"></a><span class="co"># Prepare seasonal analysis (excluding incomplete 2025 data)</span></span>
<span id="cb276-2"><a href="case-study-dengue-fever-in-brazil.html#cb276-2" tabindex="-1"></a>seasonal_data <span class="ot">&lt;-</span> incidence_rates_by_biome <span class="sc">%&gt;%</span></span>
<span id="cb276-3"><a href="case-study-dengue-fever-in-brazil.html#cb276-3" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">!=</span> <span class="dv">2025</span>) <span class="sc">%&gt;%</span></span>
<span id="cb276-4"><a href="case-study-dengue-fever-in-brazil.html#cb276-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">week =</span> <span class="fu">week</span>(date))</span>
<span id="cb276-5"><a href="case-study-dengue-fever-in-brazil.html#cb276-5" tabindex="-1"></a></span>
<span id="cb276-6"><a href="case-study-dengue-fever-in-brazil.html#cb276-6" tabindex="-1"></a><span class="co"># Calculate average weekly incidence by biome</span></span>
<span id="cb276-7"><a href="case-study-dengue-fever-in-brazil.html#cb276-7" tabindex="-1"></a>seasonal_incidence_by_biome <span class="ot">&lt;-</span> seasonal_data <span class="sc">%&gt;%</span></span>
<span id="cb276-8"><a href="case-study-dengue-fever-in-brazil.html#cb276-8" tabindex="-1"></a>  <span class="fu">group_by</span>(biome, week) <span class="sc">%&gt;%</span></span>
<span id="cb276-9"><a href="case-study-dengue-fever-in-brazil.html#cb276-9" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_incidence =</span> <span class="fu">mean</span>(incidence, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), </span>
<span id="cb276-10"><a href="case-study-dengue-fever-in-brazil.html#cb276-10" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">&#39;drop&#39;</span>)</span>
<span id="cb276-11"><a href="case-study-dengue-fever-in-brazil.html#cb276-11" tabindex="-1"></a></span>
<span id="cb276-12"><a href="case-study-dengue-fever-in-brazil.html#cb276-12" tabindex="-1"></a><span class="co"># Plot seasonal patterns</span></span>
<span id="cb276-13"><a href="case-study-dengue-fever-in-brazil.html#cb276-13" tabindex="-1"></a><span class="fu">ggplot</span>(seasonal_incidence_by_biome, <span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> mean_incidence, <span class="at">color =</span> biome)) <span class="sc">+</span></span>
<span id="cb276-14"><a href="case-study-dengue-fever-in-brazil.html#cb276-14" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb276-15"><a href="case-study-dengue-fever-in-brazil.html#cb276-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Seasonal Dengue Patterns by Biome&quot;</span>,</span>
<span id="cb276-16"><a href="case-study-dengue-fever-in-brazil.html#cb276-16" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Average weekly incidence across all years (2010-2024)&quot;</span>,</span>
<span id="cb276-17"><a href="case-study-dengue-fever-in-brazil.html#cb276-17" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Week of Year&quot;</span>,</span>
<span id="cb276-18"><a href="case-study-dengue-fever-in-brazil.html#cb276-18" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Mean Incidence per 10,000 Population&quot;</span>,</span>
<span id="cb276-19"><a href="case-study-dengue-fever-in-brazil.html#cb276-19" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Biome&quot;</span>) <span class="sc">+</span></span>
<span id="cb276-20"><a href="case-study-dengue-fever-in-brazil.html#cb276-20" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Dark2&quot;</span>) <span class="sc">+</span></span>
<span id="cb276-21"><a href="case-study-dengue-fever-in-brazil.html#cb276-21" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb276-22"><a href="case-study-dengue-fever-in-brazil.html#cb276-22" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">53</span>), </span>
<span id="cb276-23"><a href="case-study-dengue-fever-in-brazil.html#cb276-23" tabindex="-1"></a>                     <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">53</span>, <span class="at">by =</span> <span class="dv">4</span>),</span>
<span id="cb276-24"><a href="case-study-dengue-fever-in-brazil.html#cb276-24" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">53</span>, <span class="at">by =</span> <span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb276-25"><a href="case-study-dengue-fever-in-brazil.html#cb276-25" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
## ℹ Please use `linewidth` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<p><img src="09-casestudy-dengue_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Now this is an interesting one. Here you see the total number of incidence rates per calendar week between 2010 and 2024 per biome. The absolute number is not really important, which I assume heavily depends on how populated these areas are. What is interesting though, is that in the final few weeks of the year, cases rise in the <em>cerrado</em>, <em>pantanal</em> and <em>mata atlantica</em>, while cases in <em>caatinga</em> and <em>pampa</em> rise much later (week 5 and 9 respectively). We can probably have a look whether there are any climate variables that rise and fall around the same periods in the same areas, and whether this pattern is observed over multiple years or is just an artefact of the aggregation of all years combined.</p>
</div>
<div id="discussion-and-key-findings" class="section level2 hasAnchor" number="9.10">
<h2><span class="header-section-number">9.10</span> Discussion and Key Findings<a href="case-study-dengue-fever-in-brazil.html#discussion-and-key-findings" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This comprehensive analysis of dengue patterns in Brazil reveals several important epidemiological insights:</p>
<p><strong>Temporal Patterns:</strong>
- Clear epidemic cycles with major outbreaks occurring every few years
- Strong seasonal patterns with peak transmission during warmer, wetter months
- Variation in seasonal timing across different biomes and climate zones</p>
<p><strong>Spatial Patterns:</strong>
- Heterogeneous distribution across Brazil’s diverse geography
- Higher incidence rates in tropical and subtropical regions
- Urban and peri-urban areas showing different transmission dynamics</p>
<p><strong>Environmental Associations:</strong>
- Different biomes exhibit distinct seasonal patterns and incidence levels
- Climate zones show varying susceptibility to dengue transmission
- Large-scale climate oscillations may influence epidemic timing and intensity</p>
<p>This analysis demonstrates the complexity of dengue epidemiology and the importance of considering environmental, temporal, and spatial factors in understanding disease transmission patterns. Such insights are crucial for developing targeted prevention strategies and early warning systems for dengue control in Brazil.</p>
</div>
<div id="further-analysis-opportunities" class="section level2 hasAnchor" number="9.11">
<h2><span class="header-section-number">9.11</span> Further Analysis Opportunities<a href="case-study-dengue-fever-in-brazil.html#further-analysis-opportunities" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This dataset provides numerous opportunities for additional epidemiological investigations:
- Statistical modeling of climate-disease associations
- Time series analysis and forecasting
- Spatial clustering analysis
- Risk factor identification and quantification
- Evaluation of control interventions</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="working-with-epidemiological-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="modelling.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/stends2001/EpiBible/blob/main09-casestudy-dengue.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["EpiBible.pdf", "EpiBible.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
