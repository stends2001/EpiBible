<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Statistics | Epidemiology in R: A Hands-on Approach</title>
  <meta name="description" content="Chapter 7 Statistics | Epidemiology in R: A Hands-on Approach" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Statistics | Epidemiology in R: A Hands-on Approach" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Statistics | Epidemiology in R: A Hands-on Approach" />
  
  
  

<meta name="author" content="Sten de Schrijver" />


<meta name="date" content="2025-08-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-visualization-in-r.html"/>
<link rel="next" href="working-with-epidemiological-data.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Epidemiology in R: A Hands-on Approach</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="about-the-author.html"><a href="about-the-author.html"><i class="fa fa-check"></i>About the Author</a></li>
<li class="chapter" data-level="1" data-path="introduction-to-epidemiology.html"><a href="introduction-to-epidemiology.html"><i class="fa fa-check"></i><b>1</b> Introduction to Epidemiology</a></li>
<li class="chapter" data-level="2" data-path="working-with-this-book.html"><a href="working-with-this-book.html"><i class="fa fa-check"></i><b>2</b> Working with this book</a>
<ul>
<li class="chapter" data-level="2.1" data-path="working-with-this-book.html"><a href="working-with-this-book.html#what-is-bookdown"><i class="fa fa-check"></i><b>2.1</b> What is bookdown?</a></li>
<li class="chapter" data-level="2.2" data-path="working-with-this-book.html"><a href="working-with-this-book.html#code-snippets"><i class="fa fa-check"></i><b>2.2</b> Code snippets</a></li>
<li class="chapter" data-level="2.3" data-path="working-with-this-book.html"><a href="working-with-this-book.html#a-hands-on-approach"><i class="fa fa-check"></i><b>2.3</b> A Hand’s-on Approach</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html"><i class="fa fa-check"></i><b>3</b> Getting Started with R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#installing-r-and-rstudio"><i class="fa fa-check"></i><b>3.1</b> Installing R and Rstudio</a></li>
<li class="chapter" data-level="3.2" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#starting-to-code"><i class="fa fa-check"></i><b>3.2</b> Starting to code</a></li>
<li class="chapter" data-level="3.3" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#r-projects-and-organization"><i class="fa fa-check"></i><b>3.3</b> R Projects and Organization</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="r-fundamentals.html"><a href="r-fundamentals.html"><i class="fa fa-check"></i><b>4</b> R fundamentals</a>
<ul>
<li class="chapter" data-level="4.1" data-path="r-fundamentals.html"><a href="r-fundamentals.html#basic-datatypes-in-r"><i class="fa fa-check"></i><b>4.1</b> Basic Datatypes in R</a></li>
<li class="chapter" data-level="4.2" data-path="r-fundamentals.html"><a href="r-fundamentals.html#special-datatypes"><i class="fa fa-check"></i><b>4.2</b> Special datatypes</a></li>
<li class="chapter" data-level="4.3" data-path="r-fundamentals.html"><a href="r-fundamentals.html#converting-between-datatypes"><i class="fa fa-check"></i><b>4.3</b> Converting between datatypes</a></li>
<li class="chapter" data-level="4.4" data-path="r-fundamentals.html"><a href="r-fundamentals.html#data-structures-in-r"><i class="fa fa-check"></i><b>4.4</b> Data structures in R</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="r-fundamentals.html"><a href="r-fundamentals.html#vectors-the-building-blocks"><i class="fa fa-check"></i><b>4.4.1</b> Vectors: The Building Blocks</a></li>
<li class="chapter" data-level="4.4.2" data-path="r-fundamentals.html"><a href="r-fundamentals.html#lists-mixed-data-collections"><i class="fa fa-check"></i><b>4.4.2</b> Lists: Mixed Data Collections</a></li>
<li class="chapter" data-level="4.4.3" data-path="r-fundamentals.html"><a href="r-fundamentals.html#data-frames-the-excel-of-r"><i class="fa fa-check"></i><b>4.4.3</b> Data Frames: The Excel of R</a></li>
<li class="chapter" data-level="4.4.4" data-path="r-fundamentals.html"><a href="r-fundamentals.html#indexing-accessing-your-data"><i class="fa fa-check"></i><b>4.4.4</b> Indexing: Accessing Your Data</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="r-fundamentals.html"><a href="r-fundamentals.html#conditions-and-comparisons"><i class="fa fa-check"></i><b>4.5</b> Conditions and Comparisons</a></li>
<li class="chapter" data-level="4.6" data-path="r-fundamentals.html"><a href="r-fundamentals.html#conditional-execution-with"><i class="fa fa-check"></i><b>4.6</b> Conditional execution with</a></li>
<li class="chapter" data-level="4.7" data-path="r-fundamentals.html"><a href="r-fundamentals.html#repeating-lines-of-code"><i class="fa fa-check"></i><b>4.7</b> Repeating lines of code</a></li>
<li class="chapter" data-level="4.8" data-path="r-fundamentals.html"><a href="r-fundamentals.html#functions"><i class="fa fa-check"></i><b>4.8</b> Functions</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html"><i class="fa fa-check"></i><b>5</b> Introduction to the Tidyverse</a>
<ul>
<li class="chapter" data-level="5.1" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#data-structure-wide-vs.-tidy-data"><i class="fa fa-check"></i><b>5.1</b> Data Structure: Wide vs. Tidy Data</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#understanding-the-difference"><i class="fa fa-check"></i><b>5.1.1</b> Understanding the Difference</a></li>
<li class="chapter" data-level="5.1.2" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#reshaping-data-with-tidyr"><i class="fa fa-check"></i><b>5.1.2</b> Reshaping Data with tidyr</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#core-dplyr-functions-for-data-manipulation"><i class="fa fa-check"></i><b>5.2</b> Core dplyr Functions for Data Manipulation</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#the-pipe-operator"><i class="fa fa-check"></i><b>5.2.1</b> The Pipe Operator (<code>%&gt;%</code>)</a></li>
<li class="chapter" data-level="5.2.2" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#select-choose-columns"><i class="fa fa-check"></i><b>5.2.2</b> <code>select()</code>: Choose Columns</a></li>
<li class="chapter" data-level="5.2.3" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#filter-choose-rows"><i class="fa fa-check"></i><b>5.2.3</b> <code>filter()</code>: Choose Rows</a></li>
<li class="chapter" data-level="5.2.4" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#mutate-create-or-modify-columns"><i class="fa fa-check"></i><b>5.2.4</b> <code>mutate()</code>: Create or Modify Columns</a></li>
<li class="chapter" data-level="5.2.5" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#transmute-create-new-columns-drop-others"><i class="fa fa-check"></i><b>5.2.5</b> <code>transmute()</code>: Create New Columns (Drop Others)</a></li>
<li class="chapter" data-level="5.2.6" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#arrange-sort-rows"><i class="fa fa-check"></i><b>5.2.6</b> <code>arrange()</code>: Sort Rows</a></li>
<li class="chapter" data-level="5.2.7" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#group_by-and-summarise-group-operations"><i class="fa fa-check"></i><b>5.2.7</b> <code>group_by()</code> and <code>summarise()</code>: Group Operations</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#additional-essential-functions"><i class="fa fa-check"></i><b>5.3</b> Additional Essential Functions</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#rename-change-column-names"><i class="fa fa-check"></i><b>5.3.1</b> <code>rename()</code>: Change Column Names</a></li>
<li class="chapter" data-level="5.3.2" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#data-type-conversions"><i class="fa fa-check"></i><b>5.3.2</b> Data Type Conversions</a></li>
<li class="chapter" data-level="5.3.3" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#across-apply-functions-to-multiple-columns"><i class="fa fa-check"></i><b>5.3.3</b> <code>across()</code>: Apply Functions to Multiple Columns</a></li>
<li class="chapter" data-level="5.3.4" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#recode-recode-values"><i class="fa fa-check"></i><b>5.3.4</b> <code>recode()</code>: Recode Values</a></li>
<li class="chapter" data-level="5.3.5" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#case_when-multiple-conditional-logic"><i class="fa fa-check"></i><b>5.3.5</b> <code>case_when()</code>: Multiple Conditional Logic</a></li>
<li class="chapter" data-level="5.3.6" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#replace_na-handle-missing-values"><i class="fa fa-check"></i><b>5.3.6</b> <code>replace_na()</code>: Handle Missing Values</a></li>
<li class="chapter" data-level="5.3.7" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#which-find-positions"><i class="fa fa-check"></i><b>5.3.7</b> <code>which()</code>: Find Positions</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#practical-example-data-analysis-workflow"><i class="fa fa-check"></i><b>5.4</b> Practical Example: Data Analysis Workflow</a></li>
<li class="chapter" data-level="5.5" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#function-summary-table"><i class="fa fa-check"></i><b>5.5</b> Function Summary Table</a></li>
<li class="chapter" data-level="5.6" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#conclusion"><i class="fa fa-check"></i><b>5.6</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html"><i class="fa fa-check"></i><b>6</b> Data Visualization in R</a>
<ul>
<li class="chapter" data-level="6.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#ggplot2-the-grammar-of-graphics"><i class="fa fa-check"></i><b>6.1</b> ggplot2: The Grammar of Graphics</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#basic-ggplot2-structure"><i class="fa fa-check"></i><b>6.1.1</b> Basic ggplot2 Structure</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#basic-plot-types"><i class="fa fa-check"></i><b>6.2</b> Basic Plot Types</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#scatter-plots-with-geom_point"><i class="fa fa-check"></i><b>6.2.1</b> Scatter Plots with <code>geom_point()</code></a></li>
<li class="chapter" data-level="6.2.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#line-plots-with-geom_line"><i class="fa fa-check"></i><b>6.2.2</b> Line Plots with <code>geom_line()</code></a></li>
<li class="chapter" data-level="6.2.3" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#bar-plots-with-geom_col-and-geom_bar"><i class="fa fa-check"></i><b>6.2.3</b> Bar Plots with <code>geom_col()</code> and <code>geom_bar()</code></a></li>
<li class="chapter" data-level="6.2.4" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#histograms-with-geom_histogram"><i class="fa fa-check"></i><b>6.2.4</b> Histograms with <code>geom_histogram()</code></a></li>
<li class="chapter" data-level="6.2.5" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#box-plots-with-geom_boxplot"><i class="fa fa-check"></i><b>6.2.5</b> Box Plots with <code>geom_boxplot()</code></a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#aesthetic-mappings"><i class="fa fa-check"></i><b>6.3</b> Aesthetic Mappings</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#understanding-aes"><i class="fa fa-check"></i><b>6.3.1</b> Understanding <code>aes()</code></a></li>
<li class="chapter" data-level="6.3.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#fixed-vs.-mapped-aesthetics"><i class="fa fa-check"></i><b>6.3.2</b> Fixed vs. Mapped Aesthetics</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#faceting-small-multiples"><i class="fa fa-check"></i><b>6.4</b> Faceting: Small Multiples</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#facet_wrap"><i class="fa fa-check"></i><b>6.4.1</b> <code>facet_wrap()</code></a></li>
<li class="chapter" data-level="6.4.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#facet_grid"><i class="fa fa-check"></i><b>6.4.2</b> <code>facet_grid()</code></a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#statistical-transformations"><i class="fa fa-check"></i><b>6.5</b> Statistical Transformations</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#smooth-lines-with-geom_smooth"><i class="fa fa-check"></i><b>6.5.1</b> Smooth Lines with <code>geom_smooth()</code></a></li>
<li class="chapter" data-level="6.5.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#statistical-summaries"><i class="fa fa-check"></i><b>6.5.2</b> Statistical Summaries</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#scales-controlling-aesthetic-mappings"><i class="fa fa-check"></i><b>6.6</b> Scales: Controlling Aesthetic Mappings</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#color-scales"><i class="fa fa-check"></i><b>6.6.1</b> Color Scales</a></li>
<li class="chapter" data-level="6.6.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#axis-scales"><i class="fa fa-check"></i><b>6.6.2</b> Axis Scales</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#coordinates-and-transformations"><i class="fa fa-check"></i><b>6.7</b> Coordinates and Transformations</a></li>
<li class="chapter" data-level="6.8" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#labels-and-themes"><i class="fa fa-check"></i><b>6.8</b> Labels and Themes</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#adding-labels"><i class="fa fa-check"></i><b>6.8.1</b> Adding Labels</a></li>
<li class="chapter" data-level="6.8.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#theme-customization"><i class="fa fa-check"></i><b>6.8.2</b> Theme Customization</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#heatmaps"><i class="fa fa-check"></i><b>6.9</b> Heatmaps</a></li>
<li class="chapter" data-level="6.10" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#combining-multiple-geoms"><i class="fa fa-check"></i><b>6.10</b> Combining Multiple Geoms</a></li>
<li class="chapter" data-level="6.11" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#text-and-annotations"><i class="fa fa-check"></i><b>6.11</b> Text and Annotations</a></li>
<li class="chapter" data-level="6.12" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#practical-example-complex-multi-layered-plot"><i class="fa fa-check"></i><b>6.12</b> Practical Example: Complex Multi-layered Plot</a></li>
<li class="chapter" data-level="6.13" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#ggplot2-function-summary-table"><i class="fa fa-check"></i><b>6.13</b> ggplot2 Function Summary Table</a></li>
<li class="chapter" data-level="6.14" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#tips-and-tricks"><i class="fa fa-check"></i><b>6.14</b> Tips and Tricks</a></li>
<li class="chapter" data-level="6.15" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#conclusion-1"><i class="fa fa-check"></i><b>6.15</b> Conclusion</a></li>
<li class="chapter" data-level="6.16" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#my-favorite-figures-i-ever-made"><i class="fa fa-check"></i><b>6.16</b> My favorite figures I ever made</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>7</b> Statistics</a>
<ul>
<li class="chapter" data-level="7.1" data-path="statistics.html"><a href="statistics.html#descriptive-statistics-and-outbreak-investigation"><i class="fa fa-check"></i><b>7.1</b> Descriptive statistics and outbreak investigation</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="statistics.html"><a href="statistics.html#introduction"><i class="fa fa-check"></i><b>7.1.1</b> Introduction</a></li>
<li class="chapter" data-level="7.1.2" data-path="statistics.html"><a href="statistics.html#loading-and-exploring-the-data"><i class="fa fa-check"></i><b>7.1.2</b> Loading and Exploring the Data</a></li>
<li class="chapter" data-level="7.1.3" data-path="statistics.html"><a href="statistics.html#data-preparation-creating-a-tidy-dataset"><i class="fa fa-check"></i><b>7.1.3</b> Data Preparation: Creating a Tidy Dataset</a></li>
<li class="chapter" data-level="7.1.4" data-path="statistics.html"><a href="statistics.html#initial-visual-exploration"><i class="fa fa-check"></i><b>7.1.4</b> Initial Visual Exploration</a></li>
<li class="chapter" data-level="7.1.5" data-path="statistics.html"><a href="statistics.html#comparing-cases-and-controls"><i class="fa fa-check"></i><b>7.1.5</b> Comparing Cases and Controls</a></li>
<li class="chapter" data-level="7.1.6" data-path="statistics.html"><a href="statistics.html#statistical-analysis-attack-rates-and-odds-ratios"><i class="fa fa-check"></i><b>7.1.6</b> Statistical Analysis: Attack Rates and Odds Ratios</a></li>
<li class="chapter" data-level="7.1.7" data-path="statistics.html"><a href="statistics.html#calculating-statistics-for-our-data"><i class="fa fa-check"></i><b>7.1.7</b> Calculating Statistics for Our Data</a></li>
<li class="chapter" data-level="7.1.8" data-path="statistics.html"><a href="statistics.html#interpretation-of-results"><i class="fa fa-check"></i><b>7.1.8</b> Interpretation of Results</a></li>
<li class="chapter" data-level="7.1.9" data-path="statistics.html"><a href="statistics.html#conclusion-2"><i class="fa fa-check"></i><b>7.1.9</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="statistics.html"><a href="statistics.html#inferential-statistics-in-epidemiology"><i class="fa fa-check"></i><b>7.2</b> Inferential statistics in epidemiology</a></li>
<li class="chapter" data-level="7.3" data-path="statistics.html"><a href="statistics.html#inferential-statistics-in-epidemiology-1"><i class="fa fa-check"></i><b>7.3</b> Inferential Statistics in Epidemiology</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="statistics.html"><a href="statistics.html#understanding-statistical-significance"><i class="fa fa-check"></i><b>7.3.1</b> Understanding Statistical Significance</a></li>
<li class="chapter" data-level="7.3.2" data-path="statistics.html"><a href="statistics.html#comparing-demographics-between-cases-and-controls"><i class="fa fa-check"></i><b>7.3.2</b> Comparing Demographics Between Cases and Controls</a></li>
<li class="chapter" data-level="7.3.3" data-path="statistics.html"><a href="statistics.html#testing-food-exposures-statistical-significance-of-associations"><i class="fa fa-check"></i><b>7.3.3</b> Testing Food Exposures: Statistical Significance of Associations</a></li>
<li class="chapter" data-level="7.3.4" data-path="statistics.html"><a href="statistics.html#confidence-intervals-for-odds-ratios"><i class="fa fa-check"></i><b>7.3.4</b> Confidence Intervals for Odds Ratios</a></li>
<li class="chapter" data-level="7.3.5" data-path="statistics.html"><a href="statistics.html#interpreting-the-results"><i class="fa fa-check"></i><b>7.3.5</b> Interpreting the Results</a></li>
<li class="chapter" data-level="7.3.6" data-path="statistics.html"><a href="statistics.html#key-statistical-concepts-for-interpretation"><i class="fa fa-check"></i><b>7.3.6</b> Key Statistical Concepts for Interpretation</a></li>
<li class="chapter" data-level="7.3.7" data-path="statistics.html"><a href="statistics.html#summary"><i class="fa fa-check"></i><b>7.3.7</b> Summary</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="working-with-epidemiological-data.html"><a href="working-with-epidemiological-data.html"><i class="fa fa-check"></i><b>8</b> Working with epidemiological data</a>
<ul>
<li class="chapter" data-level="8.1" data-path="working-with-epidemiological-data.html"><a href="working-with-epidemiological-data.html#acessing-data"><i class="fa fa-check"></i><b>8.1</b> Acessing data</a></li>
<li class="chapter" data-level="8.2" data-path="working-with-epidemiological-data.html"><a href="working-with-epidemiological-data.html#imperfect-epidemiological-data"><i class="fa fa-check"></i><b>8.2</b> (Imperfect) epidemiological data</a></li>
<li class="chapter" data-level="8.3" data-path="working-with-epidemiological-data.html"><a href="working-with-epidemiological-data.html#case-study-1-yellow-fever"><i class="fa fa-check"></i><b>8.3</b> Case Study 1: Yellow Fever</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="case-study-dengue-fever-in-brazil.html"><a href="case-study-dengue-fever-in-brazil.html"><i class="fa fa-check"></i><b>9</b> Case Study: Dengue Fever in Brazil</a>
<ul>
<li class="chapter" data-level="9.1" data-path="case-study-dengue-fever-in-brazil.html"><a href="case-study-dengue-fever-in-brazil.html#introduction-1"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="case-study-dengue-fever-in-brazil.html"><a href="case-study-dengue-fever-in-brazil.html#data-sources-and-structure"><i class="fa fa-check"></i><b>9.2</b> Data Sources and Structure</a></li>
<li class="chapter" data-level="9.3" data-path="case-study-dengue-fever-in-brazil.html"><a href="case-study-dengue-fever-in-brazil.html#data-import-and-preparation"><i class="fa fa-check"></i><b>9.3</b> Data Import and Preparation</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="case-study-dengue-fever-in-brazil.html"><a href="case-study-dengue-fever-in-brazil.html#data-type-standardization"><i class="fa fa-check"></i><b>9.3.1</b> Data Type Standardization</a></li>
<li class="chapter" data-level="9.3.2" data-path="case-study-dengue-fever-in-brazil.html"><a href="case-study-dengue-fever-in-brazil.html#geographic-data-import"><i class="fa fa-check"></i><b>9.3.2</b> Geographic Data Import</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="case-study-dengue-fever-in-brazil.html"><a href="case-study-dengue-fever-in-brazil.html#temporal-analysis-national-dengue-trends"><i class="fa fa-check"></i><b>9.4</b> Temporal Analysis: National Dengue Trends</a></li>
<li class="chapter" data-level="9.5" data-path="case-study-dengue-fever-in-brazil.html"><a href="case-study-dengue-fever-in-brazil.html#spatial-analysis-environmental-context"><i class="fa fa-check"></i><b>9.5</b> Spatial Analysis: Environmental Context</a></li>
<li class="chapter" data-level="9.6" data-path="case-study-dengue-fever-in-brazil.html"><a href="case-study-dengue-fever-in-brazil.html#temporal-spatial-analysis-annual-incidence-maps"><i class="fa fa-check"></i><b>9.6</b> Temporal-Spatial Analysis: Annual Incidence Maps</a></li>
<li class="chapter" data-level="9.7" data-path="case-study-dengue-fever-in-brazil.html"><a href="case-study-dengue-fever-in-brazil.html#climate-oscillations-large-scale-environmental-drivers"><i class="fa fa-check"></i><b>9.7</b> Climate Oscillations: Large-Scale Environmental Drivers</a></li>
<li class="chapter" data-level="9.8" data-path="case-study-dengue-fever-in-brazil.html"><a href="case-study-dengue-fever-in-brazil.html#ecological-analysis-incidence-by-environmental-zones"><i class="fa fa-check"></i><b>9.8</b> Ecological Analysis: Incidence by Environmental Zones</a></li>
<li class="chapter" data-level="9.9" data-path="case-study-dengue-fever-in-brazil.html"><a href="case-study-dengue-fever-in-brazil.html#seasonal-analysis-weekly-patterns-by-biome"><i class="fa fa-check"></i><b>9.9</b> Seasonal Analysis: Weekly Patterns by Biome</a></li>
<li class="chapter" data-level="9.10" data-path="case-study-dengue-fever-in-brazil.html"><a href="case-study-dengue-fever-in-brazil.html#discussion-and-key-findings"><i class="fa fa-check"></i><b>9.10</b> Discussion and Key Findings</a></li>
<li class="chapter" data-level="9.11" data-path="case-study-dengue-fever-in-brazil.html"><a href="case-study-dengue-fever-in-brazil.html#further-analysis-opportunities"><i class="fa fa-check"></i><b>9.11</b> Further Analysis Opportunities</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="modelling.html"><a href="modelling.html"><i class="fa fa-check"></i><b>10</b> Modelling</a>
<ul>
<li class="chapter" data-level="10.1" data-path="modelling.html"><a href="modelling.html#compartmental-models"><i class="fa fa-check"></i><b>10.1</b> Compartmental models</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="modelling.html"><a href="modelling.html#sir-model-in-theory"><i class="fa fa-check"></i><b>10.1.1</b> SIR model in theory</a></li>
<li class="chapter" data-level="10.1.2" data-path="modelling.html"><a href="modelling.html#sir-model-in-r"><i class="fa fa-check"></i><b>10.1.2</b> SIR model in R</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="modelling.html"><a href="modelling.html#time-series---forecasting"><i class="fa fa-check"></i><b>10.2</b> Time series - Forecasting</a></li>
<li class="chapter" data-level="10.3" data-path="modelling.html"><a href="modelling.html#using-and-applying-models"><i class="fa fa-check"></i><b>10.3</b> Using and applying models</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="communication-and-sharing-of-code-and-data.html"><a href="communication-and-sharing-of-code-and-data.html"><i class="fa fa-check"></i><b>11</b> Communication and sharing of code and data</a>
<ul>
<li class="chapter" data-level="11.1" data-path="communication-and-sharing-of-code-and-data.html"><a href="communication-and-sharing-of-code-and-data.html#writing-code-best-practices"><i class="fa fa-check"></i><b>11.1</b> Writing code: best practices</a></li>
<li class="chapter" data-level="11.2" data-path="communication-and-sharing-of-code-and-data.html"><a href="communication-and-sharing-of-code-and-data.html#github"><i class="fa fa-check"></i><b>11.2</b> Github</a></li>
<li class="chapter" data-level="11.3" data-path="communication-and-sharing-of-code-and-data.html"><a href="communication-and-sharing-of-code-and-data.html#reports-using-markdown"><i class="fa fa-check"></i><b>11.3</b> Reports using Markdown</a></li>
<li class="chapter" data-level="11.4" data-path="communication-and-sharing-of-code-and-data.html"><a href="communication-and-sharing-of-code-and-data.html#open-science"><i class="fa fa-check"></i><b>11.4</b> Open science</a></li>
<li class="chapter" data-level="11.5" data-path="communication-and-sharing-of-code-and-data.html"><a href="communication-and-sharing-of-code-and-data.html#communities-and-forums"><i class="fa fa-check"></i><b>11.5</b> Communities and forums</a></li>
<li class="chapter" data-level="11.6" data-path="communication-and-sharing-of-code-and-data.html"><a href="communication-and-sharing-of-code-and-data.html#how-to-use-chat-gpt"><i class="fa fa-check"></i><b>11.6</b> How to use Chat-GPT</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="recommended-reading.html"><a href="recommended-reading.html"><i class="fa fa-check"></i><b>12</b> Recommended Reading</a>
<ul>
<li class="chapter" data-level="12.1" data-path="recommended-reading.html"><a href="recommended-reading.html#recommended-textbooks-and-courses"><i class="fa fa-check"></i><b>12.1</b> Recommended textbooks and courses</a></li>
<li class="chapter" data-level="12.2" data-path="recommended-reading.html"><a href="recommended-reading.html#datasources"><i class="fa fa-check"></i><b>12.2</b> Datasources</a></li>
<li class="chapter" data-level="12.3" data-path="recommended-reading.html"><a href="recommended-reading.html#useful-packages"><i class="fa fa-check"></i><b>12.3</b> Useful packages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Epidemiology in R: A Hands-on Approach</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="statistics" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Chapter 7</span> Statistics<a href="statistics.html#statistics" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Broadly speaking, there’s two fields of statistics, namely <strong>descriptive statistics</strong> and <strong>inferential statistics</strong>. Descriptive statistics summarize and organize data to make it understandable, using measures like means, medians, proportions, or visualizations such as histograms and bar charts. In contrast, inferential statistics go a step further by using data from a sample to make conclusions or predictions about a larger population. This involves estimating parameters, testing hypotheses, and calculating measures.</p>
<div id="descriptive-statistics-and-outbreak-investigation" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> Descriptive statistics and outbreak investigation<a href="statistics.html#descriptive-statistics-and-outbreak-investigation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="introduction" class="section level3 hasAnchor" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> Introduction<a href="statistics.html#introduction" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Outbreak investigations are critical components of public health practice. When people become sick from a common source, epidemiologists work quickly to identify the cause and prevent further illness. In this chapter, we’ll analyze data from a <strong>Salmonella Typhimurium</strong> outbreak to demonstrate how statistical analysis can help identify the source of foodborne illness.</p>
<p>We’ll be working with the <code>S.typh</code> dataset from the Epi package, which contains data from a real outbreak investigation conducted as a <strong>matched case-control study</strong>.</p>
</div>
<div id="loading-and-exploring-the-data" class="section level3 hasAnchor" number="7.1.2">
<h3><span class="header-section-number">7.1.2</span> Loading and Exploring the Data<a href="statistics.html#loading-and-exploring-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="statistics.html#cb196-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
## ✔ dplyr     1.1.4     ✔ readr     2.1.5
## ✔ forcats   1.0.0     ✔ stringr   1.5.1
## ✔ ggplot2   3.5.1     ✔ tibble    3.2.1
## ✔ lubridate 1.9.3     ✔ tidyr     1.3.1
## ✔ purrr     1.0.2     
## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()
## ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="statistics.html#cb198-1" tabindex="-1"></a><span class="fu">library</span>(Epi)</span>
<span id="cb198-2"><a href="statistics.html#cb198-2" tabindex="-1"></a></span>
<span id="cb198-3"><a href="statistics.html#cb198-3" tabindex="-1"></a><span class="co"># Load the dataset</span></span>
<span id="cb198-4"><a href="statistics.html#cb198-4" tabindex="-1"></a><span class="fu">data</span>(S.typh)</span>
<span id="cb198-5"><a href="statistics.html#cb198-5" tabindex="-1"></a>typhoid_data <span class="ot">&lt;-</span> S.typh</span>
<span id="cb198-6"><a href="statistics.html#cb198-6" tabindex="-1"></a></span>
<span id="cb198-7"><a href="statistics.html#cb198-7" tabindex="-1"></a><span class="co"># Inspect the structure of our data</span></span>
<span id="cb198-8"><a href="statistics.html#cb198-8" tabindex="-1"></a><span class="fu">head</span>(typhoid_data)</span></code></pre></div>
<pre><code>##   id set case age sex abroad beef pork veal poultry liverp veg fruit egg plant7
## 1  1   1    1  52   1      0    1    1    1       1      1   0     1   1      1
## 2  2   1    0  52   1      0    1    0    0       0      1   1     1   0      0
## 3  3   1    0  52   1      0    1    1    0       1      1   1     1   1      0
## 4  4   2    1  41   1      0    1   NA   NA      NA      1   1    NA  NA     NA
## 5  5   2    0  41   1      0    1    1    0       0      1   1     0   1      1
## 6  6   2    0  41   1      0    1    1    0       0      1   1     1   1      1</code></pre>
<p><strong>Tip:</strong> You can learn more about any dataset in R by typing <code>?S.typh</code> in your console. This will show you detailed documentation about the variables and study design.</p>
<div id="understanding-the-variables" class="section level4 hasAnchor" number="7.1.2.1">
<h4><span class="header-section-number">7.1.2.1</span> Understanding the Variables<a href="statistics.html#understanding-the-variables" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Our dataset contains the following variables:</p>
<ul>
<li><strong>id</strong>: Person identification number</li>
<li><strong>set</strong>: Matched set indicator (used in the study design)</li>
<li><strong>case</strong>: Case-control status (1 = case/sick person, 0 = control/healthy person)</li>
<li><strong>age</strong>: Age of individual</li>
<li><strong>sex</strong>: Sex of individual (1 = male, 2 = female)</li>
<li><strong>abroad</strong>: Recent travel abroad in the last two weeks (1 = yes, 0 = no)</li>
</ul>
<p>Additionally, we have 9 food exposure variables indicating whether each person consumed specific foods: <code>beef</code>, <code>pork</code>, <code>veal</code>, <code>poultry</code>, <code>liverp</code> (liver pâté), <code>veg</code> (vegetables), <code>fruit</code>, <code>egg</code>, <code>plant7</code>.</p>
</div>
</div>
<div id="data-preparation-creating-a-tidy-dataset" class="section level3 hasAnchor" number="7.1.3">
<h3><span class="header-section-number">7.1.3</span> Data Preparation: Creating a Tidy Dataset<a href="statistics.html#data-preparation-creating-a-tidy-dataset" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Currently, our food exposure data is in “wide” format with separate columns for each food type. For analysis and visualization, we need to convert this to “long” format where each row represents one person-food combination. As you learned in Chapter 5, we can use the <code>pivot_longer()</code> function for this transformation.</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="statistics.html#cb200-1" tabindex="-1"></a><span class="co"># Define our food categories</span></span>
<span id="cb200-2"><a href="statistics.html#cb200-2" tabindex="-1"></a>food_categories <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;beef&#39;</span>, <span class="st">&#39;pork&#39;</span>, <span class="st">&#39;veal&#39;</span>, <span class="st">&#39;poultry&#39;</span>, <span class="st">&#39;liverp&#39;</span>, </span>
<span id="cb200-3"><a href="statistics.html#cb200-3" tabindex="-1"></a>                     <span class="st">&#39;veg&#39;</span>, <span class="st">&#39;fruit&#39;</span>, <span class="st">&#39;egg&#39;</span>, <span class="st">&#39;plant7&#39;</span>)</span>
<span id="cb200-4"><a href="statistics.html#cb200-4" tabindex="-1"></a></span>
<span id="cb200-5"><a href="statistics.html#cb200-5" tabindex="-1"></a><span class="co"># Convert to long format</span></span>
<span id="cb200-6"><a href="statistics.html#cb200-6" tabindex="-1"></a>typhoid_data_long <span class="ot">&lt;-</span> typhoid_data <span class="sc">%&gt;%</span></span>
<span id="cb200-7"><a href="statistics.html#cb200-7" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">all_of</span>(food_categories), </span>
<span id="cb200-8"><a href="statistics.html#cb200-8" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&#39;food&#39;</span>, </span>
<span id="cb200-9"><a href="statistics.html#cb200-9" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&#39;eaten&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb200-10"><a href="statistics.html#cb200-10" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">eaten =</span> eaten,</span>
<span id="cb200-11"><a href="statistics.html#cb200-11" tabindex="-1"></a>         <span class="at">food =</span> <span class="fu">as.factor</span>(food),</span>
<span id="cb200-12"><a href="statistics.html#cb200-12" tabindex="-1"></a>         <span class="at">case =</span> <span class="fu">as.factor</span>(case))</span></code></pre></div>
</div>
<div id="initial-visual-exploration" class="section level3 hasAnchor" number="7.1.4">
<h3><span class="header-section-number">7.1.4</span> Initial Visual Exploration<a href="statistics.html#initial-visual-exploration" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now that we have a long dataframe, we can create visualizations to explore patterns in food consumption among cases. Let’s start by examining the total number of cases that reported eating each food category.</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="statistics.html#cb201-1" tabindex="-1"></a><span class="co"># Calculate total consumption per food category among all participants</span></span>
<span id="cb201-2"><a href="statistics.html#cb201-2" tabindex="-1"></a>typhoid_cases_per_food <span class="ot">&lt;-</span> typhoid_data_long <span class="sc">%&gt;%</span></span>
<span id="cb201-3"><a href="statistics.html#cb201-3" tabindex="-1"></a>  <span class="fu">group_by</span>(food) <span class="sc">%&gt;%</span></span>
<span id="cb201-4"><a href="statistics.html#cb201-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">eaten =</span> <span class="fu">sum</span>(eaten, <span class="at">na.rm =</span> <span class="cn">TRUE</span>))</span>
<span id="cb201-5"><a href="statistics.html#cb201-5" tabindex="-1"></a></span>
<span id="cb201-6"><a href="statistics.html#cb201-6" tabindex="-1"></a><span class="co"># Create bar plot</span></span>
<span id="cb201-7"><a href="statistics.html#cb201-7" tabindex="-1"></a><span class="fu">ggplot</span>(typhoid_cases_per_food) <span class="sc">+</span></span>
<span id="cb201-8"><a href="statistics.html#cb201-8" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> food, <span class="at">y =</span> eaten),</span>
<span id="cb201-9"><a href="statistics.html#cb201-9" tabindex="-1"></a>           <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, </span>
<span id="cb201-10"><a href="statistics.html#cb201-10" tabindex="-1"></a>           <span class="at">fill =</span> <span class="st">&#39;brown3&#39;</span>, </span>
<span id="cb201-11"><a href="statistics.html#cb201-11" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span></span>
<span id="cb201-12"><a href="statistics.html#cb201-12" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb201-13"><a href="statistics.html#cb201-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Food Category&quot;</span>, </span>
<span id="cb201-14"><a href="statistics.html#cb201-14" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Number who ate this food&quot;</span>, </span>
<span id="cb201-15"><a href="statistics.html#cb201-15" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Total food consumption reported in the study&quot;</span>,</span>
<span id="cb201-16"><a href="statistics.html#cb201-16" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;All participants (cases and controls combined)&quot;</span>)</span></code></pre></div>
<p><img src="07-statistics_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>From this initial visualization, we can see that <strong>beef</strong>, <strong>egg</strong>, <strong>fruit</strong>, <strong>liver pâté</strong> (<code>liverp</code>), and <strong>plant7</strong> were consumed by many participants, while <strong>poultry</strong> and <strong>veal</strong> were less commonly consumed.</p>
</div>
<div id="comparing-cases-and-controls" class="section level3 hasAnchor" number="7.1.5">
<h3><span class="header-section-number">7.1.5</span> Comparing Cases and Controls<a href="statistics.html#comparing-cases-and-controls" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>However, the key question in outbreak investigation is not just which foods were commonly eaten, but which foods show a <strong>difference</strong> between cases (sick people) and controls (healthy people). Let’s create a comparison visualization.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="statistics.html#cb202-1" tabindex="-1"></a><span class="co"># Calculate consumption by case status and food</span></span>
<span id="cb202-2"><a href="statistics.html#cb202-2" tabindex="-1"></a>typhoid_category_per_food <span class="ot">&lt;-</span> typhoid_data_long <span class="sc">%&gt;%</span> </span>
<span id="cb202-3"><a href="statistics.html#cb202-3" tabindex="-1"></a>  <span class="fu">group_by</span>(case, food) <span class="sc">%&gt;%</span></span>
<span id="cb202-4"><a href="statistics.html#cb202-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">eaten =</span> <span class="fu">sum</span>(eaten, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">&#39;drop&#39;</span>)</span>
<span id="cb202-5"><a href="statistics.html#cb202-5" tabindex="-1"></a></span>
<span id="cb202-6"><a href="statistics.html#cb202-6" tabindex="-1"></a><span class="co"># Create side-by-side bar plot</span></span>
<span id="cb202-7"><a href="statistics.html#cb202-7" tabindex="-1"></a><span class="fu">ggplot</span>(typhoid_category_per_food) <span class="sc">+</span></span>
<span id="cb202-8"><a href="statistics.html#cb202-8" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">x =</span> food, <span class="at">y =</span> eaten, <span class="at">fill =</span> <span class="fu">factor</span>(case)),</span>
<span id="cb202-9"><a href="statistics.html#cb202-9" tabindex="-1"></a>           <span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, </span>
<span id="cb202-10"><a href="statistics.html#cb202-10" tabindex="-1"></a>           <span class="at">color =</span> <span class="st">&#39;black&#39;</span>,</span>
<span id="cb202-11"><a href="statistics.html#cb202-11" tabindex="-1"></a>           <span class="at">position =</span> <span class="fu">position_dodge</span>()) <span class="sc">+</span></span>
<span id="cb202-12"><a href="statistics.html#cb202-12" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span> <span class="ot">=</span> <span class="st">&quot;grey&quot;</span>, <span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>),</span>
<span id="cb202-13"><a href="statistics.html#cb202-13" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span> <span class="ot">=</span> <span class="st">&quot;Controls&quot;</span>, <span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="st">&quot;Cases&quot;</span>)) <span class="sc">+</span></span>
<span id="cb202-14"><a href="statistics.html#cb202-14" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb202-15"><a href="statistics.html#cb202-15" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb202-16"><a href="statistics.html#cb202-16" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Food Category&quot;</span>, </span>
<span id="cb202-17"><a href="statistics.html#cb202-17" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Number who ate this food&quot;</span>, </span>
<span id="cb202-18"><a href="statistics.html#cb202-18" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb202-19"><a href="statistics.html#cb202-19" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Food consumption by case status&quot;</span>,</span>
<span id="cb202-20"><a href="statistics.html#cb202-20" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Comparing cases (sick) and controls (healthy)&quot;</span>)</span></code></pre></div>
<p><img src="07-statistics_files/figure-html/unnamed-chunk-4-1.png" width="864" /></p>
<p><strong>Question for reflection:</strong> Looking at this figure, what does your initial assessment suggest about the potential source of the outbreak? Which foods show the largest differences between cases and controls?</p>
</div>
<div id="statistical-analysis-attack-rates-and-odds-ratios" class="section level3 hasAnchor" number="7.1.6">
<h3><span class="header-section-number">7.1.6</span> Statistical Analysis: Attack Rates and Odds Ratios<a href="statistics.html#statistical-analysis-attack-rates-and-odds-ratios" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Visual exploration gives us initial insights, but we need statistical measures to quantify the strength of association between food exposures and illness. In outbreak investigations, epidemiologists use several key concepts:</p>
<div id="attack-rate" class="section level4 hasAnchor" number="7.1.6.1">
<h4><span class="header-section-number">7.1.6.1</span> Attack Rate<a href="statistics.html#attack-rate" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The <strong>attack rate</strong> (AR) measures the proportion of people who become ill among those exposed to a particular food. It’s calculated as:</p>
<p><span class="math display">\[\text{Attack Rate} = \frac{\text{Number of cases who ate the food}}{\text{Total number who ate the food}} \times 100\%\]</span></p>
<p>For example, if 30 out of 100 people who ate a particular dish become ill, the attack rate for that food is 30%.</p>
</div>
<div id="odds-ratio" class="section level4 hasAnchor" number="7.1.6.2">
<h4><span class="header-section-number">7.1.6.2</span> Odds Ratio<a href="statistics.html#odds-ratio" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>While attack rates give us the probability of illness within exposed groups, the <strong>odds ratio</strong> (OR) quantifies how much more likely someone is to become ill if exposed to a particular food compared to someone who was not exposed. The OR is defined as:</p>
<p><span class="math display">\[\text{OR} = \frac{\text{Odds of illness when exposed}}{\text{Odds of illness when not exposed}}\]</span></p>
<p><strong>Interpreting odds ratios:</strong>
- <strong>OR ≈ 1</strong>: No association between exposure and illness
- <strong>OR &lt; 1</strong>: Exposure associated with <em>lower</em> odds of illness (protective effect)
- <strong>OR &gt; 1</strong>: Exposure associated with <em>higher</em> odds of illness (risk factor)</p>
<p>For example, an OR of 2.5 means that people exposed to the food have 2.5 times the odds of becoming sick compared to those not exposed.</p>
</div>
<div id="weighted-odds-ratio" class="section level4 hasAnchor" number="7.1.6.3">
<h4><span class="header-section-number">7.1.6.3</span> Weighted Odds Ratio<a href="statistics.html#weighted-odds-ratio" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To account for the practical impact of an exposure, we can compute a <strong>weighted odds ratio</strong> that combines the magnitude of association (OR) with the absolute number of sick individuals who were exposed. This helps identify foods that are both strongly associated with illness <em>and</em> affect a significant portion of cases.</p>
<p><span class="math display">\[\text{Weighted OR} = \text{OR} \times \text{Number of cases exposed}\]</span></p>
</div>
</div>
<div id="calculating-statistics-for-our-data" class="section level3 hasAnchor" number="7.1.7">
<h3><span class="header-section-number">7.1.7</span> Calculating Statistics for Our Data<a href="statistics.html#calculating-statistics-for-our-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s calculate these measures for each food category in our outbreak:</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="statistics.html#cb203-1" tabindex="-1"></a><span class="co"># Convert back to wide format for easier calculation</span></span>
<span id="cb203-2"><a href="statistics.html#cb203-2" tabindex="-1"></a>typhoid_df <span class="ot">&lt;-</span> typhoid_data</span>
<span id="cb203-3"><a href="statistics.html#cb203-3" tabindex="-1"></a></span>
<span id="cb203-4"><a href="statistics.html#cb203-4" tabindex="-1"></a><span class="co"># Gather food columns into long format and calculate 2x2 tables</span></span>
<span id="cb203-5"><a href="statistics.html#cb203-5" tabindex="-1"></a>typhoid_long <span class="ot">&lt;-</span> typhoid_df <span class="sc">%&gt;%</span></span>
<span id="cb203-6"><a href="statistics.html#cb203-6" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> beef<span class="sc">:</span>plant7, <span class="at">names_to =</span> <span class="st">&quot;food&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;ate&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb203-7"><a href="statistics.html#cb203-7" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(ate))</span>
<span id="cb203-8"><a href="statistics.html#cb203-8" tabindex="-1"></a></span>
<span id="cb203-9"><a href="statistics.html#cb203-9" tabindex="-1"></a><span class="co"># Calculate odds ratios for each food</span></span>
<span id="cb203-10"><a href="statistics.html#cb203-10" tabindex="-1"></a>food_analysis <span class="ot">&lt;-</span> typhoid_long <span class="sc">%&gt;%</span></span>
<span id="cb203-11"><a href="statistics.html#cb203-11" tabindex="-1"></a>  <span class="fu">group_by</span>(food) <span class="sc">%&gt;%</span></span>
<span id="cb203-12"><a href="statistics.html#cb203-12" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb203-13"><a href="statistics.html#cb203-13" tabindex="-1"></a>    <span class="co"># 2x2 table cells: A=sick&amp;ate, B=healthy&amp;ate, C=sick&amp;didn&#39;t eat, D=healthy&amp;didn&#39;t eat</span></span>
<span id="cb203-14"><a href="statistics.html#cb203-14" tabindex="-1"></a>    <span class="at">A =</span> <span class="fu">sum</span>(ate <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> case <span class="sc">==</span> <span class="dv">1</span>),   <span class="co"># cases who ate</span></span>
<span id="cb203-15"><a href="statistics.html#cb203-15" tabindex="-1"></a>    <span class="at">B =</span> <span class="fu">sum</span>(ate <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> case <span class="sc">==</span> <span class="dv">0</span>),   <span class="co"># controls who ate  </span></span>
<span id="cb203-16"><a href="statistics.html#cb203-16" tabindex="-1"></a>    <span class="at">C =</span> <span class="fu">sum</span>(ate <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> case <span class="sc">==</span> <span class="dv">1</span>),   <span class="co"># cases who didn&#39;t eat</span></span>
<span id="cb203-17"><a href="statistics.html#cb203-17" tabindex="-1"></a>    <span class="at">D =</span> <span class="fu">sum</span>(ate <span class="sc">==</span> <span class="dv">0</span> <span class="sc">&amp;</span> case <span class="sc">==</span> <span class="dv">0</span>),   <span class="co"># controls who didn&#39;t eat</span></span>
<span id="cb203-18"><a href="statistics.html#cb203-18" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">&#39;drop&#39;</span></span>
<span id="cb203-19"><a href="statistics.html#cb203-19" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb203-20"><a href="statistics.html#cb203-20" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb203-21"><a href="statistics.html#cb203-21" tabindex="-1"></a>    <span class="at">total_ate =</span> A <span class="sc">+</span> B,</span>
<span id="cb203-22"><a href="statistics.html#cb203-22" tabindex="-1"></a>    <span class="at">attack_rate =</span> <span class="fu">round</span>((A <span class="sc">/</span> total_ate) <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>),</span>
<span id="cb203-23"><a href="statistics.html#cb203-23" tabindex="-1"></a>    <span class="at">OR =</span> <span class="fu">round</span>((A <span class="sc">*</span> D) <span class="sc">/</span> (B <span class="sc">*</span> C), <span class="dv">2</span>),</span>
<span id="cb203-24"><a href="statistics.html#cb203-24" tabindex="-1"></a>    <span class="at">weighted_OR =</span> <span class="fu">round</span>(OR <span class="sc">*</span> A, <span class="dv">1</span>)</span>
<span id="cb203-25"><a href="statistics.html#cb203-25" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb203-26"><a href="statistics.html#cb203-26" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(weighted_OR)) <span class="sc">%&gt;%</span></span>
<span id="cb203-27"><a href="statistics.html#cb203-27" tabindex="-1"></a>  <span class="fu">select</span>(food, A, total_ate, attack_rate, OR, weighted_OR)</span>
<span id="cb203-28"><a href="statistics.html#cb203-28" tabindex="-1"></a></span>
<span id="cb203-29"><a href="statistics.html#cb203-29" tabindex="-1"></a><span class="co"># Display results</span></span>
<span id="cb203-30"><a href="statistics.html#cb203-30" tabindex="-1"></a><span class="fu">print</span>(food_analysis)</span></code></pre></div>
<pre><code>## # A tibble: 9 × 6
##   food        A total_ate attack_rate    OR weighted_OR
##   &lt;chr&gt;   &lt;int&gt;     &lt;int&gt;       &lt;dbl&gt; &lt;dbl&gt;       &lt;dbl&gt;
## 1 plant7     29        62        46.8  4.48       130. 
## 2 pork       33        98        33.7  1.46        48.2
## 3 egg        31        98        31.6  1.03        31.9
## 4 veal        5         7        71.4  5.88        29.4
## 5 beef       28        88        31.8  0.84        23.5
## 6 veg        40       122        32.8  0.49        19.6
## 7 poultry    14        41        34.1  1.24        17.4
## 8 fruit      32       113        28.3  0.23         7.4
## 9 liverp     43       130        33.1  0.16         6.9</code></pre>
</div>
<div id="interpretation-of-results" class="section level3 hasAnchor" number="7.1.8">
<h3><span class="header-section-number">7.1.8</span> Interpretation of Results<a href="statistics.html#interpretation-of-results" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Looking at our statistical analysis:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Plant7</strong> shows by far the highest weighted odds ratio, indicating it is both strongly associated with illness (high OR) and affected many cases (high A).</p></li>
<li><p><strong>Attack rates</strong> help us understand the risk level - foods with high attack rates pose greater risk to those who consume them.</p></li>
<li><p><strong>Simple odds ratios</strong> show the strength of association, but may be misleading if very few people were exposed (like veal).</p></li>
<li><p><strong>Weighted odds ratios</strong> provide the most practical measure for outbreak investigation, balancing both statistical association and public health impact.</p></li>
</ol>
</div>
<div id="conclusion-2" class="section level3 hasAnchor" number="7.1.9">
<h3><span class="header-section-number">7.1.9</span> Conclusion<a href="statistics.html#conclusion-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Through this systematic analysis combining data visualization and statistical measures, we identified <strong>plant7</strong> as the most likely source of the Salmonella Typhimurium outbreak. This finding was indeed confirmed in the actual investigation - demonstrating how epidemiological methods can effectively pinpoint outbreak sources and guide public health interventions.</p>
<p><strong>Key learning points:</strong>
- Visual exploration provides initial insights but must be followed by statistical analysis
- Multiple measures (attack rates, odds ratios, weighted odds ratios) provide different perspectives on food-illness associations<br />
- Weighted odds ratios are particularly useful in outbreak investigations as they consider both strength of association and public health impact
- Systematic epidemiological analysis is essential for evidence-based outbreak response</p>
</div>
</div>
<div id="inferential-statistics-in-epidemiology" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Inferential statistics in epidemiology<a href="statistics.html#inferential-statistics-in-epidemiology" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="inferential-statistics-in-epidemiology-1" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Inferential Statistics in Epidemiology<a href="statistics.html#inferential-statistics-in-epidemiology-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>While descriptive statistics and visualizations help us explore patterns in our data, <strong>inferential statistics</strong> allow us to make conclusions about populations based on our sample data and assess whether observed differences are likely due to chance or represent real associations. In epidemiological investigations, we often want to know: “Are the differences we observe between cases and controls statistically significant?”</p>
<div id="understanding-statistical-significance" class="section level3 hasAnchor" number="7.3.1">
<h3><span class="header-section-number">7.3.1</span> Understanding Statistical Significance<a href="statistics.html#understanding-statistical-significance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Before diving into specific tests, let’s establish key concepts:</p>
<ul>
<li><strong>Null hypothesis (H₀)</strong>: Usually states there is no difference or association</li>
<li><strong>Alternative hypothesis (H₁)</strong>: States there is a difference or association<br />
</li>
<li><strong>P-value</strong>: The probability of observing our results (or more extreme) if the null hypothesis were true</li>
<li><strong>Significance level (α)</strong>: The threshold below which we reject the null hypothesis (commonly 0.05)</li>
<li><strong>Confidence interval</strong>: A range of values that likely contains the true population parameter</li>
</ul>
</div>
<div id="comparing-demographics-between-cases-and-controls" class="section level3 hasAnchor" number="7.3.2">
<h3><span class="header-section-number">7.3.2</span> Comparing Demographics Between Cases and Controls<a href="statistics.html#comparing-demographics-between-cases-and-controls" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s start by examining whether there are significant demographic differences between our typhoid cases and controls. This is important because demographic differences might confound our food exposure analysis.</p>
<div id="testing-age-differences-with-t-tests" class="section level4 hasAnchor" number="7.3.2.1">
<h4><span class="header-section-number">7.3.2.1</span> Testing Age Differences with T-Tests<a href="statistics.html#testing-age-differences-with-t-tests" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>A <strong>t-test</strong> compares means between two groups. We’ll use it to test whether cases and controls differ significantly in age.</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="statistics.html#cb205-1" tabindex="-1"></a><span class="co"># First, let&#39;s examine age distributions</span></span>
<span id="cb205-2"><a href="statistics.html#cb205-2" tabindex="-1"></a>typhoid_data <span class="sc">%&gt;%</span></span>
<span id="cb205-3"><a href="statistics.html#cb205-3" tabindex="-1"></a>  <span class="fu">group_by</span>(case) <span class="sc">%&gt;%</span></span>
<span id="cb205-4"><a href="statistics.html#cb205-4" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb205-5"><a href="statistics.html#cb205-5" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb205-6"><a href="statistics.html#cb205-6" tabindex="-1"></a>    <span class="at">mean_age =</span> <span class="fu">round</span>(<span class="fu">mean</span>(age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb205-7"><a href="statistics.html#cb205-7" tabindex="-1"></a>    <span class="at">sd_age =</span> <span class="fu">round</span>(<span class="fu">sd</span>(age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">1</span>),</span>
<span id="cb205-8"><a href="statistics.html#cb205-8" tabindex="-1"></a>    <span class="at">median_age =</span> <span class="fu">median</span>(age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb205-9"><a href="statistics.html#cb205-9" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">&#39;drop&#39;</span></span>
<span id="cb205-10"><a href="statistics.html#cb205-10" tabindex="-1"></a>  )</span></code></pre></div>
<pre><code>## # A tibble: 2 × 5
##    case     n mean_age sd_age median_age
##   &lt;dbl&gt; &lt;int&gt;    &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;
## 1     0    89     25.5   17.6         18
## 2     1    47     24.1   17.7         17</code></pre>
<p>Now let’s visualize the age distributions:</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="statistics.html#cb207-1" tabindex="-1"></a><span class="co"># Create boxplots to compare age distributions</span></span>
<span id="cb207-2"><a href="statistics.html#cb207-2" tabindex="-1"></a><span class="fu">ggplot</span>(typhoid_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">factor</span>(case), <span class="at">y =</span> age, <span class="at">fill =</span> <span class="fu">factor</span>(case))) <span class="sc">+</span></span>
<span id="cb207-3"><a href="statistics.html#cb207-3" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb207-4"><a href="statistics.html#cb207-4" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb207-5"><a href="statistics.html#cb207-5" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span> <span class="ot">=</span> <span class="st">&quot;grey&quot;</span>, <span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>),</span>
<span id="cb207-6"><a href="statistics.html#cb207-6" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span> <span class="ot">=</span> <span class="st">&quot;Controls&quot;</span>, <span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="st">&quot;Cases&quot;</span>)) <span class="sc">+</span></span>
<span id="cb207-7"><a href="statistics.html#cb207-7" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0&quot;</span> <span class="ot">=</span> <span class="st">&quot;Controls&quot;</span>, <span class="st">&quot;1&quot;</span> <span class="ot">=</span> <span class="st">&quot;Cases&quot;</span>)) <span class="sc">+</span></span>
<span id="cb207-8"><a href="statistics.html#cb207-8" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb207-9"><a href="statistics.html#cb207-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Group&quot;</span>, </span>
<span id="cb207-10"><a href="statistics.html#cb207-10" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Age (years)&quot;</span>, </span>
<span id="cb207-11"><a href="statistics.html#cb207-11" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">&quot;Group&quot;</span>,</span>
<span id="cb207-12"><a href="statistics.html#cb207-12" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Age distribution by case status&quot;</span>,</span>
<span id="cb207-13"><a href="statistics.html#cb207-13" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Comparing age between cases and controls&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 19 rows containing non-finite outside the scale range
## (`stat_boxplot()`).</code></pre>
<pre><code>## Warning: Removed 19 rows containing missing values or values outside the scale range
## (`geom_point()`).</code></pre>
<p><img src="07-statistics_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>Now let’s perform the statistical test:</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="statistics.html#cb210-1" tabindex="-1"></a><span class="co"># Perform independent samples t-test</span></span>
<span id="cb210-2"><a href="statistics.html#cb210-2" tabindex="-1"></a>age_test <span class="ot">&lt;-</span> <span class="fu">t.test</span>(age <span class="sc">~</span> case, <span class="at">data =</span> typhoid_data)</span>
<span id="cb210-3"><a href="statistics.html#cb210-3" tabindex="-1"></a><span class="fu">print</span>(age_test)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  age by case
## t = 0.3888, df = 84.615, p-value = 0.6984
## alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
## 95 percent confidence interval:
##  -5.446378  8.093997
## sample estimates:
## mean in group 0 mean in group 1 
##        25.46667        24.14286</code></pre>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="statistics.html#cb212-1" tabindex="-1"></a><span class="co"># Extract key information</span></span>
<span id="cb212-2"><a href="statistics.html#cb212-2" tabindex="-1"></a>age_diff <span class="ot">&lt;-</span> <span class="fu">round</span>(age_test<span class="sc">$</span>estimate[<span class="dv">2</span>] <span class="sc">-</span> age_test<span class="sc">$</span>estimate[<span class="dv">1</span>], <span class="dv">2</span>)</span>
<span id="cb212-3"><a href="statistics.html#cb212-3" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="fu">round</span>(age_test<span class="sc">$</span>p.value, <span class="dv">4</span>)</span>
<span id="cb212-4"><a href="statistics.html#cb212-4" tabindex="-1"></a>ci_lower <span class="ot">&lt;-</span> <span class="fu">round</span>(age_test<span class="sc">$</span>conf.int[<span class="dv">1</span>], <span class="dv">2</span>)</span>
<span id="cb212-5"><a href="statistics.html#cb212-5" tabindex="-1"></a>ci_upper <span class="ot">&lt;-</span> <span class="fu">round</span>(age_test<span class="sc">$</span>conf.int[<span class="dv">2</span>], <span class="dv">2</span>)</span>
<span id="cb212-6"><a href="statistics.html#cb212-6" tabindex="-1"></a></span>
<span id="cb212-7"><a href="statistics.html#cb212-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Mean age difference (cases - controls):&quot;</span>, age_diff, <span class="st">&quot;years</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Mean age difference (cases - controls): -1.32 years</code></pre>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="statistics.html#cb214-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;95% Confidence interval: [&quot;</span>, ci_lower, <span class="st">&quot;,&quot;</span>, ci_upper, <span class="st">&quot;]</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 95% Confidence interval: [ -5.45 , 8.09 ]</code></pre>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="statistics.html#cb216-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;P-value:&quot;</span>, p_value, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## P-value: 0.6984</code></pre>
<p><strong>Interpretation</strong>: If the p-value is &lt; 0.05, we conclude there’s a statistically significant difference in age between cases and controls. The confidence interval tells us the range of plausible values for the true age difference in the population.</p>
</div>
<div id="testing-sex-differences-with-chi-square-tests" class="section level4 hasAnchor" number="7.3.2.2">
<h4><span class="header-section-number">7.3.2.2</span> Testing Sex Differences with Chi-Square Tests<a href="statistics.html#testing-sex-differences-with-chi-square-tests" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For categorical variables like sex, we use <strong>chi-square tests</strong> to test for associations.</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="statistics.html#cb218-1" tabindex="-1"></a><span class="co"># Create a contingency table</span></span>
<span id="cb218-2"><a href="statistics.html#cb218-2" tabindex="-1"></a>sex_table <span class="ot">&lt;-</span> <span class="fu">table</span>(typhoid_data<span class="sc">$</span>case, typhoid_data<span class="sc">$</span>sex)</span>
<span id="cb218-3"><a href="statistics.html#cb218-3" tabindex="-1"></a><span class="fu">print</span>(sex_table)</span></code></pre></div>
<pre><code>##    
##      1  2
##   0 49 40
##   1 25 22</code></pre>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="statistics.html#cb220-1" tabindex="-1"></a><span class="co"># Add row and column labels for clarity</span></span>
<span id="cb220-2"><a href="statistics.html#cb220-2" tabindex="-1"></a><span class="fu">dimnames</span>(sex_table) <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb220-3"><a href="statistics.html#cb220-3" tabindex="-1"></a>  <span class="at">Case_Status =</span> <span class="fu">c</span>(<span class="st">&quot;Controls&quot;</span>, <span class="st">&quot;Cases&quot;</span>),</span>
<span id="cb220-4"><a href="statistics.html#cb220-4" tabindex="-1"></a>  <span class="at">Sex =</span> <span class="fu">c</span>(<span class="st">&quot;Male&quot;</span>, <span class="st">&quot;Female&quot;</span>)</span>
<span id="cb220-5"><a href="statistics.html#cb220-5" tabindex="-1"></a>)</span>
<span id="cb220-6"><a href="statistics.html#cb220-6" tabindex="-1"></a><span class="fu">print</span>(sex_table)</span></code></pre></div>
<pre><code>##            Sex
## Case_Status Male Female
##    Controls   49     40
##    Cases      25     22</code></pre>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="statistics.html#cb222-1" tabindex="-1"></a><span class="co"># Calculate proportions</span></span>
<span id="cb222-2"><a href="statistics.html#cb222-2" tabindex="-1"></a>prop_table <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(sex_table, <span class="at">margin =</span> <span class="dv">1</span>) <span class="co"># Proportions by row</span></span>
<span id="cb222-3"><a href="statistics.html#cb222-3" tabindex="-1"></a><span class="fu">round</span>(prop_table, <span class="dv">3</span>)</span></code></pre></div>
<pre><code>##            Sex
## Case_Status  Male Female
##    Controls 0.551  0.449
##    Cases    0.532  0.468</code></pre>
<p>Now perform the chi-square test:</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="statistics.html#cb224-1" tabindex="-1"></a><span class="co"># Chi-square test for independence</span></span>
<span id="cb224-2"><a href="statistics.html#cb224-2" tabindex="-1"></a>sex_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(sex_table)</span>
<span id="cb224-3"><a href="statistics.html#cb224-3" tabindex="-1"></a><span class="fu">print</span>(sex_test)</span></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test with Yates&#39; continuity correction
## 
## data:  sex_table
## X-squared = 0.00070864, df = 1, p-value = 0.9788</code></pre>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="statistics.html#cb226-1" tabindex="-1"></a><span class="co"># Extract key information</span></span>
<span id="cb226-2"><a href="statistics.html#cb226-2" tabindex="-1"></a>chi_sq <span class="ot">&lt;-</span> <span class="fu">round</span>(sex_test<span class="sc">$</span>statistic, <span class="dv">3</span>)</span>
<span id="cb226-3"><a href="statistics.html#cb226-3" tabindex="-1"></a>p_value_sex <span class="ot">&lt;-</span> <span class="fu">round</span>(sex_test<span class="sc">$</span>p.value, <span class="dv">4</span>)</span>
<span id="cb226-4"><a href="statistics.html#cb226-4" tabindex="-1"></a>df <span class="ot">&lt;-</span> sex_test<span class="sc">$</span>parameter</span>
<span id="cb226-5"><a href="statistics.html#cb226-5" tabindex="-1"></a></span>
<span id="cb226-6"><a href="statistics.html#cb226-6" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Chi-square statistic:&quot;</span>, chi_sq, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Chi-square statistic: 0.001</code></pre>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="statistics.html#cb228-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Degrees of freedom:&quot;</span>, df, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Degrees of freedom: 1</code></pre>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="statistics.html#cb230-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;P-value:&quot;</span>, p_value_sex, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## P-value: 0.9788</code></pre>
<p><strong>Interpretation</strong>: The chi-square test tells us whether the distribution of sex differs significantly between cases and controls. A significant result (p &lt; 0.05) would suggest that sex is associated with case status.</p>
</div>
</div>
<div id="testing-food-exposures-statistical-significance-of-associations" class="section level3 hasAnchor" number="7.3.3">
<h3><span class="header-section-number">7.3.3</span> Testing Food Exposures: Statistical Significance of Associations<a href="statistics.html#testing-food-exposures-statistical-significance-of-associations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now let’s add statistical testing to our food exposure analysis. We’ll test whether each food exposure is significantly associated with illness.</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="statistics.html#cb232-1" tabindex="-1"></a><span class="co"># Function to perform chi-square test for each food</span></span>
<span id="cb232-2"><a href="statistics.html#cb232-2" tabindex="-1"></a>test_food_association <span class="ot">&lt;-</span> <span class="cf">function</span>(food_name) {</span>
<span id="cb232-3"><a href="statistics.html#cb232-3" tabindex="-1"></a>  <span class="co"># Create 2x2 table for this food</span></span>
<span id="cb232-4"><a href="statistics.html#cb232-4" tabindex="-1"></a>  food_col <span class="ot">&lt;-</span> typhoid_data[[food_name]]</span>
<span id="cb232-5"><a href="statistics.html#cb232-5" tabindex="-1"></a>  case_col <span class="ot">&lt;-</span> typhoid_data<span class="sc">$</span>case</span>
<span id="cb232-6"><a href="statistics.html#cb232-6" tabindex="-1"></a>  </span>
<span id="cb232-7"><a href="statistics.html#cb232-7" tabindex="-1"></a>  <span class="co"># Remove missing values</span></span>
<span id="cb232-8"><a href="statistics.html#cb232-8" tabindex="-1"></a>  complete_cases <span class="ot">&lt;-</span> <span class="sc">!</span><span class="fu">is.na</span>(food_col) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(case_col)</span>
<span id="cb232-9"><a href="statistics.html#cb232-9" tabindex="-1"></a>  food_clean <span class="ot">&lt;-</span> food_col[complete_cases]</span>
<span id="cb232-10"><a href="statistics.html#cb232-10" tabindex="-1"></a>  case_clean <span class="ot">&lt;-</span> case_col[complete_cases]</span>
<span id="cb232-11"><a href="statistics.html#cb232-11" tabindex="-1"></a>  </span>
<span id="cb232-12"><a href="statistics.html#cb232-12" tabindex="-1"></a>  <span class="co"># Create contingency table</span></span>
<span id="cb232-13"><a href="statistics.html#cb232-13" tabindex="-1"></a>  food_table <span class="ot">&lt;-</span> <span class="fu">table</span>(case_clean, food_clean)</span>
<span id="cb232-14"><a href="statistics.html#cb232-14" tabindex="-1"></a>  </span>
<span id="cb232-15"><a href="statistics.html#cb232-15" tabindex="-1"></a>  <span class="co"># Perform chi-square test</span></span>
<span id="cb232-16"><a href="statistics.html#cb232-16" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">all</span>(food_table <span class="sc">&gt;=</span> <span class="dv">5</span>)) {  <span class="co"># Check if chi-square assumptions are met</span></span>
<span id="cb232-17"><a href="statistics.html#cb232-17" tabindex="-1"></a>    test_result <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(food_table)</span>
<span id="cb232-18"><a href="statistics.html#cb232-18" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb232-19"><a href="statistics.html#cb232-19" tabindex="-1"></a>      <span class="at">food =</span> food_name,</span>
<span id="cb232-20"><a href="statistics.html#cb232-20" tabindex="-1"></a>      <span class="at">chi_sq =</span> <span class="fu">round</span>(test_result<span class="sc">$</span>statistic, <span class="dv">3</span>),</span>
<span id="cb232-21"><a href="statistics.html#cb232-21" tabindex="-1"></a>      <span class="at">p_value =</span> <span class="fu">round</span>(test_result<span class="sc">$</span>p.value, <span class="dv">4</span>),</span>
<span id="cb232-22"><a href="statistics.html#cb232-22" tabindex="-1"></a>      <span class="at">test_type =</span> <span class="st">&quot;chi-square&quot;</span></span>
<span id="cb232-23"><a href="statistics.html#cb232-23" tabindex="-1"></a>    ))</span>
<span id="cb232-24"><a href="statistics.html#cb232-24" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb232-25"><a href="statistics.html#cb232-25" tabindex="-1"></a>    <span class="co"># Use Fisher&#39;s exact test for small cell counts</span></span>
<span id="cb232-26"><a href="statistics.html#cb232-26" tabindex="-1"></a>    test_result <span class="ot">&lt;-</span> <span class="fu">fisher.test</span>(food_table)</span>
<span id="cb232-27"><a href="statistics.html#cb232-27" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">list</span>(</span>
<span id="cb232-28"><a href="statistics.html#cb232-28" tabindex="-1"></a>      <span class="at">food =</span> food_name,</span>
<span id="cb232-29"><a href="statistics.html#cb232-29" tabindex="-1"></a>      <span class="at">p_value =</span> <span class="fu">round</span>(test_result<span class="sc">$</span>p.value, <span class="dv">4</span>),</span>
<span id="cb232-30"><a href="statistics.html#cb232-30" tabindex="-1"></a>      <span class="at">test_type =</span> <span class="st">&quot;Fisher&#39;s exact&quot;</span></span>
<span id="cb232-31"><a href="statistics.html#cb232-31" tabindex="-1"></a>    ))</span>
<span id="cb232-32"><a href="statistics.html#cb232-32" tabindex="-1"></a>  }</span>
<span id="cb232-33"><a href="statistics.html#cb232-33" tabindex="-1"></a>}</span>
<span id="cb232-34"><a href="statistics.html#cb232-34" tabindex="-1"></a></span>
<span id="cb232-35"><a href="statistics.html#cb232-35" tabindex="-1"></a><span class="co"># Apply to all food variables</span></span>
<span id="cb232-36"><a href="statistics.html#cb232-36" tabindex="-1"></a>food_categories <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;beef&#39;</span>, <span class="st">&#39;pork&#39;</span>, <span class="st">&#39;veal&#39;</span>, <span class="st">&#39;poultry&#39;</span>, <span class="st">&#39;liverp&#39;</span>, </span>
<span id="cb232-37"><a href="statistics.html#cb232-37" tabindex="-1"></a>                     <span class="st">&#39;veg&#39;</span>, <span class="st">&#39;fruit&#39;</span>, <span class="st">&#39;egg&#39;</span>, <span class="st">&#39;plant7&#39;</span>)</span>
<span id="cb232-38"><a href="statistics.html#cb232-38" tabindex="-1"></a></span>
<span id="cb232-39"><a href="statistics.html#cb232-39" tabindex="-1"></a>food_tests <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(food_categories, test_food_association)</span></code></pre></div>
<pre><code>## Warning in chisq.test(food_table): Chi-squared approximation may be incorrect</code></pre>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="statistics.html#cb234-1" tabindex="-1"></a><span class="fu">print</span>(food_tests)</span></code></pre></div>
<pre><code>## # A tibble: 9 × 4
##   food    chi_sq p_value test_type     
##   &lt;chr&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;         
## 1 beef     0.059  0.809  chi-square    
## 2 pork     0.358  0.549  chi-square    
## 3 veal    NA      0.0343 Fisher&#39;s exact
## 4 poultry  0.103  0.748  chi-square    
## 5 liverp  NA      0.117  Fisher&#39;s exact
## 6 veg      0.573  0.449  chi-square    
## 7 fruit    7.38   0.0066 chi-square    
## 8 egg      0      1      chi-square    
## 9 plant7  11.7    0.0006 chi-square</code></pre>
</div>
<div id="confidence-intervals-for-odds-ratios" class="section level3 hasAnchor" number="7.3.4">
<h3><span class="header-section-number">7.3.4</span> Confidence Intervals for Odds Ratios<a href="statistics.html#confidence-intervals-for-odds-ratios" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s enhance our previous odds ratio analysis by adding confidence intervals and p-values:</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="statistics.html#cb236-1" tabindex="-1"></a><span class="co"># Enhanced function to calculate OR with confidence intervals</span></span>
<span id="cb236-2"><a href="statistics.html#cb236-2" tabindex="-1"></a>calculate_or_with_ci <span class="ot">&lt;-</span> <span class="cf">function</span>(food_name) {</span>
<span id="cb236-3"><a href="statistics.html#cb236-3" tabindex="-1"></a>  <span class="co"># Create 2x2 table</span></span>
<span id="cb236-4"><a href="statistics.html#cb236-4" tabindex="-1"></a>  food_col <span class="ot">&lt;-</span> typhoid_data[[food_name]]</span>
<span id="cb236-5"><a href="statistics.html#cb236-5" tabindex="-1"></a>  case_col <span class="ot">&lt;-</span> typhoid_data<span class="sc">$</span>case</span>
<span id="cb236-6"><a href="statistics.html#cb236-6" tabindex="-1"></a>  </span>
<span id="cb236-7"><a href="statistics.html#cb236-7" tabindex="-1"></a>  <span class="co"># Remove missing values</span></span>
<span id="cb236-8"><a href="statistics.html#cb236-8" tabindex="-1"></a>  complete_cases <span class="ot">&lt;-</span> <span class="sc">!</span><span class="fu">is.na</span>(food_col) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(case_col)</span>
<span id="cb236-9"><a href="statistics.html#cb236-9" tabindex="-1"></a>  food_clean <span class="ot">&lt;-</span> food_col[complete_cases]</span>
<span id="cb236-10"><a href="statistics.html#cb236-10" tabindex="-1"></a>  case_clean <span class="ot">&lt;-</span> case_col[complete_cases]</span>
<span id="cb236-11"><a href="statistics.html#cb236-11" tabindex="-1"></a>  </span>
<span id="cb236-12"><a href="statistics.html#cb236-12" tabindex="-1"></a>  <span class="co"># Create table: rows = case status, columns = food exposure</span></span>
<span id="cb236-13"><a href="statistics.html#cb236-13" tabindex="-1"></a>  tab <span class="ot">&lt;-</span> <span class="fu">table</span>(case_clean, food_clean)</span>
<span id="cb236-14"><a href="statistics.html#cb236-14" tabindex="-1"></a>  </span>
<span id="cb236-15"><a href="statistics.html#cb236-15" tabindex="-1"></a>  <span class="co"># Extract 2x2 table values</span></span>
<span id="cb236-16"><a href="statistics.html#cb236-16" tabindex="-1"></a>  a <span class="ot">&lt;-</span> tab[<span class="dv">2</span>,<span class="dv">2</span>]  <span class="co"># cases exposed</span></span>
<span id="cb236-17"><a href="statistics.html#cb236-17" tabindex="-1"></a>  b <span class="ot">&lt;-</span> tab[<span class="dv">1</span>,<span class="dv">2</span>]  <span class="co"># controls exposed  </span></span>
<span id="cb236-18"><a href="statistics.html#cb236-18" tabindex="-1"></a>  c <span class="ot">&lt;-</span> tab[<span class="dv">2</span>,<span class="dv">1</span>]  <span class="co"># cases not exposed</span></span>
<span id="cb236-19"><a href="statistics.html#cb236-19" tabindex="-1"></a>  d <span class="ot">&lt;-</span> tab[<span class="dv">1</span>,<span class="dv">1</span>]  <span class="co"># controls not exposed</span></span>
<span id="cb236-20"><a href="statistics.html#cb236-20" tabindex="-1"></a>  </span>
<span id="cb236-21"><a href="statistics.html#cb236-21" tabindex="-1"></a>  <span class="co"># Calculate OR</span></span>
<span id="cb236-22"><a href="statistics.html#cb236-22" tabindex="-1"></a>  or <span class="ot">&lt;-</span> (a <span class="sc">*</span> d) <span class="sc">/</span> (b <span class="sc">*</span> c)</span>
<span id="cb236-23"><a href="statistics.html#cb236-23" tabindex="-1"></a>  </span>
<span id="cb236-24"><a href="statistics.html#cb236-24" tabindex="-1"></a>  <span class="co"># Calculate 95% CI for OR using log transformation</span></span>
<span id="cb236-25"><a href="statistics.html#cb236-25" tabindex="-1"></a>  log_or <span class="ot">&lt;-</span> <span class="fu">log</span>(or)</span>
<span id="cb236-26"><a href="statistics.html#cb236-26" tabindex="-1"></a>  se_log_or <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">/</span>a <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>b <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>c <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>d)</span>
<span id="cb236-27"><a href="statistics.html#cb236-27" tabindex="-1"></a>  </span>
<span id="cb236-28"><a href="statistics.html#cb236-28" tabindex="-1"></a>  ci_lower <span class="ot">&lt;-</span> <span class="fu">exp</span>(log_or <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> se_log_or)</span>
<span id="cb236-29"><a href="statistics.html#cb236-29" tabindex="-1"></a>  ci_upper <span class="ot">&lt;-</span> <span class="fu">exp</span>(log_or <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> se_log_or)</span>
<span id="cb236-30"><a href="statistics.html#cb236-30" tabindex="-1"></a>  </span>
<span id="cb236-31"><a href="statistics.html#cb236-31" tabindex="-1"></a>  <span class="co"># Chi-square test</span></span>
<span id="cb236-32"><a href="statistics.html#cb236-32" tabindex="-1"></a>  chi_test <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(tab)</span>
<span id="cb236-33"><a href="statistics.html#cb236-33" tabindex="-1"></a>  </span>
<span id="cb236-34"><a href="statistics.html#cb236-34" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(</span>
<span id="cb236-35"><a href="statistics.html#cb236-35" tabindex="-1"></a>    <span class="at">food =</span> food_name,</span>
<span id="cb236-36"><a href="statistics.html#cb236-36" tabindex="-1"></a>    <span class="at">cases_exposed =</span> a,</span>
<span id="cb236-37"><a href="statistics.html#cb236-37" tabindex="-1"></a>    <span class="at">cases_total =</span> a <span class="sc">+</span> c,</span>
<span id="cb236-38"><a href="statistics.html#cb236-38" tabindex="-1"></a>    <span class="at">OR =</span> <span class="fu">round</span>(or, <span class="dv">2</span>),</span>
<span id="cb236-39"><a href="statistics.html#cb236-39" tabindex="-1"></a>    <span class="at">CI_lower =</span> <span class="fu">round</span>(ci_lower, <span class="dv">2</span>),</span>
<span id="cb236-40"><a href="statistics.html#cb236-40" tabindex="-1"></a>    <span class="at">CI_upper =</span> <span class="fu">round</span>(ci_upper, <span class="dv">2</span>),</span>
<span id="cb236-41"><a href="statistics.html#cb236-41" tabindex="-1"></a>    <span class="at">p_value =</span> <span class="fu">round</span>(chi_test<span class="sc">$</span>p.value, <span class="dv">4</span>),</span>
<span id="cb236-42"><a href="statistics.html#cb236-42" tabindex="-1"></a>    <span class="at">significant =</span> chi_test<span class="sc">$</span>p.value <span class="sc">&lt;</span> <span class="fl">0.05</span></span>
<span id="cb236-43"><a href="statistics.html#cb236-43" tabindex="-1"></a>  ))</span>
<span id="cb236-44"><a href="statistics.html#cb236-44" tabindex="-1"></a>}</span>
<span id="cb236-45"><a href="statistics.html#cb236-45" tabindex="-1"></a></span>
<span id="cb236-46"><a href="statistics.html#cb236-46" tabindex="-1"></a><span class="co"># Calculate for all foods</span></span>
<span id="cb236-47"><a href="statistics.html#cb236-47" tabindex="-1"></a>or_results <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(food_categories, calculate_or_with_ci)</span></code></pre></div>
<pre><code>## Warning in chisq.test(tab): Chi-squared approximation may be incorrect
## Warning in chisq.test(tab): Chi-squared approximation may be incorrect
## Warning in chisq.test(tab): Chi-squared approximation may be incorrect</code></pre>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="statistics.html#cb238-1" tabindex="-1"></a><span class="co"># Sort by OR and display</span></span>
<span id="cb238-2"><a href="statistics.html#cb238-2" tabindex="-1"></a>or_results_sorted <span class="ot">&lt;-</span> or_results <span class="sc">%&gt;%</span></span>
<span id="cb238-3"><a href="statistics.html#cb238-3" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(OR)) <span class="sc">%&gt;%</span></span>
<span id="cb238-4"><a href="statistics.html#cb238-4" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb238-5"><a href="statistics.html#cb238-5" tabindex="-1"></a>    <span class="at">CI_text =</span> <span class="fu">paste0</span>(<span class="st">&quot;[&quot;</span>, CI_lower, <span class="st">&quot;, &quot;</span>, CI_upper, <span class="st">&quot;]&quot;</span>),</span>
<span id="cb238-6"><a href="statistics.html#cb238-6" tabindex="-1"></a>    <span class="at">significance =</span> <span class="fu">ifelse</span>(significant, <span class="st">&quot;Yes&quot;</span>, <span class="st">&quot;No&quot;</span>)</span>
<span id="cb238-7"><a href="statistics.html#cb238-7" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb238-8"><a href="statistics.html#cb238-8" tabindex="-1"></a>  <span class="fu">select</span>(food, cases_exposed, cases_total, OR, CI_text, p_value, significance)</span>
<span id="cb238-9"><a href="statistics.html#cb238-9" tabindex="-1"></a></span>
<span id="cb238-10"><a href="statistics.html#cb238-10" tabindex="-1"></a><span class="fu">print</span>(or_results_sorted)</span></code></pre></div>
<pre><code>##      food cases_exposed cases_total   OR       CI_text p_value significance
## 1    veal             5          42 5.88 [1.09, 31.68]  0.0604           No
## 2  plant7            29          39 4.48  [1.93, 10.4]  0.0006          Yes
## 3    pork            33          41 1.46  [0.59, 3.62]  0.5494           No
## 4 poultry            14          40 1.24  [0.56, 2.73]  0.7477           No
## 5     egg            31          40 1.03  [0.42, 2.52]  1.0000           No
## 6    beef            28          43 0.84  [0.39, 1.82]  0.8086           No
## 7     veg            40          45 0.49  [0.13, 1.78]  0.4490           No
## 8   fruit            32          44 0.23  [0.08, 0.64]  0.0066          Yes
## 9  liverp            43          46 0.16  [0.02, 1.63]  0.2283           No</code></pre>
</div>
<div id="interpreting-the-results" class="section level3 hasAnchor" number="7.3.5">
<h3><span class="header-section-number">7.3.5</span> Interpreting the Results<a href="statistics.html#interpreting-the-results" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s create a visualization of our odds ratios with confidence intervals:</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="statistics.html#cb240-1" tabindex="-1"></a><span class="co"># Create forest plot of odds ratios</span></span>
<span id="cb240-2"><a href="statistics.html#cb240-2" tabindex="-1"></a>or_results <span class="sc">%&gt;%</span></span>
<span id="cb240-3"><a href="statistics.html#cb240-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">food =</span> <span class="fu">reorder</span>(food, OR)) <span class="sc">%&gt;%</span></span>
<span id="cb240-4"><a href="statistics.html#cb240-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> food, <span class="at">y =</span> OR)) <span class="sc">+</span></span>
<span id="cb240-5"><a href="statistics.html#cb240-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> significant), <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb240-6"><a href="statistics.html#cb240-6" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> CI_lower, <span class="at">ymax =</span> CI_upper, <span class="at">color =</span> significant), </span>
<span id="cb240-7"><a href="statistics.html#cb240-7" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb240-8"><a href="statistics.html#cb240-8" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">1</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb240-9"><a href="statistics.html#cb240-9" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;TRUE&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>, <span class="st">&quot;FALSE&quot;</span> <span class="ot">=</span> <span class="st">&quot;grey&quot;</span>),</span>
<span id="cb240-10"><a href="statistics.html#cb240-10" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;TRUE&quot;</span> <span class="ot">=</span> <span class="st">&quot;Significant&quot;</span>, <span class="st">&quot;FALSE&quot;</span> <span class="ot">=</span> <span class="st">&quot;Not significant&quot;</span>)) <span class="sc">+</span></span>
<span id="cb240-11"><a href="statistics.html#cb240-11" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span>  <span class="co"># Log scale for better visualization</span></span>
<span id="cb240-12"><a href="statistics.html#cb240-12" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb240-13"><a href="statistics.html#cb240-13" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb240-14"><a href="statistics.html#cb240-14" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb240-15"><a href="statistics.html#cb240-15" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Food Category&quot;</span>,</span>
<span id="cb240-16"><a href="statistics.html#cb240-16" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Odds Ratio (log scale)&quot;</span>,</span>
<span id="cb240-17"><a href="statistics.html#cb240-17" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Statistically</span><span class="sc">\n</span><span class="st">Significant&quot;</span>,</span>
<span id="cb240-18"><a href="statistics.html#cb240-18" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Odds Ratios for Food Exposures with 95% Confidence Intervals&quot;</span>,</span>
<span id="cb240-19"><a href="statistics.html#cb240-19" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Dashed line represents OR = 1 (no association)&quot;</span></span>
<span id="cb240-20"><a href="statistics.html#cb240-20" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb240-21"><a href="statistics.html#cb240-21" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
## ℹ Please use `linewidth` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<p><img src="07-statistics_files/figure-html/unnamed-chunk-13-1.png" width="960" /></p>
</div>
<div id="key-statistical-concepts-for-interpretation" class="section level3 hasAnchor" number="7.3.6">
<h3><span class="header-section-number">7.3.6</span> Key Statistical Concepts for Interpretation<a href="statistics.html#key-statistical-concepts-for-interpretation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Odds Ratio Confidence Intervals:</strong>
- If the 95% CI includes 1.0, the association is not statistically significant
- If the entire CI is above 1.0, the food is a significant risk factor
- If the entire CI is below 1.0, the food is significantly protective</p>
<p><strong>P-values in Context:</strong>
- P &lt; 0.05: Evidence against the null hypothesis of no association
- P ≥ 0.05: Insufficient evidence to reject the null hypothesis
- <strong>Important</strong>: “Not significant” doesn’t mean “no effect” - it means insufficient evidence</p>
<p><strong>Multiple Testing Considerations:</strong>
When testing multiple food exposures, we increase the chance of finding significant results by chance alone. In practice, epidemiologists might adjust for multiple comparisons or focus on the strongest associations with biological plausibility.</p>
</div>
<div id="summary" class="section level3 hasAnchor" number="7.3.7">
<h3><span class="header-section-number">7.3.7</span> Summary<a href="statistics.html#summary" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Through inferential statistics, we’ve:</p>
<ol style="list-style-type: decimal">
<li><strong>Tested demographic differences</strong>: Determined whether cases and controls are comparable in age and sex distribution</li>
<li><strong>Quantified food associations</strong>: Calculated odds ratios with confidence intervals for each food exposure</li>
<li><strong>Assessed statistical significance</strong>: Used p-values to evaluate the evidence for each association</li>
<li><strong>Visualized uncertainty</strong>: Created forest plots showing both point estimates and confidence intervals</li>
</ol>
<p>This statistical framework provides the foundation for making evidence-based conclusions in epidemiological investigations. The combination of effect size measures (like odds ratios), confidence intervals, and statistical significance tests gives us a comprehensive picture of associations in our data.</p>
<p><strong>Key takeaway</strong>: Statistical significance testing helps us distinguish between associations that are likely real versus those that might be due to random variation, but it should always be interpreted alongside biological plausibility and public health importance.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-visualization-in-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="working-with-epidemiological-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/stends2001/EpiBible/blob/main07-statistics.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["EpiBible.pdf", "EpiBible.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
