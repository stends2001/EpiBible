<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Modelling | Epibible</title>
  <meta name="description" content="Chapter 6 Modelling | Epibible" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Modelling | Epibible" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Modelling | Epibible" />
  
  
  

<meta name="author" content="Sten de Schrijver" />


<meta name="date" content="2025-08-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="working-with-epidemiological-data.html"/>
<link rel="next" href="communication-and-sharing-of-code-and-data.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Epibible</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="about-the-author.html"><a href="about-the-author.html"><i class="fa fa-check"></i>About the Author</a></li>
<li class="chapter" data-level="1" data-path="introduction-to-epidemiology.html"><a href="introduction-to-epidemiology.html"><i class="fa fa-check"></i><b>1</b> Introduction to Epidemiology</a></li>
<li class="chapter" data-level="2" data-path="chapter-2-getting-started-with-r.html"><a href="chapter-2-getting-started-with-r.html"><i class="fa fa-check"></i><b>2</b> Chapter 2 Getting Started with R</a>
<ul>
<li class="chapter" data-level="2.1" data-path="chapter-2-getting-started-with-r.html"><a href="chapter-2-getting-started-with-r.html#installing-r-and-rstudio"><i class="fa fa-check"></i><b>2.1</b> Installing R and Rstudio</a></li>
<li class="chapter" data-level="2.2" data-path="chapter-2-getting-started-with-r.html"><a href="chapter-2-getting-started-with-r.html#starting-to-code"><i class="fa fa-check"></i><b>2.2</b> Starting to code</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="r-fundamentals.html"><a href="r-fundamentals.html"><i class="fa fa-check"></i><b>3</b> R fundamentals</a>
<ul>
<li class="chapter" data-level="3.1" data-path="r-fundamentals.html"><a href="r-fundamentals.html#r-syntax"><i class="fa fa-check"></i><b>3.1</b> R syntax</a></li>
<li class="chapter" data-level="3.2" data-path="r-fundamentals.html"><a href="r-fundamentals.html#troubleshooting"><i class="fa fa-check"></i><b>3.2</b> Troubleshooting</a></li>
<li class="chapter" data-level="3.3" data-path="r-fundamentals.html"><a href="r-fundamentals.html#data-structures"><i class="fa fa-check"></i><b>3.3</b> Data structures</a></li>
<li class="chapter" data-level="3.4" data-path="r-fundamentals.html"><a href="r-fundamentals.html#writing-scripts"><i class="fa fa-check"></i><b>3.4</b> writing scripts</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tidyverse.html"><a href="tidyverse.html"><i class="fa fa-check"></i><b>4</b> Tidyverse</a>
<ul>
<li class="chapter" data-level="4.1" data-path="tidyverse.html"><a href="tidyverse.html#data-wrangling-using-dplyr"><i class="fa fa-check"></i><b>4.1</b> Data wrangling using dplyr</a></li>
<li class="chapter" data-level="4.2" data-path="tidyverse.html"><a href="tidyverse.html#data-visualization-using-ggplot"><i class="fa fa-check"></i><b>4.2</b> Data visualization using ggplot</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="working-with-epidemiological-data.html"><a href="working-with-epidemiological-data.html"><i class="fa fa-check"></i><b>5</b> Working with epidemiological data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="working-with-epidemiological-data.html"><a href="working-with-epidemiological-data.html#acessing-data"><i class="fa fa-check"></i><b>5.1</b> Acessing data</a></li>
<li class="chapter" data-level="5.2" data-path="working-with-epidemiological-data.html"><a href="working-with-epidemiological-data.html#imperfect-epidemiological-data"><i class="fa fa-check"></i><b>5.2</b> (Imperfect) epidemiological data</a></li>
<li class="chapter" data-level="5.3" data-path="working-with-epidemiological-data.html"><a href="working-with-epidemiological-data.html#case-study-1-yellow-fever"><i class="fa fa-check"></i><b>5.3</b> Case Study 1: Yellow Fever</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="modelling.html"><a href="modelling.html"><i class="fa fa-check"></i><b>6</b> Modelling</a>
<ul>
<li class="chapter" data-level="6.1" data-path="modelling.html"><a href="modelling.html#compartmental-models"><i class="fa fa-check"></i><b>6.1</b> Compartmental models</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="modelling.html"><a href="modelling.html#sir-model-in-theory"><i class="fa fa-check"></i><b>6.1.1</b> SIR model in theory</a></li>
<li class="chapter" data-level="6.1.2" data-path="modelling.html"><a href="modelling.html#sir-model-in-r"><i class="fa fa-check"></i><b>6.1.2</b> SIR model in R</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="modelling.html"><a href="modelling.html#time-series---forecasting"><i class="fa fa-check"></i><b>6.2</b> Time series - Forecasting</a></li>
<li class="chapter" data-level="6.3" data-path="modelling.html"><a href="modelling.html#using-and-applying-models"><i class="fa fa-check"></i><b>6.3</b> Using and applying models</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="communication-and-sharing-of-code-and-data.html"><a href="communication-and-sharing-of-code-and-data.html"><i class="fa fa-check"></i><b>7</b> Communication and sharing of code and data</a>
<ul>
<li class="chapter" data-level="7.1" data-path="communication-and-sharing-of-code-and-data.html"><a href="communication-and-sharing-of-code-and-data.html#writing-code-best-practices"><i class="fa fa-check"></i><b>7.1</b> Writing code: best practices</a></li>
<li class="chapter" data-level="7.2" data-path="communication-and-sharing-of-code-and-data.html"><a href="communication-and-sharing-of-code-and-data.html#github"><i class="fa fa-check"></i><b>7.2</b> Github</a></li>
<li class="chapter" data-level="7.3" data-path="communication-and-sharing-of-code-and-data.html"><a href="communication-and-sharing-of-code-and-data.html#reports-using-markdown"><i class="fa fa-check"></i><b>7.3</b> Reports using Markdown</a></li>
<li class="chapter" data-level="7.4" data-path="communication-and-sharing-of-code-and-data.html"><a href="communication-and-sharing-of-code-and-data.html#open-science"><i class="fa fa-check"></i><b>7.4</b> Open science</a></li>
<li class="chapter" data-level="7.5" data-path="communication-and-sharing-of-code-and-data.html"><a href="communication-and-sharing-of-code-and-data.html#communities-and-forums"><i class="fa fa-check"></i><b>7.5</b> Communities and forums</a></li>
<li class="chapter" data-level="7.6" data-path="communication-and-sharing-of-code-and-data.html"><a href="communication-and-sharing-of-code-and-data.html#how-to-use-chat-gpt"><i class="fa fa-check"></i><b>7.6</b> How to use Chat-GPT</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="recommended-reading.html"><a href="recommended-reading.html"><i class="fa fa-check"></i><b>8</b> Recommended Reading</a>
<ul>
<li class="chapter" data-level="8.1" data-path="recommended-reading.html"><a href="recommended-reading.html#recommended-textbooks-and-courses"><i class="fa fa-check"></i><b>8.1</b> Recommended textbooks and courses</a></li>
<li class="chapter" data-level="8.2" data-path="recommended-reading.html"><a href="recommended-reading.html#datasources"><i class="fa fa-check"></i><b>8.2</b> Datasources</a></li>
<li class="chapter" data-level="8.3" data-path="recommended-reading.html"><a href="recommended-reading.html#useful-packages"><i class="fa fa-check"></i><b>8.3</b> Useful packages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Epibible</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="modelling" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> Modelling<a href="modelling.html#modelling" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="compartmental-models" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Compartmental models<a href="modelling.html#compartmental-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="sir-model-in-theory" class="section level3 hasAnchor" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> SIR model in theory<a href="modelling.html#sir-model-in-theory" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Compartmental models divide a population into distinct groups, or <em>compartments</em>, each governed by specific rules that describe how individuals move between compartments over time. In epidemiology, one of the most common models is the <strong>SIR model</strong>, which divides the population into three compartments:</p>
<ul>
<li><strong>Susceptible (S)</strong>: individuals who can contract the disease<br />
</li>
<li><strong>Infectious (I)</strong>: individuals who are currently infected and can transmit the disease<br />
</li>
<li><strong>Recovered (R)</strong>: individuals who have recovered and are no longer infectious</li>
</ul>
<p>Individuals move from <strong>S</strong> to <strong>I</strong> (when infected), and from <strong>I</strong> to <strong>R</strong> (when they recover). This progression can be described using either discrete-time or continuous-time equations.</p>
<div id="discrete-time-formulation" class="section level4 hasAnchor" number="6.1.1.1">
<h4><span class="header-section-number">6.1.1.1</span> Discrete-Time Formulation<a href="modelling.html#discrete-time-formulation" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The discrete-time version of the SIR model is expressed as:</p>
<p><span class="math display">\[
\begin{aligned}
S_{t+1} &amp;= S_t - \beta S_t I_t \\
I_{t+1} &amp;= I_t + \beta S_t I_t - \gamma I_t \\
R_{t+1} &amp;= R_t + \gamma I_t
\end{aligned}
\]</span></p>
<p>Here, <span class="math inline">\(S_{t+1}\)</span> is the number of susceptible individuals at the next time step, determined by subtracting those who become infected. <span class="math inline">\(I_{t+1}\)</span> increases with new infections and decreases as people recover. <span class="math inline">\(R_{t+1}\)</span> increases with recoveries.</p>
</div>
<div id="continuous-time-formulation-odes" class="section level4 hasAnchor" number="6.1.1.2">
<h4><span class="header-section-number">6.1.1.2</span> Continuous-Time Formulation (ODEs)<a href="modelling.html#continuous-time-formulation-odes" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For more refined, continuous-time modeling, we use ordinary differential equations:</p>
<p><span class="math display">\[
\begin{aligned}
\frac{dS}{dt} &amp;= -\beta S I \\
\frac{dI}{dt} &amp;= \beta S I - \gamma I \\
\frac{dR}{dt} &amp;= \gamma I
\end{aligned}
\]</span></p>
<p>These represent the rate of change of each compartment over time.</p>
<p>Where:
- <span class="math inline">\(\beta\)</span> is the <strong>transmission rate</strong>
- <span class="math inline">\(\gamma\)</span> is the <strong>recovery rate</strong>
- <span class="math inline">\(N = S + I + R\)</span> is the <strong>total population</strong></p>
</div>
</div>
<div id="sir-model-in-r" class="section level3 hasAnchor" number="6.1.2">
<h3><span class="header-section-number">6.1.2</span> SIR model in R<a href="modelling.html#sir-model-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Despite its simplicity, the SIR model can be surprisingly effective. During the COVID-19 pandemic, many government advisors based their projections on variations of this basic framework.</p>
<p>As an example, consider an influenza outbreak that occurred in 1978 at a boarding school in England. The on-site physician documented how many students were sick (in bed) and how many were recovering (convalescent) each day. This dataset is included in the <code>outbreaks</code> R package, allowing us to study it directly.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="modelling.html#cb30-1" tabindex="-1"></a><span class="fu">library</span>(outbreaks)</span>
<span id="cb30-2"><a href="modelling.html#cb30-2" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;influenza_england_1978_school&quot;</span>)</span>
<span id="cb30-3"><a href="modelling.html#cb30-3" tabindex="-1"></a>outbreak_data <span class="ot">&lt;-</span> influenza_england_1978_school</span>
<span id="cb30-4"><a href="modelling.html#cb30-4" tabindex="-1"></a><span class="fu">head</span>(outbreak_data)</span></code></pre></div>
<pre><code>##         date in_bed convalescent
## 1 1978-01-22      3            0
## 2 1978-01-23      8            0
## 3 1978-01-24     26            0
## 4 1978-01-25     76            0
## 5 1978-01-26    225            9
## 6 1978-01-27    298           17</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="modelling.html#cb32-1" tabindex="-1"></a>outbreak_data_long <span class="ot">&lt;-</span> <span class="fu">pivot_longer</span>(outbreak_data, </span>
<span id="cb32-2"><a href="modelling.html#cb32-2" tabindex="-1"></a>                                   <span class="at">cols =</span> <span class="fu">c</span>(in_bed, convalescent),</span>
<span id="cb32-3"><a href="modelling.html#cb32-3" tabindex="-1"></a>                                   <span class="at">names_to =</span> <span class="st">&quot;group&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;count&quot;</span>)</span>
<span id="cb32-4"><a href="modelling.html#cb32-4" tabindex="-1"></a></span>
<span id="cb32-5"><a href="modelling.html#cb32-5" tabindex="-1"></a><span class="fu">ggplot</span>(outbreak_data_long, <span class="fu">aes</span>(<span class="at">x =</span> date, <span class="at">y =</span> count, <span class="at">color =</span> group)) <span class="sc">+</span></span>
<span id="cb32-6"><a href="modelling.html#cb32-6" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb32-7"><a href="modelling.html#cb32-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb32-8"><a href="modelling.html#cb32-8" tabindex="-1"></a>  <span class="fu">scale_x_date</span>(<span class="at">breaks =</span> outbreak_data_long<span class="sc">$</span>date, <span class="at">date_labels =</span> <span class="st">&quot;%b %d&quot;</span>) <span class="sc">+</span></span>
<span id="cb32-9"><a href="modelling.html#cb32-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Influenza Outbreak (1978 Boarding School)&quot;</span>,</span>
<span id="cb32-10"><a href="modelling.html#cb32-10" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Number of Students&quot;</span>, <span class="at">color =</span> <span class="st">&quot;Status&quot;</span>) <span class="sc">+</span></span>
<span id="cb32-11"><a href="modelling.html#cb32-11" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb32-12"><a href="modelling.html#cb32-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code></pre></div>
<p><img src="06-epidemiological-modelling_files/figure-html/unnamed-chunk-3-1.png" width="1152" style="display: block; margin: auto;" /></p>
<p>Now let’s implement the SIR model in R:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="modelling.html#cb33-1" tabindex="-1"></a>sir_model <span class="ot">&lt;-</span> <span class="cf">function</span>(number_of_days, BETA, GAMMA, <span class="at">dt =</span> <span class="dv">1</span>) {</span>
<span id="cb33-2"><a href="modelling.html#cb33-2" tabindex="-1"></a>  N <span class="ot">&lt;-</span> <span class="dv">763</span></span>
<span id="cb33-3"><a href="modelling.html#cb33-3" tabindex="-1"></a>  I0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb33-4"><a href="modelling.html#cb33-4" tabindex="-1"></a>  S0 <span class="ot">&lt;-</span> N <span class="sc">-</span> I0</span>
<span id="cb33-5"><a href="modelling.html#cb33-5" tabindex="-1"></a>  R0 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb33-6"><a href="modelling.html#cb33-6" tabindex="-1"></a></span>
<span id="cb33-7"><a href="modelling.html#cb33-7" tabindex="-1"></a>  times <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, number_of_days, <span class="at">by =</span> dt)</span>
<span id="cb33-8"><a href="modelling.html#cb33-8" tabindex="-1"></a>  n_steps <span class="ot">&lt;-</span> <span class="fu">length</span>(times)</span>
<span id="cb33-9"><a href="modelling.html#cb33-9" tabindex="-1"></a></span>
<span id="cb33-10"><a href="modelling.html#cb33-10" tabindex="-1"></a>  sirdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb33-11"><a href="modelling.html#cb33-11" tabindex="-1"></a>    <span class="at">t =</span> times,</span>
<span id="cb33-12"><a href="modelling.html#cb33-12" tabindex="-1"></a>    <span class="at">S =</span> <span class="fu">numeric</span>(n_steps),</span>
<span id="cb33-13"><a href="modelling.html#cb33-13" tabindex="-1"></a>    <span class="at">I =</span> <span class="fu">numeric</span>(n_steps),</span>
<span id="cb33-14"><a href="modelling.html#cb33-14" tabindex="-1"></a>    <span class="at">R =</span> <span class="fu">numeric</span>(n_steps)</span>
<span id="cb33-15"><a href="modelling.html#cb33-15" tabindex="-1"></a>  )</span>
<span id="cb33-16"><a href="modelling.html#cb33-16" tabindex="-1"></a></span>
<span id="cb33-17"><a href="modelling.html#cb33-17" tabindex="-1"></a>  sirdata[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, S0, I0, R0)</span>
<span id="cb33-18"><a href="modelling.html#cb33-18" tabindex="-1"></a></span>
<span id="cb33-19"><a href="modelling.html#cb33-19" tabindex="-1"></a>  <span class="cf">for</span> (tt <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n_steps) {</span>
<span id="cb33-20"><a href="modelling.html#cb33-20" tabindex="-1"></a>    S_prev <span class="ot">&lt;-</span> sirdata<span class="sc">$</span>S[tt <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb33-21"><a href="modelling.html#cb33-21" tabindex="-1"></a>    I_prev <span class="ot">&lt;-</span> sirdata<span class="sc">$</span>I[tt <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb33-22"><a href="modelling.html#cb33-22" tabindex="-1"></a>    R_prev <span class="ot">&lt;-</span> sirdata<span class="sc">$</span>R[tt <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb33-23"><a href="modelling.html#cb33-23" tabindex="-1"></a></span>
<span id="cb33-24"><a href="modelling.html#cb33-24" tabindex="-1"></a>    new_infections <span class="ot">&lt;-</span> BETA <span class="sc">*</span> S_prev <span class="sc">*</span> I_prev <span class="sc">*</span> dt</span>
<span id="cb33-25"><a href="modelling.html#cb33-25" tabindex="-1"></a>    new_recoveries <span class="ot">&lt;-</span> GAMMA <span class="sc">*</span> I_prev <span class="sc">*</span> dt</span>
<span id="cb33-26"><a href="modelling.html#cb33-26" tabindex="-1"></a></span>
<span id="cb33-27"><a href="modelling.html#cb33-27" tabindex="-1"></a>    new_infections <span class="ot">&lt;-</span> <span class="fu">min</span>(new_infections, S_prev)</span>
<span id="cb33-28"><a href="modelling.html#cb33-28" tabindex="-1"></a>    new_recoveries <span class="ot">&lt;-</span> <span class="fu">min</span>(new_recoveries, I_prev)</span>
<span id="cb33-29"><a href="modelling.html#cb33-29" tabindex="-1"></a></span>
<span id="cb33-30"><a href="modelling.html#cb33-30" tabindex="-1"></a>    S_new <span class="ot">&lt;-</span> S_prev <span class="sc">-</span> new_infections</span>
<span id="cb33-31"><a href="modelling.html#cb33-31" tabindex="-1"></a>    I_new <span class="ot">&lt;-</span> I_prev <span class="sc">+</span> new_infections <span class="sc">-</span> new_recoveries</span>
<span id="cb33-32"><a href="modelling.html#cb33-32" tabindex="-1"></a>    R_new <span class="ot">&lt;-</span> R_prev <span class="sc">+</span> new_recoveries</span>
<span id="cb33-33"><a href="modelling.html#cb33-33" tabindex="-1"></a></span>
<span id="cb33-34"><a href="modelling.html#cb33-34" tabindex="-1"></a>    sirdata[tt, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(times[tt], S_new, I_new, R_new)</span>
<span id="cb33-35"><a href="modelling.html#cb33-35" tabindex="-1"></a>  }</span>
<span id="cb33-36"><a href="modelling.html#cb33-36" tabindex="-1"></a></span>
<span id="cb33-37"><a href="modelling.html#cb33-37" tabindex="-1"></a>  <span class="fu">return</span>(sirdata)</span>
<span id="cb33-38"><a href="modelling.html#cb33-38" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="modelling.html#cb34-1" tabindex="-1"></a>output <span class="ot">=</span> <span class="fu">sir_model</span>(<span class="dv">14</span>, <span class="fl">0.0026</span>, <span class="fl">0.565</span>, <span class="fl">0.1</span>)</span>
<span id="cb34-2"><a href="modelling.html#cb34-2" tabindex="-1"></a></span>
<span id="cb34-3"><a href="modelling.html#cb34-3" tabindex="-1"></a>sirdata_long <span class="ot">=</span> <span class="fu">pivot_longer</span>(output, <span class="at">cols =</span> <span class="fu">c</span>(<span class="st">&quot;S&quot;</span>, <span class="st">&quot;I&quot;</span>, <span class="st">&quot;R&quot;</span>),</span>
<span id="cb34-4"><a href="modelling.html#cb34-4" tabindex="-1"></a>                            <span class="at">names_to =</span> <span class="st">&quot;compartment&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;count&quot;</span>)</span>
<span id="cb34-5"><a href="modelling.html#cb34-5" tabindex="-1"></a></span>
<span id="cb34-6"><a href="modelling.html#cb34-6" tabindex="-1"></a><span class="fu">ggplot</span>(sirdata_long, <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> count, <span class="at">color =</span> compartment)) <span class="sc">+</span></span>
<span id="cb34-7"><a href="modelling.html#cb34-7" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb34-8"><a href="modelling.html#cb34-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Influenza Outbreak (1978 Boarding School)&quot;</span>,</span>
<span id="cb34-9"><a href="modelling.html#cb34-9" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Number of Students&quot;</span>, <span class="at">color =</span> <span class="st">&quot;Status&quot;</span>) <span class="sc">+</span></span>
<span id="cb34-10"><a href="modelling.html#cb34-10" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="06-epidemiological-modelling_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>Let’s now compare the observed <code>in_bed</code> data with the simulated number of infectious individuals:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="modelling.html#cb35-1" tabindex="-1"></a>sir_output <span class="ot">&lt;-</span> <span class="fu">sir_model</span>(<span class="dv">14</span>, <span class="fl">0.0026</span>, <span class="fl">0.565</span>, <span class="at">dt =</span> <span class="fl">0.1</span>)</span>
<span id="cb35-2"><a href="modelling.html#cb35-2" tabindex="-1"></a></span>
<span id="cb35-3"><a href="modelling.html#cb35-3" tabindex="-1"></a>sir_daily <span class="ot">&lt;-</span> sir_output <span class="sc">%&gt;%</span></span>
<span id="cb35-4"><a href="modelling.html#cb35-4" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="at">day =</span> <span class="fu">floor</span>(t)) <span class="sc">%&gt;%</span></span>
<span id="cb35-5"><a href="modelling.html#cb35-5" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">I_simulated =</span> <span class="fu">mean</span>(I))</span>
<span id="cb35-6"><a href="modelling.html#cb35-6" tabindex="-1"></a></span>
<span id="cb35-7"><a href="modelling.html#cb35-7" tabindex="-1"></a>observed_data <span class="ot">&lt;-</span> outbreak_data <span class="sc">%&gt;%</span></span>
<span id="cb35-8"><a href="modelling.html#cb35-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">day =</span> <span class="fu">as.numeric</span>(date <span class="sc">-</span> <span class="fu">min</span>(date))) <span class="sc">%&gt;%</span></span>
<span id="cb35-9"><a href="modelling.html#cb35-9" tabindex="-1"></a>  <span class="fu">select</span>(day, in_bed)</span>
<span id="cb35-10"><a href="modelling.html#cb35-10" tabindex="-1"></a></span>
<span id="cb35-11"><a href="modelling.html#cb35-11" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> <span class="fu">left_join</span>(observed_data, sir_daily, <span class="at">by =</span> <span class="st">&quot;day&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb35-12"><a href="modelling.html#cb35-12" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">c</span>(in_bed, I_simulated),</span>
<span id="cb35-13"><a href="modelling.html#cb35-13" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;type&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;count&quot;</span>)</span>
<span id="cb35-14"><a href="modelling.html#cb35-14" tabindex="-1"></a></span>
<span id="cb35-15"><a href="modelling.html#cb35-15" tabindex="-1"></a><span class="fu">ggplot</span>(plot_data, <span class="fu">aes</span>(<span class="at">x =</span> day, <span class="at">y =</span> count, <span class="at">color =</span> type)) <span class="sc">+</span></span>
<span id="cb35-16"><a href="modelling.html#cb35-16" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb35-17"><a href="modelling.html#cb35-17" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb35-18"><a href="modelling.html#cb35-18" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="dv">0</span><span class="sc">:</span><span class="fu">max</span>(plot_data<span class="sc">$</span>day)) <span class="sc">+</span></span>
<span id="cb35-19"><a href="modelling.html#cb35-19" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Observed vs Simulated Infections&quot;</span>,</span>
<span id="cb35-20"><a href="modelling.html#cb35-20" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;Days Since Outbreak Start&quot;</span>,</span>
<span id="cb35-21"><a href="modelling.html#cb35-21" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Number of Students&quot;</span>,</span>
<span id="cb35-22"><a href="modelling.html#cb35-22" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">&quot;Data Type&quot;</span>) <span class="sc">+</span></span>
<span id="cb35-23"><a href="modelling.html#cb35-23" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb35-24"><a href="modelling.html#cb35-24" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">0</span>))</span></code></pre></div>
<p><img src="06-epidemiological-modelling_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
</div>
<div id="time-series---forecasting" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Time series - Forecasting<a href="modelling.html#time-series---forecasting" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Forecasting plays a crucial role in infectious disease epidemiology by enabling short-term projections of case counts. These projections help guide timely public health decisions, especially when diseases exhibit seasonal or trend-driven behavior. In this section, we compare two popular time series approaches:</p>
<p>Holt-Winters exponential smoothing, which models level, trend, and seasonality using exponentially weighted averages.</p>
<p>ARIMA (AutoRegressive Integrated Moving Average), a flexible class of models that can account for autoregressive lags, differencing (trends), and moving average components, including seasonal extensions (SARIMA).</p>
<p>Unlike mechanistic models (e.g., SIR), these statistical methods do not rely on assumptions about transmission mechanisms. Instead, they learn from the patterns and structure of historical data to forecast future values.</p>
<p>We apply both models to weekly national tick-borne encephalitis (TBE) cases and generate forecasts for the year following a specified historical cutoff.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="modelling.html#cb36-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb36-2"><a href="modelling.html#cb36-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb36-3"><a href="modelling.html#cb36-3" tabindex="-1"></a><span class="fu">library</span>(forecast)</span></code></pre></div>
<pre><code>## Registered S3 method overwritten by &#39;quantmod&#39;:
##   method            from
##   as.zoo.data.frame zoo</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="modelling.html#cb38-1" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb38-2"><a href="modelling.html#cb38-2" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb38-3"><a href="modelling.html#cb38-3" tabindex="-1"></a></span>
<span id="cb38-4"><a href="modelling.html#cb38-4" tabindex="-1"></a><span class="co"># --- Load and preprocess data ---</span></span>
<span id="cb38-5"><a href="modelling.html#cb38-5" tabindex="-1"></a>tbe_local <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;data/tick_borne_encephalitis.csv&quot;</span>)</span>
<span id="cb38-6"><a href="modelling.html#cb38-6" tabindex="-1"></a></span>
<span id="cb38-7"><a href="modelling.html#cb38-7" tabindex="-1"></a>tbe_national <span class="ot">&lt;-</span> tbe_local <span class="sc">%&gt;%</span></span>
<span id="cb38-8"><a href="modelling.html#cb38-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">timestamp =</span> <span class="fu">as.Date</span>(timestamp)) <span class="sc">%&gt;%</span></span>
<span id="cb38-9"><a href="modelling.html#cb38-9" tabindex="-1"></a>  <span class="fu">group_by</span>(timestamp) <span class="sc">%&gt;%</span></span>
<span id="cb38-10"><a href="modelling.html#cb38-10" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">cases =</span> <span class="fu">sum</span>(cases), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>)</span>
<span id="cb38-11"><a href="modelling.html#cb38-11" tabindex="-1"></a></span>
<span id="cb38-12"><a href="modelling.html#cb38-12" tabindex="-1"></a><span class="co"># --- Forecasting setup ---</span></span>
<span id="cb38-13"><a href="modelling.html#cb38-13" tabindex="-1"></a>year <span class="ot">&lt;-</span> <span class="dv">2018</span>  <span class="co"># Change to define cutoff year</span></span>
<span id="cb38-14"><a href="modelling.html#cb38-14" tabindex="-1"></a></span>
<span id="cb38-15"><a href="modelling.html#cb38-15" tabindex="-1"></a>tbe_national_context <span class="ot">&lt;-</span> tbe_national <span class="sc">%&gt;%</span></span>
<span id="cb38-16"><a href="modelling.html#cb38-16" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(timestamp) <span class="sc">&lt;=</span> year)</span>
<span id="cb38-17"><a href="modelling.html#cb38-17" tabindex="-1"></a></span>
<span id="cb38-18"><a href="modelling.html#cb38-18" tabindex="-1"></a>tbe_national_future <span class="ot">&lt;-</span> tbe_national <span class="sc">%&gt;%</span></span>
<span id="cb38-19"><a href="modelling.html#cb38-19" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(timestamp) <span class="sc">==</span> year <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-20"><a href="modelling.html#cb38-20" tabindex="-1"></a>  <span class="fu">arrange</span>(timestamp)</span>
<span id="cb38-21"><a href="modelling.html#cb38-21" tabindex="-1"></a></span>
<span id="cb38-22"><a href="modelling.html#cb38-22" tabindex="-1"></a><span class="co"># ---- Create time series object ----</span></span>
<span id="cb38-23"><a href="modelling.html#cb38-23" tabindex="-1"></a>context_ts <span class="ot">&lt;-</span> <span class="fu">ts</span>(tbe_national_context<span class="sc">$</span>cases, <span class="at">frequency =</span> <span class="dv">52</span>)</span>
<span id="cb38-24"><a href="modelling.html#cb38-24" tabindex="-1"></a></span>
<span id="cb38-25"><a href="modelling.html#cb38-25" tabindex="-1"></a><span class="co"># ---- Holt-Winters model ----</span></span>
<span id="cb38-26"><a href="modelling.html#cb38-26" tabindex="-1"></a>hw_model <span class="ot">&lt;-</span> <span class="fu">HoltWinters</span>(context_ts)</span>
<span id="cb38-27"><a href="modelling.html#cb38-27" tabindex="-1"></a>forecast_hw <span class="ot">&lt;-</span> <span class="fu">forecast</span>(hw_model, <span class="at">h =</span> <span class="dv">52</span>)</span>
<span id="cb38-28"><a href="modelling.html#cb38-28" tabindex="-1"></a></span>
<span id="cb38-29"><a href="modelling.html#cb38-29" tabindex="-1"></a>predicted_df_hw <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb38-30"><a href="modelling.html#cb38-30" tabindex="-1"></a>  <span class="at">timestamp =</span> <span class="fu">seq.Date</span>(<span class="at">from =</span> <span class="fu">as.Date</span>(<span class="fu">paste0</span>(year <span class="sc">+</span> <span class="dv">1</span>, <span class="st">&quot;-01-01&quot;</span>)), <span class="at">by =</span> <span class="st">&quot;week&quot;</span>, <span class="at">length.out =</span> <span class="dv">52</span>),</span>
<span id="cb38-31"><a href="modelling.html#cb38-31" tabindex="-1"></a>  <span class="at">cases =</span> <span class="fu">as.numeric</span>(forecast_hw<span class="sc">$</span>mean),</span>
<span id="cb38-32"><a href="modelling.html#cb38-32" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;predicted_hw&quot;</span></span>
<span id="cb38-33"><a href="modelling.html#cb38-33" tabindex="-1"></a>)</span>
<span id="cb38-34"><a href="modelling.html#cb38-34" tabindex="-1"></a></span>
<span id="cb38-35"><a href="modelling.html#cb38-35" tabindex="-1"></a><span class="co"># ---- ARIMA model ----</span></span>
<span id="cb38-36"><a href="modelling.html#cb38-36" tabindex="-1"></a>arima_model <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(context_ts, <span class="at">seasonal =</span> <span class="cn">TRUE</span>)</span>
<span id="cb38-37"><a href="modelling.html#cb38-37" tabindex="-1"></a>forecast_arima <span class="ot">&lt;-</span> <span class="fu">forecast</span>(arima_model, <span class="at">h =</span> <span class="dv">52</span>)</span>
<span id="cb38-38"><a href="modelling.html#cb38-38" tabindex="-1"></a></span>
<span id="cb38-39"><a href="modelling.html#cb38-39" tabindex="-1"></a>predicted_df_arima <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb38-40"><a href="modelling.html#cb38-40" tabindex="-1"></a>  <span class="at">timestamp =</span> <span class="fu">seq.Date</span>(<span class="at">from =</span> <span class="fu">as.Date</span>(<span class="fu">paste0</span>(year <span class="sc">+</span> <span class="dv">1</span>, <span class="st">&quot;-01-01&quot;</span>)), <span class="at">by =</span> <span class="st">&quot;week&quot;</span>, <span class="at">length.out =</span> <span class="dv">52</span>),</span>
<span id="cb38-41"><a href="modelling.html#cb38-41" tabindex="-1"></a>  <span class="at">cases =</span> <span class="fu">as.numeric</span>(forecast_arima<span class="sc">$</span>mean),</span>
<span id="cb38-42"><a href="modelling.html#cb38-42" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;predicted_arima&quot;</span></span>
<span id="cb38-43"><a href="modelling.html#cb38-43" tabindex="-1"></a>)</span>
<span id="cb38-44"><a href="modelling.html#cb38-44" tabindex="-1"></a></span>
<span id="cb38-45"><a href="modelling.html#cb38-45" tabindex="-1"></a><span class="co"># ---- Combine all data for plotting ----</span></span>
<span id="cb38-46"><a href="modelling.html#cb38-46" tabindex="-1"></a>context_labeled <span class="ot">&lt;-</span> tbe_national_context <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">type =</span> <span class="st">&quot;historical&quot;</span>)</span>
<span id="cb38-47"><a href="modelling.html#cb38-47" tabindex="-1"></a>future_labeled  <span class="ot">&lt;-</span> tbe_national_future <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">type =</span> <span class="st">&quot;observed&quot;</span>)</span>
<span id="cb38-48"><a href="modelling.html#cb38-48" tabindex="-1"></a></span>
<span id="cb38-49"><a href="modelling.html#cb38-49" tabindex="-1"></a>combined_data <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(context_labeled, future_labeled, predicted_df_hw, predicted_df_arima)</span>
<span id="cb38-50"><a href="modelling.html#cb38-50" tabindex="-1"></a></span>
<span id="cb38-51"><a href="modelling.html#cb38-51" tabindex="-1"></a><span class="co"># ---- Plot full timeline ----</span></span>
<span id="cb38-52"><a href="modelling.html#cb38-52" tabindex="-1"></a>main_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(combined_data, <span class="fu">aes</span>(<span class="at">x =</span> timestamp, <span class="at">y =</span> cases, <span class="at">color =</span> type)) <span class="sc">+</span></span>
<span id="cb38-53"><a href="modelling.html#cb38-53" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb38-54"><a href="modelling.html#cb38-54" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb38-55"><a href="modelling.html#cb38-55" tabindex="-1"></a>    <span class="st">&quot;historical&quot;</span>      <span class="ot">=</span> <span class="st">&quot;#1f77b4&quot;</span>,</span>
<span id="cb38-56"><a href="modelling.html#cb38-56" tabindex="-1"></a>    <span class="st">&quot;observed&quot;</span>        <span class="ot">=</span> <span class="st">&quot;#2ca02c&quot;</span>,</span>
<span id="cb38-57"><a href="modelling.html#cb38-57" tabindex="-1"></a>    <span class="st">&quot;predicted_hw&quot;</span>    <span class="ot">=</span> <span class="st">&quot;#d62728&quot;</span>,</span>
<span id="cb38-58"><a href="modelling.html#cb38-58" tabindex="-1"></a>    <span class="st">&quot;predicted_arima&quot;</span> <span class="ot">=</span> <span class="st">&quot;#ff7f0e&quot;</span></span>
<span id="cb38-59"><a href="modelling.html#cb38-59" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb38-60"><a href="modelling.html#cb38-60" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb38-61"><a href="modelling.html#cb38-61" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb38-62"><a href="modelling.html#cb38-62" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">&quot;TBE Weekly Cases: Forecasting&quot;</span>, year <span class="sc">+</span> <span class="dv">1</span>),</span>
<span id="cb38-63"><a href="modelling.html#cb38-63" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Time&quot;</span>,</span>
<span id="cb38-64"><a href="modelling.html#cb38-64" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Cases&quot;</span>,</span>
<span id="cb38-65"><a href="modelling.html#cb38-65" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Data Type&quot;</span></span>
<span id="cb38-66"><a href="modelling.html#cb38-66" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb38-67"><a href="modelling.html#cb38-67" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb38-68"><a href="modelling.html#cb38-68" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>,</span>
<span id="cb38-69"><a href="modelling.html#cb38-69" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">size =</span> <span class="dv">16</span>)</span>
<span id="cb38-70"><a href="modelling.html#cb38-70" tabindex="-1"></a>  )</span>
<span id="cb38-71"><a href="modelling.html#cb38-71" tabindex="-1"></a></span>
<span id="cb38-72"><a href="modelling.html#cb38-72" tabindex="-1"></a><span class="co"># ---- Plot zoomed forecast year ----</span></span>
<span id="cb38-73"><a href="modelling.html#cb38-73" tabindex="-1"></a>zoom_plot <span class="ot">&lt;-</span> combined_data <span class="sc">%&gt;%</span></span>
<span id="cb38-74"><a href="modelling.html#cb38-74" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">year</span>(timestamp) <span class="sc">==</span> year <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb38-75"><a href="modelling.html#cb38-75" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> timestamp, <span class="at">y =</span> cases, <span class="at">color =</span> type)) <span class="sc">+</span></span>
<span id="cb38-76"><a href="modelling.html#cb38-76" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb38-77"><a href="modelling.html#cb38-77" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(</span>
<span id="cb38-78"><a href="modelling.html#cb38-78" tabindex="-1"></a>    <span class="st">&quot;historical&quot;</span>      <span class="ot">=</span> <span class="st">&quot;#1f77b4&quot;</span>,</span>
<span id="cb38-79"><a href="modelling.html#cb38-79" tabindex="-1"></a>    <span class="st">&quot;observed&quot;</span>        <span class="ot">=</span> <span class="st">&quot;#2ca02c&quot;</span>,</span>
<span id="cb38-80"><a href="modelling.html#cb38-80" tabindex="-1"></a>    <span class="st">&quot;predicted_hw&quot;</span>    <span class="ot">=</span> <span class="st">&quot;#d62728&quot;</span>,</span>
<span id="cb38-81"><a href="modelling.html#cb38-81" tabindex="-1"></a>    <span class="st">&quot;predicted_arima&quot;</span> <span class="ot">=</span> <span class="st">&quot;#ff7f0e&quot;</span></span>
<span id="cb38-82"><a href="modelling.html#cb38-82" tabindex="-1"></a>  )) <span class="sc">+</span></span>
<span id="cb38-83"><a href="modelling.html#cb38-83" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb38-84"><a href="modelling.html#cb38-84" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb38-85"><a href="modelling.html#cb38-85" tabindex="-1"></a>    <span class="at">title =</span> <span class="fu">paste</span>(<span class="st">&quot;Zoom: Forecasts vs Observed in&quot;</span>, year <span class="sc">+</span> <span class="dv">1</span>),</span>
<span id="cb38-86"><a href="modelling.html#cb38-86" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;Week&quot;</span>,</span>
<span id="cb38-87"><a href="modelling.html#cb38-87" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Cases&quot;</span></span>
<span id="cb38-88"><a href="modelling.html#cb38-88" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb38-89"><a href="modelling.html#cb38-89" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb38-90"><a href="modelling.html#cb38-90" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb38-91"><a href="modelling.html#cb38-91" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>)</span>
<span id="cb38-92"><a href="modelling.html#cb38-92" tabindex="-1"></a>  )</span>
<span id="cb38-93"><a href="modelling.html#cb38-93" tabindex="-1"></a></span>
<span id="cb38-94"><a href="modelling.html#cb38-94" tabindex="-1"></a><span class="co"># ---- Combine and show ----</span></span>
<span id="cb38-95"><a href="modelling.html#cb38-95" tabindex="-1"></a>main_plot <span class="sc">/</span> zoom_plot <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))</span></code></pre></div>
<p><img src="06-epidemiological-modelling_files/figure-html/unnamed-chunk-7-1.png" width="672" />
This analysis demonstrates how different statistical forecasting methods—Holt-Winters vs ARIMA—perform on the same epidemiological time series. While Holt-Winters is intuitive and captures seasonality well, ARIMA can offer greater flexibility in modeling autocorrelated structures. Comparing their predictions side-by-side allows us to evaluate model fit and choose an approach best suited for early warning or planning systems.</p>
</div>
<div id="using-and-applying-models" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Using and applying models<a href="modelling.html#using-and-applying-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="working-with-epidemiological-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="communication-and-sharing-of-code-and-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/stends2001/EpiBible/blob/main06-epidemiological-modelling.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["EpiBible.pdf", "EpiBible.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
