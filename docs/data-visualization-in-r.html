<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Data Visualization in R | Epibible</title>
  <meta name="description" content="Chapter 6 Data Visualization in R | Epibible" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Data Visualization in R | Epibible" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Data Visualization in R | Epibible" />
  
  
  

<meta name="author" content="Sten de Schrijver" />


<meta name="date" content="2025-08-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction-to-the-tidyverse.html"/>
<link rel="next" href="statistics.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Epibible</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="about-the-author.html"><a href="about-the-author.html"><i class="fa fa-check"></i>About the Author</a></li>
<li class="chapter" data-level="1" data-path="introduction-to-epidemiology.html"><a href="introduction-to-epidemiology.html"><i class="fa fa-check"></i><b>1</b> Introduction to Epidemiology</a></li>
<li class="chapter" data-level="2" data-path="working-with-this-book.html"><a href="working-with-this-book.html"><i class="fa fa-check"></i><b>2</b> Working with this book</a>
<ul>
<li class="chapter" data-level="2.1" data-path="working-with-this-book.html"><a href="working-with-this-book.html#what-is-bookdown"><i class="fa fa-check"></i><b>2.1</b> What is bookdown?</a></li>
<li class="chapter" data-level="2.2" data-path="working-with-this-book.html"><a href="working-with-this-book.html#what-is-markdown"><i class="fa fa-check"></i><b>2.2</b> What is Markdown</a></li>
<li class="chapter" data-level="2.3" data-path="working-with-this-book.html"><a href="working-with-this-book.html#code-snippets"><i class="fa fa-check"></i><b>2.3</b> Code snippets</a></li>
<li class="chapter" data-level="2.4" data-path="working-with-this-book.html"><a href="working-with-this-book.html#other-formats-in-this-book"><i class="fa fa-check"></i><b>2.4</b> Other formats in this book</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html"><i class="fa fa-check"></i><b>3</b> Getting Started with R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#installing-r-and-rstudio"><i class="fa fa-check"></i><b>3.1</b> Installing R and Rstudio</a></li>
<li class="chapter" data-level="3.2" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#starting-to-code"><i class="fa fa-check"></i><b>3.2</b> Starting to code</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="r-fundamentals.html"><a href="r-fundamentals.html"><i class="fa fa-check"></i><b>4</b> R fundamentals</a>
<ul>
<li class="chapter" data-level="4.1" data-path="r-fundamentals.html"><a href="r-fundamentals.html#basic-datatypes-in-r"><i class="fa fa-check"></i><b>4.1</b> Basic Datatypes in R</a></li>
<li class="chapter" data-level="4.2" data-path="r-fundamentals.html"><a href="r-fundamentals.html#special-datatypes"><i class="fa fa-check"></i><b>4.2</b> Special datatypes</a></li>
<li class="chapter" data-level="4.3" data-path="r-fundamentals.html"><a href="r-fundamentals.html#converting-between-datatypes"><i class="fa fa-check"></i><b>4.3</b> Converting between datatypes</a></li>
<li class="chapter" data-level="4.4" data-path="r-fundamentals.html"><a href="r-fundamentals.html#data-structures-in-r"><i class="fa fa-check"></i><b>4.4</b> Data structures in R</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="r-fundamentals.html"><a href="r-fundamentals.html#vectors-the-building-blocks"><i class="fa fa-check"></i><b>4.4.1</b> Vectors: The Building Blocks</a></li>
<li class="chapter" data-level="4.4.2" data-path="r-fundamentals.html"><a href="r-fundamentals.html#lists-mixed-data-collections"><i class="fa fa-check"></i><b>4.4.2</b> Lists: Mixed Data Collections</a></li>
<li class="chapter" data-level="4.4.3" data-path="r-fundamentals.html"><a href="r-fundamentals.html#data-frames-the-excel-of-r"><i class="fa fa-check"></i><b>4.4.3</b> Data Frames: The Excel of R</a></li>
<li class="chapter" data-level="4.4.4" data-path="r-fundamentals.html"><a href="r-fundamentals.html#indexing-accessing-your-data"><i class="fa fa-check"></i><b>4.4.4</b> Indexing: Accessing Your Data</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="r-fundamentals.html"><a href="r-fundamentals.html#conditions-and-comparisons"><i class="fa fa-check"></i><b>4.5</b> Conditions and Comparisons</a></li>
<li class="chapter" data-level="4.6" data-path="r-fundamentals.html"><a href="r-fundamentals.html#conditional-execution-with"><i class="fa fa-check"></i><b>4.6</b> Conditional execution with</a></li>
<li class="chapter" data-level="4.7" data-path="r-fundamentals.html"><a href="r-fundamentals.html#repeating-lines-of-code"><i class="fa fa-check"></i><b>4.7</b> Repeating lines of code</a></li>
<li class="chapter" data-level="4.8" data-path="r-fundamentals.html"><a href="r-fundamentals.html#functions"><i class="fa fa-check"></i><b>4.8</b> Functions</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html"><i class="fa fa-check"></i><b>5</b> Introduction to the Tidyverse</a>
<ul>
<li class="chapter" data-level="5.1" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#data-structure-wide-vs.-tidy-data"><i class="fa fa-check"></i><b>5.1</b> Data Structure: Wide vs. Tidy Data</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#understanding-the-difference"><i class="fa fa-check"></i><b>5.1.1</b> Understanding the Difference</a></li>
<li class="chapter" data-level="5.1.2" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#reshaping-data-with-tidyr"><i class="fa fa-check"></i><b>5.1.2</b> Reshaping Data with tidyr</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#core-dplyr-functions-for-data-manipulation"><i class="fa fa-check"></i><b>5.2</b> Core dplyr Functions for Data Manipulation</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#the-pipe-operator"><i class="fa fa-check"></i><b>5.2.1</b> The Pipe Operator (<code>%&gt;%</code>)</a></li>
<li class="chapter" data-level="5.2.2" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#select-choose-columns"><i class="fa fa-check"></i><b>5.2.2</b> <code>select()</code>: Choose Columns</a></li>
<li class="chapter" data-level="5.2.3" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#filter-choose-rows"><i class="fa fa-check"></i><b>5.2.3</b> <code>filter()</code>: Choose Rows</a></li>
<li class="chapter" data-level="5.2.4" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#mutate-create-or-modify-columns"><i class="fa fa-check"></i><b>5.2.4</b> <code>mutate()</code>: Create or Modify Columns</a></li>
<li class="chapter" data-level="5.2.5" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#transmute-create-new-columns-drop-others"><i class="fa fa-check"></i><b>5.2.5</b> <code>transmute()</code>: Create New Columns (Drop Others)</a></li>
<li class="chapter" data-level="5.2.6" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#arrange-sort-rows"><i class="fa fa-check"></i><b>5.2.6</b> <code>arrange()</code>: Sort Rows</a></li>
<li class="chapter" data-level="5.2.7" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#group_by-and-summarise-group-operations"><i class="fa fa-check"></i><b>5.2.7</b> <code>group_by()</code> and <code>summarise()</code>: Group Operations</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#additional-essential-functions"><i class="fa fa-check"></i><b>5.3</b> Additional Essential Functions</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#rename-change-column-names"><i class="fa fa-check"></i><b>5.3.1</b> <code>rename()</code>: Change Column Names</a></li>
<li class="chapter" data-level="5.3.2" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#data-type-conversions"><i class="fa fa-check"></i><b>5.3.2</b> Data Type Conversions</a></li>
<li class="chapter" data-level="5.3.3" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#across-apply-functions-to-multiple-columns"><i class="fa fa-check"></i><b>5.3.3</b> <code>across()</code>: Apply Functions to Multiple Columns</a></li>
<li class="chapter" data-level="5.3.4" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#recode-recode-values"><i class="fa fa-check"></i><b>5.3.4</b> <code>recode()</code>: Recode Values</a></li>
<li class="chapter" data-level="5.3.5" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#case_when-multiple-conditional-logic"><i class="fa fa-check"></i><b>5.3.5</b> <code>case_when()</code>: Multiple Conditional Logic</a></li>
<li class="chapter" data-level="5.3.6" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#replace_na-handle-missing-values"><i class="fa fa-check"></i><b>5.3.6</b> <code>replace_na()</code>: Handle Missing Values</a></li>
<li class="chapter" data-level="5.3.7" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#which-find-positions"><i class="fa fa-check"></i><b>5.3.7</b> <code>which()</code>: Find Positions</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#practical-example-data-analysis-workflow"><i class="fa fa-check"></i><b>5.4</b> Practical Example: Data Analysis Workflow</a></li>
<li class="chapter" data-level="5.5" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#function-summary-table"><i class="fa fa-check"></i><b>5.5</b> Function Summary Table</a></li>
<li class="chapter" data-level="5.6" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#conclusion"><i class="fa fa-check"></i><b>5.6</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html"><i class="fa fa-check"></i><b>6</b> Data Visualization in R</a>
<ul>
<li class="chapter" data-level="6.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#ggplot2-the-grammar-of-graphics"><i class="fa fa-check"></i><b>6.1</b> ggplot2: The Grammar of Graphics</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#basic-ggplot2-structure"><i class="fa fa-check"></i><b>6.1.1</b> Basic ggplot2 Structure</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#basic-plot-types"><i class="fa fa-check"></i><b>6.2</b> Basic Plot Types</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#scatter-plots-with-geom_point"><i class="fa fa-check"></i><b>6.2.1</b> Scatter Plots with <code>geom_point()</code></a></li>
<li class="chapter" data-level="6.2.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#line-plots-with-geom_line"><i class="fa fa-check"></i><b>6.2.2</b> Line Plots with <code>geom_line()</code></a></li>
<li class="chapter" data-level="6.2.3" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#bar-plots-with-geom_col-and-geom_bar"><i class="fa fa-check"></i><b>6.2.3</b> Bar Plots with <code>geom_col()</code> and <code>geom_bar()</code></a></li>
<li class="chapter" data-level="6.2.4" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#histograms-with-geom_histogram"><i class="fa fa-check"></i><b>6.2.4</b> Histograms with <code>geom_histogram()</code></a></li>
<li class="chapter" data-level="6.2.5" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#box-plots-with-geom_boxplot"><i class="fa fa-check"></i><b>6.2.5</b> Box Plots with <code>geom_boxplot()</code></a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#aesthetic-mappings"><i class="fa fa-check"></i><b>6.3</b> Aesthetic Mappings</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#understanding-aes"><i class="fa fa-check"></i><b>6.3.1</b> Understanding <code>aes()</code></a></li>
<li class="chapter" data-level="6.3.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#fixed-vs.-mapped-aesthetics"><i class="fa fa-check"></i><b>6.3.2</b> Fixed vs. Mapped Aesthetics</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#faceting-small-multiples"><i class="fa fa-check"></i><b>6.4</b> Faceting: Small Multiples</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#facet_wrap"><i class="fa fa-check"></i><b>6.4.1</b> <code>facet_wrap()</code></a></li>
<li class="chapter" data-level="6.4.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#facet_grid"><i class="fa fa-check"></i><b>6.4.2</b> <code>facet_grid()</code></a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#statistical-transformations"><i class="fa fa-check"></i><b>6.5</b> Statistical Transformations</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#smooth-lines-with-geom_smooth"><i class="fa fa-check"></i><b>6.5.1</b> Smooth Lines with <code>geom_smooth()</code></a></li>
<li class="chapter" data-level="6.5.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#statistical-summaries"><i class="fa fa-check"></i><b>6.5.2</b> Statistical Summaries</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#scales-controlling-aesthetic-mappings"><i class="fa fa-check"></i><b>6.6</b> Scales: Controlling Aesthetic Mappings</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#color-scales"><i class="fa fa-check"></i><b>6.6.1</b> Color Scales</a></li>
<li class="chapter" data-level="6.6.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#axis-scales"><i class="fa fa-check"></i><b>6.6.2</b> Axis Scales</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#coordinates-and-transformations"><i class="fa fa-check"></i><b>6.7</b> Coordinates and Transformations</a></li>
<li class="chapter" data-level="6.8" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#labels-and-themes"><i class="fa fa-check"></i><b>6.8</b> Labels and Themes</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#adding-labels"><i class="fa fa-check"></i><b>6.8.1</b> Adding Labels</a></li>
<li class="chapter" data-level="6.8.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#theme-customization"><i class="fa fa-check"></i><b>6.8.2</b> Theme Customization</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#heatmaps"><i class="fa fa-check"></i><b>6.9</b> Heatmaps</a></li>
<li class="chapter" data-level="6.10" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#combining-multiple-geoms"><i class="fa fa-check"></i><b>6.10</b> Combining Multiple Geoms</a></li>
<li class="chapter" data-level="6.11" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#text-and-annotations"><i class="fa fa-check"></i><b>6.11</b> Text and Annotations</a></li>
<li class="chapter" data-level="6.12" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#practical-example-complex-multi-layered-plot"><i class="fa fa-check"></i><b>6.12</b> Practical Example: Complex Multi-layered Plot</a></li>
<li class="chapter" data-level="6.13" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#ggplot2-function-summary-table"><i class="fa fa-check"></i><b>6.13</b> ggplot2 Function Summary Table</a></li>
<li class="chapter" data-level="6.14" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#conclusion-1"><i class="fa fa-check"></i><b>6.14</b> Conclusion</a></li>
<li class="chapter" data-level="6.15" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#my-favorite-figures-i-ever-made"><i class="fa fa-check"></i><b>6.15</b> My favorite figures I ever made</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>7</b> Statistics</a></li>
<li class="chapter" data-level="8" data-path="working-with-epidemiological-data.html"><a href="working-with-epidemiological-data.html"><i class="fa fa-check"></i><b>8</b> Working with epidemiological data</a>
<ul>
<li class="chapter" data-level="8.1" data-path="working-with-epidemiological-data.html"><a href="working-with-epidemiological-data.html#acessing-data"><i class="fa fa-check"></i><b>8.1</b> Acessing data</a></li>
<li class="chapter" data-level="8.2" data-path="working-with-epidemiological-data.html"><a href="working-with-epidemiological-data.html#case-study-1-yellow-fever"><i class="fa fa-check"></i><b>8.2</b> Case Study 1: Yellow Fever</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="case-study-dengue-fever-in-brazil.html"><a href="case-study-dengue-fever-in-brazil.html"><i class="fa fa-check"></i><b>9</b> Case study: Dengue Fever in Brazil</a></li>
<li class="chapter" data-level="10" data-path="modelling.html"><a href="modelling.html"><i class="fa fa-check"></i><b>10</b> Modelling</a>
<ul>
<li class="chapter" data-level="10.1" data-path="modelling.html"><a href="modelling.html#compartmental-models"><i class="fa fa-check"></i><b>10.1</b> Compartmental models</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="modelling.html"><a href="modelling.html#sir-model-in-theory"><i class="fa fa-check"></i><b>10.1.1</b> SIR model in theory</a></li>
<li class="chapter" data-level="10.1.2" data-path="modelling.html"><a href="modelling.html#sir-model-in-r"><i class="fa fa-check"></i><b>10.1.2</b> SIR model in R</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="modelling.html"><a href="modelling.html#time-series---forecasting"><i class="fa fa-check"></i><b>10.2</b> Time series - Forecasting</a></li>
<li class="chapter" data-level="10.3" data-path="modelling.html"><a href="modelling.html#using-and-applying-models"><i class="fa fa-check"></i><b>10.3</b> Using and applying models</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="communication-and-sharing-of-code-and-data.html"><a href="communication-and-sharing-of-code-and-data.html"><i class="fa fa-check"></i><b>11</b> Communication and sharing of code and data</a>
<ul>
<li class="chapter" data-level="11.1" data-path="communication-and-sharing-of-code-and-data.html"><a href="communication-and-sharing-of-code-and-data.html#writing-code-best-practices"><i class="fa fa-check"></i><b>11.1</b> Writing code: best practices</a></li>
<li class="chapter" data-level="11.2" data-path="communication-and-sharing-of-code-and-data.html"><a href="communication-and-sharing-of-code-and-data.html#github"><i class="fa fa-check"></i><b>11.2</b> Github</a></li>
<li class="chapter" data-level="11.3" data-path="communication-and-sharing-of-code-and-data.html"><a href="communication-and-sharing-of-code-and-data.html#reports-using-markdown"><i class="fa fa-check"></i><b>11.3</b> Reports using Markdown</a></li>
<li class="chapter" data-level="11.4" data-path="communication-and-sharing-of-code-and-data.html"><a href="communication-and-sharing-of-code-and-data.html#open-science"><i class="fa fa-check"></i><b>11.4</b> Open science</a></li>
<li class="chapter" data-level="11.5" data-path="communication-and-sharing-of-code-and-data.html"><a href="communication-and-sharing-of-code-and-data.html#communities-and-forums"><i class="fa fa-check"></i><b>11.5</b> Communities and forums</a></li>
<li class="chapter" data-level="11.6" data-path="communication-and-sharing-of-code-and-data.html"><a href="communication-and-sharing-of-code-and-data.html#how-to-use-chat-gpt"><i class="fa fa-check"></i><b>11.6</b> How to use Chat-GPT</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="recommended-reading.html"><a href="recommended-reading.html"><i class="fa fa-check"></i><b>12</b> Recommended Reading</a>
<ul>
<li class="chapter" data-level="12.1" data-path="recommended-reading.html"><a href="recommended-reading.html#recommended-textbooks-and-courses"><i class="fa fa-check"></i><b>12.1</b> Recommended textbooks and courses</a></li>
<li class="chapter" data-level="12.2" data-path="recommended-reading.html"><a href="recommended-reading.html#useful-packages"><i class="fa fa-check"></i><b>12.2</b> Useful packages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Epibible</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-visualization-in-r" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> Data Visualization in R<a href="data-visualization-in-r.html#data-visualization-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="ggplot2-the-grammar-of-graphics" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> ggplot2: The Grammar of Graphics<a href="data-visualization-in-r.html#ggplot2-the-grammar-of-graphics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>ggplot2</strong> is the tidyverse package for data visualization, based on Leland Wilkinson’s “Grammar of Graphics.” Unlike base R plotting, ggplot2 builds plots layer by layer using a consistent grammar that makes complex visualizations intuitive and customizable.</p>
<p>The grammar of graphics breaks down any plot into fundamental components:</p>
<ul>
<li><strong>Data</strong>: The dataset you want to visualize</li>
<li><strong>Aesthetics (aes)</strong>: How variables map to visual properties (x, y, color, size, etc.)</li>
<li><strong>Geometries (geom)</strong>: The visual elements that represent data (points, lines, bars, etc.)</li>
<li><strong>Statistics (stat)</strong>: Statistical transformations of the data (counts, means, etc.)</li>
<li><strong>Scales</strong>: How aesthetic mappings translate to visual values</li>
<li><strong>Coordinate systems</strong>: How data maps to the plot area</li>
<li><strong>Themes</strong>: Overall visual appearance</li>
</ul>
<div id="basic-ggplot2-structure" class="section level3 hasAnchor" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> Basic ggplot2 Structure<a href="data-visualization-in-r.html#basic-ggplot2-structure" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Every ggplot follows this basic template:</p>
<pre><code># Basic template
ggplot(data = &lt;DATA&gt;) + 
  &lt;GEOM_FUNCTION&gt;(mapping = aes(&lt;MAPPINGS&gt;)) +
  &lt;OTHER_LAYERS&gt;</code></pre>
<p>Let’s start with the gapminder dataset to explore these concepts:</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="data-visualization-in-r.html#cb142-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb142-2"><a href="data-visualization-in-r.html#cb142-2" tabindex="-1"></a><span class="fu">library</span>(gapminder)</span>
<span id="cb142-3"><a href="data-visualization-in-r.html#cb142-3" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
## ✔ dplyr     1.1.4     ✔ readr     2.1.5
## ✔ forcats   1.0.0     ✔ stringr   1.5.1
## ✔ lubridate 1.9.3     ✔ tibble    3.2.1
## ✔ purrr     1.0.2     ✔ tidyr     1.3.1
## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()
## ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="data-visualization-in-r.html#cb144-1" tabindex="-1"></a><span class="co"># Preview the data</span></span>
<span id="cb144-2"><a href="data-visualization-in-r.html#cb144-2" tabindex="-1"></a><span class="fu">head</span>(gapminder)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 6
##   country     continent  year lifeExp      pop gdpPercap
##   &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
## 1 Afghanistan Asia       1952    28.8  8425333      779.
## 2 Afghanistan Asia       1957    30.3  9240934      821.
## 3 Afghanistan Asia       1962    32.0 10267083      853.
## 4 Afghanistan Asia       1967    34.0 11537966      836.
## 5 Afghanistan Asia       1972    36.1 13079460      740.
## 6 Afghanistan Asia       1977    38.4 14880372      786.</code></pre>
</div>
</div>
<div id="basic-plot-types" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Basic Plot Types<a href="data-visualization-in-r.html#basic-plot-types" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="scatter-plots-with-geom_point" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Scatter Plots with <code>geom_point()</code><a href="data-visualization-in-r.html#scatter-plots-with-geom_point" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="data-visualization-in-r.html#cb146-1" tabindex="-1"></a><span class="co"># Basic scatter plot</span></span>
<span id="cb146-2"><a href="data-visualization-in-r.html#cb146-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb146-3"><a href="data-visualization-in-r.html#cb146-3" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="06-tidyverse-data-visualization_files/figure-html/scatter-basic-1.png" width="672" /></p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="data-visualization-in-r.html#cb147-1" tabindex="-1"></a><span class="co"># Add color mapping</span></span>
<span id="cb147-2"><a href="data-visualization-in-r.html#cb147-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp, <span class="at">color =</span> continent)) <span class="sc">+</span></span>
<span id="cb147-3"><a href="data-visualization-in-r.html#cb147-3" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="06-tidyverse-data-visualization_files/figure-html/scatter-basic-2.png" width="672" /></p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="data-visualization-in-r.html#cb148-1" tabindex="-1"></a><span class="co"># Add size mapping</span></span>
<span id="cb148-2"><a href="data-visualization-in-r.html#cb148-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> gapminder, <span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp, </span>
<span id="cb148-3"><a href="data-visualization-in-r.html#cb148-3" tabindex="-1"></a>                           <span class="at">color =</span> continent, <span class="at">size =</span> pop)) <span class="sc">+</span></span>
<span id="cb148-4"><a href="data-visualization-in-r.html#cb148-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>)  <span class="co"># alpha controls transparency</span></span></code></pre></div>
<p><img src="06-tidyverse-data-visualization_files/figure-html/scatter-basic-3.png" width="672" /></p>
</div>
<div id="line-plots-with-geom_line" class="section level3 hasAnchor" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> Line Plots with <code>geom_line()</code><a href="data-visualization-in-r.html#line-plots-with-geom_line" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="data-visualization-in-r.html#cb149-1" tabindex="-1"></a><span class="co"># Line plot showing trends over time</span></span>
<span id="cb149-2"><a href="data-visualization-in-r.html#cb149-2" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb149-3"><a href="data-visualization-in-r.html#cb149-3" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;United States&quot;</span>, <span class="st">&quot;China&quot;</span>, <span class="st">&quot;India&quot;</span>, <span class="st">&quot;Germany&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb149-4"><a href="data-visualization-in-r.html#cb149-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp, <span class="at">color =</span> country)) <span class="sc">+</span></span>
<span id="cb149-5"><a href="data-visualization-in-r.html#cb149-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>)</span></code></pre></div>
<pre><code>## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
## ℹ Please use `linewidth` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
## generated.</code></pre>
<p><img src="06-tidyverse-data-visualization_files/figure-html/line-plots-1.png" width="672" /></p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="data-visualization-in-r.html#cb151-1" tabindex="-1"></a><span class="co"># Multiple lines with points</span></span>
<span id="cb151-2"><a href="data-visualization-in-r.html#cb151-2" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb151-3"><a href="data-visualization-in-r.html#cb151-3" tabindex="-1"></a>  <span class="fu">filter</span>(continent <span class="sc">==</span> <span class="st">&quot;Oceania&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb151-4"><a href="data-visualization-in-r.html#cb151-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> gdpPercap, <span class="at">color =</span> country)) <span class="sc">+</span></span>
<span id="cb151-5"><a href="data-visualization-in-r.html#cb151-5" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb151-6"><a href="data-visualization-in-r.html#cb151-6" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="06-tidyverse-data-visualization_files/figure-html/line-plots-2.png" width="672" /></p>
</div>
<div id="bar-plots-with-geom_col-and-geom_bar" class="section level3 hasAnchor" number="6.2.3">
<h3><span class="header-section-number">6.2.3</span> Bar Plots with <code>geom_col()</code> and <code>geom_bar()</code><a href="data-visualization-in-r.html#bar-plots-with-geom_col-and-geom_bar" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="data-visualization-in-r.html#cb152-1" tabindex="-1"></a><span class="co"># geom_col: heights of bars represent values in data</span></span>
<span id="cb152-2"><a href="data-visualization-in-r.html#cb152-2" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb152-3"><a href="data-visualization-in-r.html#cb152-3" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>, continent <span class="sc">==</span> <span class="st">&quot;Americas&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb152-4"><a href="data-visualization-in-r.html#cb152-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> country, <span class="at">y =</span> pop)) <span class="sc">+</span></span>
<span id="cb152-5"><a href="data-visualization-in-r.html#cb152-5" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb152-6"><a href="data-visualization-in-r.html#cb152-6" tabindex="-1"></a>  <span class="fu">coord_flip</span>()  <span class="co"># Flip coordinates for better readability</span></span></code></pre></div>
<p><img src="06-tidyverse-data-visualization_files/figure-html/bar-plots-1.png" width="672" /></p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="data-visualization-in-r.html#cb153-1" tabindex="-1"></a><span class="co"># geom_bar: counts observations</span></span>
<span id="cb153-2"><a href="data-visualization-in-r.html#cb153-2" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb153-3"><a href="data-visualization-in-r.html#cb153-3" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span></span>
<span id="cb153-4"><a href="data-visualization-in-r.html#cb153-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> continent)) <span class="sc">+</span></span>
<span id="cb153-5"><a href="data-visualization-in-r.html#cb153-5" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code></pre></div>
<p><img src="06-tidyverse-data-visualization_files/figure-html/bar-plots-2.png" width="672" /></p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="data-visualization-in-r.html#cb154-1" tabindex="-1"></a><span class="co"># Stacked bar chart</span></span>
<span id="cb154-2"><a href="data-visualization-in-r.html#cb154-2" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb154-3"><a href="data-visualization-in-r.html#cb154-3" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1997</span>, <span class="dv">2007</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb154-4"><a href="data-visualization-in-r.html#cb154-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">year =</span> <span class="fu">as.factor</span>(year)) <span class="sc">%&gt;%</span></span>
<span id="cb154-5"><a href="data-visualization-in-r.html#cb154-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> continent, <span class="at">fill =</span> year)) <span class="sc">+</span></span>
<span id="cb154-6"><a href="data-visualization-in-r.html#cb154-6" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">position =</span> <span class="st">&quot;stack&quot;</span>)</span></code></pre></div>
<p><img src="06-tidyverse-data-visualization_files/figure-html/bar-plots-3.png" width="672" /></p>
</div>
<div id="histograms-with-geom_histogram" class="section level3 hasAnchor" number="6.2.4">
<h3><span class="header-section-number">6.2.4</span> Histograms with <code>geom_histogram()</code><a href="data-visualization-in-r.html#histograms-with-geom_histogram" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="data-visualization-in-r.html#cb155-1" tabindex="-1"></a><span class="co"># Basic histogram</span></span>
<span id="cb155-2"><a href="data-visualization-in-r.html#cb155-2" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb155-3"><a href="data-visualization-in-r.html#cb155-3" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span></span>
<span id="cb155-4"><a href="data-visualization-in-r.html#cb155-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb155-5"><a href="data-visualization-in-r.html#cb155-5" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>, <span class="at">fill =</span> <span class="st">&quot;skyblue&quot;</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="06-tidyverse-data-visualization_files/figure-html/histograms-1.png" width="672" /></p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="data-visualization-in-r.html#cb156-1" tabindex="-1"></a><span class="co"># Histogram with different binwidths</span></span>
<span id="cb156-2"><a href="data-visualization-in-r.html#cb156-2" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb156-3"><a href="data-visualization-in-r.html#cb156-3" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span></span>
<span id="cb156-4"><a href="data-visualization-in-r.html#cb156-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gdpPercap)) <span class="sc">+</span></span>
<span id="cb156-5"><a href="data-visualization-in-r.html#cb156-5" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5000</span>, <span class="at">fill =</span> <span class="st">&quot;lightgreen&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>)</span></code></pre></div>
<p><img src="06-tidyverse-data-visualization_files/figure-html/histograms-2.png" width="672" /></p>
</div>
<div id="box-plots-with-geom_boxplot" class="section level3 hasAnchor" number="6.2.5">
<h3><span class="header-section-number">6.2.5</span> Box Plots with <code>geom_boxplot()</code><a href="data-visualization-in-r.html#box-plots-with-geom_boxplot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="data-visualization-in-r.html#cb157-1" tabindex="-1"></a><span class="co"># Basic box plot</span></span>
<span id="cb157-2"><a href="data-visualization-in-r.html#cb157-2" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb157-3"><a href="data-visualization-in-r.html#cb157-3" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span></span>
<span id="cb157-4"><a href="data-visualization-in-r.html#cb157-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> continent, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb157-5"><a href="data-visualization-in-r.html#cb157-5" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span></code></pre></div>
<p><img src="06-tidyverse-data-visualization_files/figure-html/boxplots-1.png" width="672" /></p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="data-visualization-in-r.html#cb158-1" tabindex="-1"></a><span class="co"># Box plot with jittered points</span></span>
<span id="cb158-2"><a href="data-visualization-in-r.html#cb158-2" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb158-3"><a href="data-visualization-in-r.html#cb158-3" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span></span>
<span id="cb158-4"><a href="data-visualization-in-r.html#cb158-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> continent, <span class="at">y =</span> lifeExp, <span class="at">fill =</span> continent)) <span class="sc">+</span></span>
<span id="cb158-5"><a href="data-visualization-in-r.html#cb158-5" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb158-6"><a href="data-visualization-in-r.html#cb158-6" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width =</span> <span class="fl">0.2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="06-tidyverse-data-visualization_files/figure-html/boxplots-2.png" width="672" /></p>
</div>
</div>
<div id="aesthetic-mappings" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Aesthetic Mappings<a href="data-visualization-in-r.html#aesthetic-mappings" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="understanding-aes" class="section level3 hasAnchor" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Understanding <code>aes()</code><a href="data-visualization-in-r.html#understanding-aes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Aesthetics map variables to visual properties. You can set them globally (in <code>ggplot()</code>) or locally (in individual <code>geom</code> functions):</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="data-visualization-in-r.html#cb159-1" tabindex="-1"></a><span class="co"># Global aesthetic mappings</span></span>
<span id="cb159-2"><a href="data-visualization-in-r.html#cb159-2" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb159-3"><a href="data-visualization-in-r.html#cb159-3" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span></span>
<span id="cb159-4"><a href="data-visualization-in-r.html#cb159-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp, <span class="at">color =</span> continent, <span class="at">size =</span> pop)) <span class="sc">+</span></span>
<span id="cb159-5"><a href="data-visualization-in-r.html#cb159-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>)</span></code></pre></div>
<p><img src="06-tidyverse-data-visualization_files/figure-html/aesthetics-1.png" width="672" /></p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="data-visualization-in-r.html#cb160-1" tabindex="-1"></a><span class="co"># Local aesthetic mappings</span></span>
<span id="cb160-2"><a href="data-visualization-in-r.html#cb160-2" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb160-3"><a href="data-visualization-in-r.html#cb160-3" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span></span>
<span id="cb160-4"><a href="data-visualization-in-r.html#cb160-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb160-5"><a href="data-visualization-in-r.html#cb160-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> continent, <span class="at">size =</span> pop), <span class="at">alpha =</span> <span class="fl">0.7</span>)</span></code></pre></div>
<p><img src="06-tidyverse-data-visualization_files/figure-html/aesthetics-2.png" width="672" /></p>
</div>
<div id="fixed-vs.-mapped-aesthetics" class="section level3 hasAnchor" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> Fixed vs. Mapped Aesthetics<a href="data-visualization-in-r.html#fixed-vs.-mapped-aesthetics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="data-visualization-in-r.html#cb161-1" tabindex="-1"></a><span class="co"># WRONG: color inside aes() when you want a fixed color</span></span>
<span id="cb161-2"><a href="data-visualization-in-r.html#cb161-2" tabindex="-1"></a><span class="co"># This creates a legend with one color</span></span>
<span id="cb161-3"><a href="data-visualization-in-r.html#cb161-3" tabindex="-1"></a><span class="fu">ggplot</span>(gapminder, <span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>)) <span class="sc">+</span></span>
<span id="cb161-4"><a href="data-visualization-in-r.html#cb161-4" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="06-tidyverse-data-visualization_files/figure-html/fixed-vs-mapped-1.png" width="672" /></p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="data-visualization-in-r.html#cb162-1" tabindex="-1"></a><span class="co"># CORRECT: fixed color outside aes()</span></span>
<span id="cb162-2"><a href="data-visualization-in-r.html#cb162-2" tabindex="-1"></a><span class="fu">ggplot</span>(gapminder, <span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb162-3"><a href="data-visualization-in-r.html#cb162-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="06-tidyverse-data-visualization_files/figure-html/fixed-vs-mapped-2.png" width="672" /></p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="data-visualization-in-r.html#cb163-1" tabindex="-1"></a><span class="co"># CORRECT: mapped color inside aes()</span></span>
<span id="cb163-2"><a href="data-visualization-in-r.html#cb163-2" tabindex="-1"></a><span class="fu">ggplot</span>(gapminder, <span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp, <span class="at">color =</span> continent)) <span class="sc">+</span></span>
<span id="cb163-3"><a href="data-visualization-in-r.html#cb163-3" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="06-tidyverse-data-visualization_files/figure-html/fixed-vs-mapped-3.png" width="672" /></p>
</div>
</div>
<div id="faceting-small-multiples" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Faceting: Small Multiples<a href="data-visualization-in-r.html#faceting-small-multiples" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="facet_wrap" class="section level3 hasAnchor" number="6.4.1">
<h3><span class="header-section-number">6.4.1</span> <code>facet_wrap()</code><a href="data-visualization-in-r.html#facet_wrap" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="data-visualization-in-r.html#cb164-1" tabindex="-1"></a><span class="co"># Facet by one variable</span></span>
<span id="cb164-2"><a href="data-visualization-in-r.html#cb164-2" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb164-3"><a href="data-visualization-in-r.html#cb164-3" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1977</span>, <span class="dv">1987</span>, <span class="dv">1997</span>, <span class="dv">2007</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb164-4"><a href="data-visualization-in-r.html#cb164-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp, <span class="at">color =</span> continent)) <span class="sc">+</span></span>
<span id="cb164-5"><a href="data-visualization-in-r.html#cb164-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb164-6"><a href="data-visualization-in-r.html#cb164-6" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> year)</span></code></pre></div>
<p><img src="06-tidyverse-data-visualization_files/figure-html/facet-wrap-1.png" width="672" /></p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="data-visualization-in-r.html#cb165-1" tabindex="-1"></a><span class="co"># Control facet layout</span></span>
<span id="cb165-2"><a href="data-visualization-in-r.html#cb165-2" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb165-3"><a href="data-visualization-in-r.html#cb165-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> lifeExp, <span class="at">group =</span> country)) <span class="sc">+</span></span>
<span id="cb165-4"><a href="data-visualization-in-r.html#cb165-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb165-5"><a href="data-visualization-in-r.html#cb165-5" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> continent, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="06-tidyverse-data-visualization_files/figure-html/facet-wrap-2.png" width="672" /></p>
</div>
<div id="facet_grid" class="section level3 hasAnchor" number="6.4.2">
<h3><span class="header-section-number">6.4.2</span> <code>facet_grid()</code><a href="data-visualization-in-r.html#facet_grid" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="data-visualization-in-r.html#cb166-1" tabindex="-1"></a><span class="co"># Facet by two variables</span></span>
<span id="cb166-2"><a href="data-visualization-in-r.html#cb166-2" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb166-3"><a href="data-visualization-in-r.html#cb166-3" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1997</span>, <span class="dv">2007</span>), </span>
<span id="cb166-4"><a href="data-visualization-in-r.html#cb166-4" tabindex="-1"></a>         continent <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Americas&quot;</span>, <span class="st">&quot;Europe&quot;</span>, <span class="st">&quot;Asia&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb166-5"><a href="data-visualization-in-r.html#cb166-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pop_category =</span> <span class="fu">ifelse</span>(pop <span class="sc">&gt;</span> <span class="dv">50000000</span>, <span class="st">&quot;Large&quot;</span>, <span class="st">&quot;Small&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb166-6"><a href="data-visualization-in-r.html#cb166-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp, <span class="at">color =</span> continent)) <span class="sc">+</span></span>
<span id="cb166-7"><a href="data-visualization-in-r.html#cb166-7" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb166-8"><a href="data-visualization-in-r.html#cb166-8" tabindex="-1"></a>  <span class="fu">facet_grid</span>(pop_category <span class="sc">~</span> year)</span></code></pre></div>
<p><img src="06-tidyverse-data-visualization_files/figure-html/facet-grid-1.png" width="672" /></p>
</div>
</div>
<div id="statistical-transformations" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> Statistical Transformations<a href="data-visualization-in-r.html#statistical-transformations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="smooth-lines-with-geom_smooth" class="section level3 hasAnchor" number="6.5.1">
<h3><span class="header-section-number">6.5.1</span> Smooth Lines with <code>geom_smooth()</code><a href="data-visualization-in-r.html#smooth-lines-with-geom_smooth" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="data-visualization-in-r.html#cb167-1" tabindex="-1"></a><span class="co"># Add trend line</span></span>
<span id="cb167-2"><a href="data-visualization-in-r.html#cb167-2" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb167-3"><a href="data-visualization-in-r.html#cb167-3" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span></span>
<span id="cb167-4"><a href="data-visualization-in-r.html#cb167-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb167-5"><a href="data-visualization-in-r.html#cb167-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> continent), <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb167-6"><a href="data-visualization-in-r.html#cb167-6" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="06-tidyverse-data-visualization_files/figure-html/smooth-lines-1.png" width="672" /></p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="data-visualization-in-r.html#cb169-1" tabindex="-1"></a><span class="co"># Separate trend lines by group</span></span>
<span id="cb169-2"><a href="data-visualization-in-r.html#cb169-2" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb169-3"><a href="data-visualization-in-r.html#cb169-3" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span></span>
<span id="cb169-4"><a href="data-visualization-in-r.html#cb169-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp, <span class="at">color =</span> continent)) <span class="sc">+</span></span>
<span id="cb169-5"><a href="data-visualization-in-r.html#cb169-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb169-6"><a href="data-visualization-in-r.html#cb169-6" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="06-tidyverse-data-visualization_files/figure-html/smooth-lines-2.png" width="672" /></p>
</div>
<div id="statistical-summaries" class="section level3 hasAnchor" number="6.5.2">
<h3><span class="header-section-number">6.5.2</span> Statistical Summaries<a href="data-visualization-in-r.html#statistical-summaries" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="data-visualization-in-r.html#cb171-1" tabindex="-1"></a><span class="co"># stat_summary for custom statistics</span></span>
<span id="cb171-2"><a href="data-visualization-in-r.html#cb171-2" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb171-3"><a href="data-visualization-in-r.html#cb171-3" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span></span>
<span id="cb171-4"><a href="data-visualization-in-r.html#cb171-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> continent, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb171-5"><a href="data-visualization-in-r.html#cb171-5" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> mean, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb171-6"><a href="data-visualization-in-r.html#cb171-6" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> mean_se, <span class="at">geom =</span> <span class="st">&quot;errorbar&quot;</span>, <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb171-7"><a href="data-visualization-in-r.html#cb171-7" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">width =</span> <span class="fl">0.2</span>)</span></code></pre></div>
<p><img src="06-tidyverse-data-visualization_files/figure-html/stat-summaries-1.png" width="672" /></p>
</div>
</div>
<div id="scales-controlling-aesthetic-mappings" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> Scales: Controlling Aesthetic Mappings<a href="data-visualization-in-r.html#scales-controlling-aesthetic-mappings" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="color-scales" class="section level3 hasAnchor" number="6.6.1">
<h3><span class="header-section-number">6.6.1</span> Color Scales<a href="data-visualization-in-r.html#color-scales" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="data-visualization-in-r.html#cb172-1" tabindex="-1"></a><span class="co"># Manual color scale</span></span>
<span id="cb172-2"><a href="data-visualization-in-r.html#cb172-2" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb172-3"><a href="data-visualization-in-r.html#cb172-3" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span></span>
<span id="cb172-4"><a href="data-visualization-in-r.html#cb172-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp, <span class="at">color =</span> continent)) <span class="sc">+</span></span>
<span id="cb172-5"><a href="data-visualization-in-r.html#cb172-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb172-6"><a href="data-visualization-in-r.html#cb172-6" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Africa&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>, <span class="st">&quot;Americas&quot;</span> <span class="ot">=</span> <span class="st">&quot;blue&quot;</span>, </span>
<span id="cb172-7"><a href="data-visualization-in-r.html#cb172-7" tabindex="-1"></a>                               <span class="st">&quot;Asia&quot;</span> <span class="ot">=</span> <span class="st">&quot;green&quot;</span>, <span class="st">&quot;Europe&quot;</span> <span class="ot">=</span> <span class="st">&quot;orange&quot;</span>, </span>
<span id="cb172-8"><a href="data-visualization-in-r.html#cb172-8" tabindex="-1"></a>                               <span class="st">&quot;Oceania&quot;</span> <span class="ot">=</span> <span class="st">&quot;purple&quot;</span>))</span></code></pre></div>
<p><img src="06-tidyverse-data-visualization_files/figure-html/color-scales-1.png" width="672" /></p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="data-visualization-in-r.html#cb173-1" tabindex="-1"></a><span class="co"># Brewer color palette</span></span>
<span id="cb173-2"><a href="data-visualization-in-r.html#cb173-2" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb173-3"><a href="data-visualization-in-r.html#cb173-3" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span></span>
<span id="cb173-4"><a href="data-visualization-in-r.html#cb173-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp, <span class="at">color =</span> continent)) <span class="sc">+</span></span>
<span id="cb173-5"><a href="data-visualization-in-r.html#cb173-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb173-6"><a href="data-visualization-in-r.html#cb173-6" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">type =</span> <span class="st">&quot;qual&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Set2&quot;</span>)</span></code></pre></div>
<p><img src="06-tidyverse-data-visualization_files/figure-html/color-scales-2.png" width="672" /></p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="data-visualization-in-r.html#cb174-1" tabindex="-1"></a><span class="co"># Viridis color palette</span></span>
<span id="cb174-2"><a href="data-visualization-in-r.html#cb174-2" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb174-3"><a href="data-visualization-in-r.html#cb174-3" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span></span>
<span id="cb174-4"><a href="data-visualization-in-r.html#cb174-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp, <span class="at">color =</span> pop)) <span class="sc">+</span></span>
<span id="cb174-5"><a href="data-visualization-in-r.html#cb174-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb174-6"><a href="data-visualization-in-r.html#cb174-6" tabindex="-1"></a>  <span class="fu">scale_color_viridis_c</span>()</span></code></pre></div>
<p><img src="06-tidyverse-data-visualization_files/figure-html/color-scales-3.png" width="672" /></p>
</div>
<div id="axis-scales" class="section level3 hasAnchor" number="6.6.2">
<h3><span class="header-section-number">6.6.2</span> Axis Scales<a href="data-visualization-in-r.html#axis-scales" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="data-visualization-in-r.html#cb175-1" tabindex="-1"></a><span class="co"># Log scale for x-axis</span></span>
<span id="cb175-2"><a href="data-visualization-in-r.html#cb175-2" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb175-3"><a href="data-visualization-in-r.html#cb175-3" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span></span>
<span id="cb175-4"><a href="data-visualization-in-r.html#cb175-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp, <span class="at">color =</span> continent)) <span class="sc">+</span></span>
<span id="cb175-5"><a href="data-visualization-in-r.html#cb175-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb175-6"><a href="data-visualization-in-r.html#cb175-6" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>()</span></code></pre></div>
<p><img src="06-tidyverse-data-visualization_files/figure-html/axis-scales-1.png" width="672" /></p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="data-visualization-in-r.html#cb176-1" tabindex="-1"></a><span class="co"># Custom breaks and labels</span></span>
<span id="cb176-2"><a href="data-visualization-in-r.html#cb176-2" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb176-3"><a href="data-visualization-in-r.html#cb176-3" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span></span>
<span id="cb176-4"><a href="data-visualization-in-r.html#cb176-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp, <span class="at">color =</span> continent)) <span class="sc">+</span></span>
<span id="cb176-5"><a href="data-visualization-in-r.html#cb176-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb176-6"><a href="data-visualization-in-r.html#cb176-6" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">50000</span>, <span class="dv">10000</span>),</span>
<span id="cb176-7"><a href="data-visualization-in-r.html#cb176-7" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">paste0</span>(<span class="st">&quot;$&quot;</span>, <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">50</span>, <span class="dv">10</span>), <span class="st">&quot;K&quot;</span>))</span></code></pre></div>
<p><img src="06-tidyverse-data-visualization_files/figure-html/axis-scales-2.png" width="672" /></p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="data-visualization-in-r.html#cb177-1" tabindex="-1"></a><span class="co"># Limit axis ranges</span></span>
<span id="cb177-2"><a href="data-visualization-in-r.html#cb177-2" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb177-3"><a href="data-visualization-in-r.html#cb177-3" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span></span>
<span id="cb177-4"><a href="data-visualization-in-r.html#cb177-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp, <span class="at">color =</span> continent)) <span class="sc">+</span></span>
<span id="cb177-5"><a href="data-visualization-in-r.html#cb177-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb177-6"><a href="data-visualization-in-r.html#cb177-6" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">30000</span>) <span class="sc">+</span></span>
<span id="cb177-7"><a href="data-visualization-in-r.html#cb177-7" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">40</span>, <span class="dv">85</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 21 rows containing missing values or values outside the scale range
## (`geom_point()`).</code></pre>
<p><img src="06-tidyverse-data-visualization_files/figure-html/axis-scales-3.png" width="672" /></p>
</div>
</div>
<div id="coordinates-and-transformations" class="section level2 hasAnchor" number="6.7">
<h2><span class="header-section-number">6.7</span> Coordinates and Transformations<a href="data-visualization-in-r.html#coordinates-and-transformations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="data-visualization-in-r.html#cb179-1" tabindex="-1"></a><span class="co"># Flip coordinates</span></span>
<span id="cb179-2"><a href="data-visualization-in-r.html#cb179-2" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb179-3"><a href="data-visualization-in-r.html#cb179-3" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>, continent <span class="sc">==</span> <span class="st">&quot;Europe&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb179-4"><a href="data-visualization-in-r.html#cb179-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(country, lifeExp), <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb179-5"><a href="data-visualization-in-r.html#cb179-5" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb179-6"><a href="data-visualization-in-r.html#cb179-6" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="06-tidyverse-data-visualization_files/figure-html/coordinates-1.png" width="672" /></p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="data-visualization-in-r.html#cb180-1" tabindex="-1"></a><span class="co"># Polar coordinates (for pie charts)</span></span>
<span id="cb180-2"><a href="data-visualization-in-r.html#cb180-2" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb180-3"><a href="data-visualization-in-r.html#cb180-3" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span></span>
<span id="cb180-4"><a href="data-visualization-in-r.html#cb180-4" tabindex="-1"></a>  <span class="fu">count</span>(continent) <span class="sc">%&gt;%</span></span>
<span id="cb180-5"><a href="data-visualization-in-r.html#cb180-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y =</span> n, <span class="at">fill =</span> continent)) <span class="sc">+</span></span>
<span id="cb180-6"><a href="data-visualization-in-r.html#cb180-6" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span></span>
<span id="cb180-7"><a href="data-visualization-in-r.html#cb180-7" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="at">theta =</span> <span class="st">&quot;y&quot;</span>)</span></code></pre></div>
<p><img src="06-tidyverse-data-visualization_files/figure-html/coordinates-2.png" width="672" /></p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="data-visualization-in-r.html#cb181-1" tabindex="-1"></a><span class="co"># Fixed aspect ratio</span></span>
<span id="cb181-2"><a href="data-visualization-in-r.html#cb181-2" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb181-3"><a href="data-visualization-in-r.html#cb181-3" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span></span>
<span id="cb181-4"><a href="data-visualization-in-r.html#cb181-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb181-5"><a href="data-visualization-in-r.html#cb181-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb181-6"><a href="data-visualization-in-r.html#cb181-6" tabindex="-1"></a>  <span class="fu">coord_fixed</span>(<span class="at">ratio =</span> <span class="dv">300</span>)  <span class="co"># 300 GDP per capita = 1 year life expectancy</span></span></code></pre></div>
<p><img src="06-tidyverse-data-visualization_files/figure-html/coordinates-3.png" width="672" /></p>
</div>
<div id="labels-and-themes" class="section level2 hasAnchor" number="6.8">
<h2><span class="header-section-number">6.8</span> Labels and Themes<a href="data-visualization-in-r.html#labels-and-themes" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="adding-labels" class="section level3 hasAnchor" number="6.8.1">
<h3><span class="header-section-number">6.8.1</span> Adding Labels<a href="data-visualization-in-r.html#adding-labels" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="data-visualization-in-r.html#cb182-1" tabindex="-1"></a><span class="co"># Basic labels</span></span>
<span id="cb182-2"><a href="data-visualization-in-r.html#cb182-2" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb182-3"><a href="data-visualization-in-r.html#cb182-3" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span></span>
<span id="cb182-4"><a href="data-visualization-in-r.html#cb182-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp, <span class="at">color =</span> continent)) <span class="sc">+</span></span>
<span id="cb182-5"><a href="data-visualization-in-r.html#cb182-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb182-6"><a href="data-visualization-in-r.html#cb182-6" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb182-7"><a href="data-visualization-in-r.html#cb182-7" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Life Expectancy vs GDP Per Capita (2007)&quot;</span>,</span>
<span id="cb182-8"><a href="data-visualization-in-r.html#cb182-8" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Each point represents a country&quot;</span>,</span>
<span id="cb182-9"><a href="data-visualization-in-r.html#cb182-9" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;GDP per capita (USD)&quot;</span>,</span>
<span id="cb182-10"><a href="data-visualization-in-r.html#cb182-10" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Life expectancy (years)&quot;</span>,</span>
<span id="cb182-11"><a href="data-visualization-in-r.html#cb182-11" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Continent&quot;</span>,</span>
<span id="cb182-12"><a href="data-visualization-in-r.html#cb182-12" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">&quot;Data source: Gapminder&quot;</span></span>
<span id="cb182-13"><a href="data-visualization-in-r.html#cb182-13" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="06-tidyverse-data-visualization_files/figure-html/labels-1.png" width="672" /></p>
</div>
<div id="theme-customization" class="section level3 hasAnchor" number="6.8.2">
<h3><span class="header-section-number">6.8.2</span> Theme Customization<a href="data-visualization-in-r.html#theme-customization" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="data-visualization-in-r.html#cb183-1" tabindex="-1"></a><span class="co"># Built-in themes</span></span>
<span id="cb183-2"><a href="data-visualization-in-r.html#cb183-2" tabindex="-1"></a>p <span class="ot">&lt;-</span> gapminder <span class="sc">%&gt;%</span></span>
<span id="cb183-3"><a href="data-visualization-in-r.html#cb183-3" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span></span>
<span id="cb183-4"><a href="data-visualization-in-r.html#cb183-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp, <span class="at">color =</span> continent)) <span class="sc">+</span></span>
<span id="cb183-5"><a href="data-visualization-in-r.html#cb183-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>)</span>
<span id="cb183-6"><a href="data-visualization-in-r.html#cb183-6" tabindex="-1"></a></span>
<span id="cb183-7"><a href="data-visualization-in-r.html#cb183-7" tabindex="-1"></a><span class="co"># Different theme options</span></span>
<span id="cb183-8"><a href="data-visualization-in-r.html#cb183-8" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_minimal</span>()</span></code></pre></div>
<p><img src="06-tidyverse-data-visualization_files/figure-html/themes-1.png" width="672" /></p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="data-visualization-in-r.html#cb184-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="06-tidyverse-data-visualization_files/figure-html/themes-2.png" width="672" /></p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="data-visualization-in-r.html#cb185-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_dark</span>()</span></code></pre></div>
<p><img src="06-tidyverse-data-visualization_files/figure-html/themes-3.png" width="672" /></p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="data-visualization-in-r.html#cb186-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">theme_void</span>()</span></code></pre></div>
<p><img src="06-tidyverse-data-visualization_files/figure-html/themes-4.png" width="672" /></p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="data-visualization-in-r.html#cb187-1" tabindex="-1"></a><span class="co"># Custom theme modifications</span></span>
<span id="cb187-2"><a href="data-visualization-in-r.html#cb187-2" tabindex="-1"></a>p <span class="sc">+</span></span>
<span id="cb187-3"><a href="data-visualization-in-r.html#cb187-3" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb187-4"><a href="data-visualization-in-r.html#cb187-4" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb187-5"><a href="data-visualization-in-r.html#cb187-5" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">16</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb187-6"><a href="data-visualization-in-r.html#cb187-6" tabindex="-1"></a>    <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb187-7"><a href="data-visualization-in-r.html#cb187-7" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb187-8"><a href="data-visualization-in-r.html#cb187-8" tabindex="-1"></a>    <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()</span>
<span id="cb187-9"><a href="data-visualization-in-r.html#cb187-9" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="06-tidyverse-data-visualization_files/figure-html/themes-5.png" width="672" /></p>
</div>
</div>
<div id="heatmaps" class="section level2 hasAnchor" number="6.9">
<h2><span class="header-section-number">6.9</span> Heatmaps<a href="data-visualization-in-r.html#heatmaps" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Coming soon …</p>
</div>
<div id="combining-multiple-geoms" class="section level2 hasAnchor" number="6.10">
<h2><span class="header-section-number">6.10</span> Combining Multiple Geoms<a href="data-visualization-in-r.html#combining-multiple-geoms" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="data-visualization-in-r.html#cb188-1" tabindex="-1"></a><span class="co"># Combining points and lines</span></span>
<span id="cb188-2"><a href="data-visualization-in-r.html#cb188-2" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb188-3"><a href="data-visualization-in-r.html#cb188-3" tabindex="-1"></a>  <span class="fu">filter</span>(continent <span class="sc">==</span> <span class="st">&quot;Americas&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb188-4"><a href="data-visualization-in-r.html#cb188-4" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb188-5"><a href="data-visualization-in-r.html#cb188-5" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avg_life_exp =</span> <span class="fu">mean</span>(lifeExp), <span class="at">.groups =</span> <span class="st">&#39;drop&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb188-6"><a href="data-visualization-in-r.html#cb188-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> avg_life_exp)) <span class="sc">+</span></span>
<span id="cb188-7"><a href="data-visualization-in-r.html#cb188-7" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.2</span>, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb188-8"><a href="data-visualization-in-r.html#cb188-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>) <span class="sc">+</span></span>
<span id="cb188-9"><a href="data-visualization-in-r.html#cb188-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Average Life Expectancy in Americas Over Time&quot;</span>,</span>
<span id="cb188-10"><a href="data-visualization-in-r.html#cb188-10" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Average Life Expectancy&quot;</span>)</span></code></pre></div>
<p><img src="06-tidyverse-data-visualization_files/figure-html/multiple-geoms-1.png" width="672" /></p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="data-visualization-in-r.html#cb189-1" tabindex="-1"></a><span class="co"># Error bars with points</span></span>
<span id="cb189-2"><a href="data-visualization-in-r.html#cb189-2" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb189-3"><a href="data-visualization-in-r.html#cb189-3" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>) <span class="sc">%&gt;%</span></span>
<span id="cb189-4"><a href="data-visualization-in-r.html#cb189-4" tabindex="-1"></a>  <span class="fu">group_by</span>(continent) <span class="sc">%&gt;%</span></span>
<span id="cb189-5"><a href="data-visualization-in-r.html#cb189-5" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb189-6"><a href="data-visualization-in-r.html#cb189-6" tabindex="-1"></a>    <span class="at">mean_life =</span> <span class="fu">mean</span>(lifeExp),</span>
<span id="cb189-7"><a href="data-visualization-in-r.html#cb189-7" tabindex="-1"></a>    <span class="at">se_life =</span> <span class="fu">sd</span>(lifeExp) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">n</span>()),</span>
<span id="cb189-8"><a href="data-visualization-in-r.html#cb189-8" tabindex="-1"></a>    <span class="at">.groups =</span> <span class="st">&#39;drop&#39;</span></span>
<span id="cb189-9"><a href="data-visualization-in-r.html#cb189-9" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb189-10"><a href="data-visualization-in-r.html#cb189-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> continent, <span class="at">y =</span> mean_life)) <span class="sc">+</span></span>
<span id="cb189-11"><a href="data-visualization-in-r.html#cb189-11" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb189-12"><a href="data-visualization-in-r.html#cb189-12" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin =</span> mean_life <span class="sc">-</span> se_life, </span>
<span id="cb189-13"><a href="data-visualization-in-r.html#cb189-13" tabindex="-1"></a>                   <span class="at">ymax =</span> mean_life <span class="sc">+</span> se_life),</span>
<span id="cb189-14"><a href="data-visualization-in-r.html#cb189-14" tabindex="-1"></a>                <span class="at">width =</span> <span class="fl">0.2</span>)</span></code></pre></div>
<p><img src="06-tidyverse-data-visualization_files/figure-html/multiple-geoms-2.png" width="672" /></p>
</div>
<div id="text-and-annotations" class="section level2 hasAnchor" number="6.11">
<h2><span class="header-section-number">6.11</span> Text and Annotations<a href="data-visualization-in-r.html#text-and-annotations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="data-visualization-in-r.html#cb190-1" tabindex="-1"></a><span class="co"># Add text labels to points</span></span>
<span id="cb190-2"><a href="data-visualization-in-r.html#cb190-2" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb190-3"><a href="data-visualization-in-r.html#cb190-3" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>, continent <span class="sc">==</span> <span class="st">&quot;Europe&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb190-4"><a href="data-visualization-in-r.html#cb190-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb190-5"><a href="data-visualization-in-r.html#cb190-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb190-6"><a href="data-visualization-in-r.html#cb190-6" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> country), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">hjust =</span> <span class="sc">-</span><span class="fl">0.1</span>)</span></code></pre></div>
<p><img src="06-tidyverse-data-visualization_files/figure-html/text-annotations-1.png" width="672" /></p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="data-visualization-in-r.html#cb191-1" tabindex="-1"></a><span class="co"># Better: use geom_text_repel to avoid overlapping</span></span>
<span id="cb191-2"><a href="data-visualization-in-r.html#cb191-2" tabindex="-1"></a><span class="fu">library</span>(ggrepel)</span>
<span id="cb191-3"><a href="data-visualization-in-r.html#cb191-3" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb191-4"><a href="data-visualization-in-r.html#cb191-4" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">==</span> <span class="dv">2007</span>, continent <span class="sc">==</span> <span class="st">&quot;Europe&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb191-5"><a href="data-visualization-in-r.html#cb191-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb191-6"><a href="data-visualization-in-r.html#cb191-6" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb191-7"><a href="data-visualization-in-r.html#cb191-7" tabindex="-1"></a>  <span class="fu">geom_text_repel</span>(<span class="fu">aes</span>(<span class="at">label =</span> country), <span class="at">size =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="06-tidyverse-data-visualization_files/figure-html/text-annotations-2.png" width="672" /></p>
</div>
<div id="practical-example-complex-multi-layered-plot" class="section level2 hasAnchor" number="6.12">
<h2><span class="header-section-number">6.12</span> Practical Example: Complex Multi-layered Plot<a href="data-visualization-in-r.html#practical-example-complex-multi-layered-plot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="data-visualization-in-r.html#cb192-1" tabindex="-1"></a><span class="co"># Complex visualization combining multiple elements</span></span>
<span id="cb192-2"><a href="data-visualization-in-r.html#cb192-2" tabindex="-1"></a>complex_plot <span class="ot">&lt;-</span> gapminder <span class="sc">%&gt;%</span></span>
<span id="cb192-3"><a href="data-visualization-in-r.html#cb192-3" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1977</span>, <span class="dv">1987</span>, <span class="dv">1997</span>, <span class="dv">2007</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb192-4"><a href="data-visualization-in-r.html#cb192-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> gdpPercap, <span class="at">y =</span> lifeExp)) <span class="sc">+</span></span>
<span id="cb192-5"><a href="data-visualization-in-r.html#cb192-5" tabindex="-1"></a>  </span>
<span id="cb192-6"><a href="data-visualization-in-r.html#cb192-6" tabindex="-1"></a>  <span class="co"># Add points with continent color and population size</span></span>
<span id="cb192-7"><a href="data-visualization-in-r.html#cb192-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> continent, <span class="at">size =</span> pop), <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb192-8"><a href="data-visualization-in-r.html#cb192-8" tabindex="-1"></a>  </span>
<span id="cb192-9"><a href="data-visualization-in-r.html#cb192-9" tabindex="-1"></a>  <span class="co"># Add trend line</span></span>
<span id="cb192-10"><a href="data-visualization-in-r.html#cb192-10" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb192-11"><a href="data-visualization-in-r.html#cb192-11" tabindex="-1"></a>  </span>
<span id="cb192-12"><a href="data-visualization-in-r.html#cb192-12" tabindex="-1"></a>  <span class="co"># Facet by year</span></span>
<span id="cb192-13"><a href="data-visualization-in-r.html#cb192-13" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> year, <span class="at">nrow =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb192-14"><a href="data-visualization-in-r.html#cb192-14" tabindex="-1"></a>  </span>
<span id="cb192-15"><a href="data-visualization-in-r.html#cb192-15" tabindex="-1"></a>  <span class="co"># Use log scale for x-axis</span></span>
<span id="cb192-16"><a href="data-visualization-in-r.html#cb192-16" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>(<span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">500</span>, <span class="dv">2000</span>, <span class="dv">8000</span>, <span class="dv">32000</span>),</span>
<span id="cb192-17"><a href="data-visualization-in-r.html#cb192-17" tabindex="-1"></a>                <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;$500&quot;</span>, <span class="st">&quot;$2,000&quot;</span>, <span class="st">&quot;$8,000&quot;</span>, <span class="st">&quot;$32,000&quot;</span>)) <span class="sc">+</span></span>
<span id="cb192-18"><a href="data-visualization-in-r.html#cb192-18" tabindex="-1"></a>  </span>
<span id="cb192-19"><a href="data-visualization-in-r.html#cb192-19" tabindex="-1"></a>  <span class="co"># Customize colors</span></span>
<span id="cb192-20"><a href="data-visualization-in-r.html#cb192-20" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">type =</span> <span class="st">&quot;qual&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;Set2&quot;</span>) <span class="sc">+</span></span>
<span id="cb192-21"><a href="data-visualization-in-r.html#cb192-21" tabindex="-1"></a>  </span>
<span id="cb192-22"><a href="data-visualization-in-r.html#cb192-22" tabindex="-1"></a>  <span class="co"># Adjust size scale</span></span>
<span id="cb192-23"><a href="data-visualization-in-r.html#cb192-23" tabindex="-1"></a>  <span class="fu">scale_size_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">8</span>), <span class="at">guide =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span></span>
<span id="cb192-24"><a href="data-visualization-in-r.html#cb192-24" tabindex="-1"></a>  </span>
<span id="cb192-25"><a href="data-visualization-in-r.html#cb192-25" tabindex="-1"></a>  <span class="co"># Add labels</span></span>
<span id="cb192-26"><a href="data-visualization-in-r.html#cb192-26" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb192-27"><a href="data-visualization-in-r.html#cb192-27" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;The Relationship Between Wealth and Health Over Time&quot;</span>,</span>
<span id="cb192-28"><a href="data-visualization-in-r.html#cb192-28" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;GDP per capita vs Life Expectancy (1977-2007)&quot;</span>,</span>
<span id="cb192-29"><a href="data-visualization-in-r.html#cb192-29" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;GDP per capita (log scale)&quot;</span>,</span>
<span id="cb192-30"><a href="data-visualization-in-r.html#cb192-30" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">&quot;Life expectancy (years)&quot;</span>,</span>
<span id="cb192-31"><a href="data-visualization-in-r.html#cb192-31" tabindex="-1"></a>    <span class="at">color =</span> <span class="st">&quot;Continent&quot;</span>,</span>
<span id="cb192-32"><a href="data-visualization-in-r.html#cb192-32" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">&quot;Point size represents population size. Data: Gapminder&quot;</span></span>
<span id="cb192-33"><a href="data-visualization-in-r.html#cb192-33" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb192-34"><a href="data-visualization-in-r.html#cb192-34" tabindex="-1"></a>  </span>
<span id="cb192-35"><a href="data-visualization-in-r.html#cb192-35" tabindex="-1"></a>  <span class="co"># Customize theme</span></span>
<span id="cb192-36"><a href="data-visualization-in-r.html#cb192-36" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb192-37"><a href="data-visualization-in-r.html#cb192-37" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb192-38"><a href="data-visualization-in-r.html#cb192-38" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb192-39"><a href="data-visualization-in-r.html#cb192-39" tabindex="-1"></a>    <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>),</span>
<span id="cb192-40"><a href="data-visualization-in-r.html#cb192-40" tabindex="-1"></a>    <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>),</span>
<span id="cb192-41"><a href="data-visualization-in-r.html#cb192-41" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span></span>
<span id="cb192-42"><a href="data-visualization-in-r.html#cb192-42" tabindex="-1"></a>  )</span>
<span id="cb192-43"><a href="data-visualization-in-r.html#cb192-43" tabindex="-1"></a></span>
<span id="cb192-44"><a href="data-visualization-in-r.html#cb192-44" tabindex="-1"></a>complex_plot</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="06-tidyverse-data-visualization_files/figure-html/complex-example-1.png" width="672" /></p>
</div>
<div id="ggplot2-function-summary-table" class="section level2 hasAnchor" number="6.13">
<h2><span class="header-section-number">6.13</span> ggplot2 Function Summary Table<a href="data-visualization-in-r.html#ggplot2-function-summary-table" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<table>
<colgroup>
<col width="23%" />
<col width="23%" />
<col width="30%" />
<col width="21%" />
</colgroup>
<thead>
<tr class="header">
<th>Function</th>
<th>Category</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>ggplot()</code></td>
<td>Core</td>
<td>Initialize a plot with data and aesthetics</td>
<td><code>ggplot(data, aes(x = var1, y = var2))</code></td>
</tr>
<tr class="even">
<td><code>aes()</code></td>
<td>Core</td>
<td>Define aesthetic mappings</td>
<td><code>aes(x = gdp, y = life, color = continent)</code></td>
</tr>
<tr class="odd">
<td><code>geom_point()</code></td>
<td>Geoms</td>
<td>Add points (scatter plot)</td>
<td><code>geom_point(size = 2, alpha = 0.7)</code></td>
</tr>
<tr class="even">
<td><code>geom_line()</code></td>
<td>Geoms</td>
<td>Add lines</td>
<td><code>geom_line(size = 1.2)</code></td>
</tr>
<tr class="odd">
<td><code>geom_col()</code></td>
<td>Geoms</td>
<td>Add bars with heights from data</td>
<td><code>geom_col(fill = "blue")</code></td>
</tr>
<tr class="even">
<td><code>geom_bar()</code></td>
<td>Geoms</td>
<td>Add bars that count observations</td>
<td><code>geom_bar()</code></td>
</tr>
<tr class="odd">
<td><code>geom_histogram()</code></td>
<td>Geoms</td>
<td>Add histogram</td>
<td><code>geom_histogram(bins = 20)</code></td>
</tr>
<tr class="even">
<td><code>geom_boxplot()</code></td>
<td>Geoms</td>
<td>Add box plot</td>
<td><code>geom_boxplot()</code></td>
</tr>
<tr class="odd">
<td><code>geom_density()</code></td>
<td>Geoms</td>
<td>Add density curve</td>
<td><code>geom_density(alpha = 0.5)</code></td>
</tr>
<tr class="even">
<td><code>geom_violin()</code></td>
<td>Geoms</td>
<td>Add violin plot</td>
<td><code>geom_violin()</code></td>
</tr>
<tr class="odd">
<td><code>geom_tile()</code></td>
<td>Geoms</td>
<td>Add tiles (heatmap)</td>
<td><code>geom_tile()</code></td>
</tr>
<tr class="even">
<td><code>geom_smooth()</code></td>
<td>Geoms</td>
<td>Add smoothed trend line</td>
<td><code>geom_smooth(method = "lm")</code></td>
</tr>
<tr class="odd">
<td><code>geom_text()</code></td>
<td>Geoms</td>
<td>Add text labels</td>
<td><code>geom_text(aes(label = country))</code></td>
</tr>
<tr class="even">
<td><code>geom_jitter()</code></td>
<td>Geoms</td>
<td>Add jittered points</td>
<td><code>geom_jitter(width = 0.2)</code></td>
</tr>
<tr class="odd">
<td><code>facet_wrap()</code></td>
<td>Facets</td>
<td>Create subplots in a wrapped layout</td>
<td><code>facet_wrap(~ variable)</code></td>
</tr>
<tr class="even">
<td><code>facet_grid()</code></td>
<td>Facets</td>
<td>Create subplots in a grid</td>
<td><code>facet_grid(var1 ~ var2)</code></td>
</tr>
<tr class="odd">
<td><code>scale_x_continuous()</code></td>
<td>Scales</td>
<td>Customize continuous x-axis</td>
<td><code>scale_x_continuous(breaks = c(1,2,3))</code></td>
</tr>
<tr class="even">
<td><code>scale_x_log10()</code></td>
<td>Scales</td>
<td>Use log10 scale for x-axis</td>
<td><code>scale_x_log10()</code></td>
</tr>
<tr class="odd">
<td><code>scale_color_manual()</code></td>
<td>Scales</td>
<td>Manually set colors</td>
<td><code>scale_color_manual(values = c("red", "blue"))</code></td>
</tr>
<tr class="even">
<td><code>scale_color_brewer()</code></td>
<td>Scales</td>
<td>Use ColorBrewer palette</td>
<td><code>scale_color_brewer(palette = "Set2")</code></td>
</tr>
<tr class="odd">
<td><code>scale_color_viridis_c()</code></td>
<td>Scales</td>
<td>Use Viridis color scale (continuous)</td>
<td><code>scale_color_viridis_c()</code></td>
</tr>
<tr class="even">
<td><code>xlim()</code> / <code>ylim()</code></td>
<td>Scales</td>
<td>Set axis limits</td>
<td><code>xlim(0, 100)</code></td>
</tr>
<tr class="odd">
<td><code>coord_flip()</code></td>
<td>Coordinates</td>
<td>Flip x and y coordinates</td>
<td><code>coord_flip()</code></td>
</tr>
<tr class="even">
<td><code>coord_polar()</code></td>
<td>Coordinates</td>
<td>Use polar coordinates</td>
<td><code>coord_polar(theta = "y")</code></td>
</tr>
<tr class="odd">
<td><code>coord_fixed()</code></td>
<td>Coordinates</td>
<td>Fix aspect ratio</td>
<td><code>coord_fixed(ratio = 1)</code></td>
</tr>
<tr class="even">
<td><code>labs()</code></td>
<td>Labels</td>
<td>Add/modify plot labels</td>
<td><code>labs(title = "My Plot", x = "X axis")</code></td>
</tr>
<tr class="odd">
<td><code>ggtitle()</code></td>
<td>Labels</td>
<td>Add plot title</td>
<td><code>ggtitle("My Plot Title")</code></td>
</tr>
<tr class="even">
<td><code>xlab()</code> / <code>ylab()</code></td>
<td>Labels</td>
<td>Add axis labels</td>
<td><code>xlab("X axis label")</code></td>
</tr>
<tr class="odd">
<td><code>theme()</code></td>
<td>Themes</td>
<td>Customize plot appearance</td>
<td><code>theme(legend.position = "bottom")</code></td>
</tr>
<tr class="even">
<td><code>theme_minimal()</code></td>
<td>Themes</td>
<td>Apply minimal theme</td>
<td><code>theme_minimal()</code></td>
</tr>
<tr class="odd">
<td><code>theme_classic()</code></td>
<td>Themes</td>
<td>Apply classic theme</td>
<td><code>theme_classic()</code></td>
</tr>
<tr class="even">
<td><code>theme_dark()</code></td>
<td>Themes</td>
<td>Apply dark theme</td>
<td><code>theme_dark()</code></td>
</tr>
<tr class="odd">
<td><code>annotate()</code></td>
<td>Annotations</td>
<td>Add annotations to plot</td>
<td><code>annotate("text", x = 1, y = 2, label = "Note")</code></td>
</tr>
</tbody>
</table>
</div>
<div id="conclusion-1" class="section level2 hasAnchor" number="6.14">
<h2><span class="header-section-number">6.14</span> Conclusion<a href="data-visualization-in-r.html#conclusion-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>ggplot2’s grammar of graphics provides a powerful and consistent framework for creating visualizations. The key principles to remember are:</p>
<ol style="list-style-type: decimal">
<li><strong>Build plots layer by layer</strong> - start with data and aesthetics, then add geoms, scales, and themes</li>
<li><strong>Map variables to aesthetics</strong> - use <code>aes()</code> to connect your data to visual properties<br />
</li>
<li><strong>Choose appropriate geoms</strong> - different geoms for different types of data and relationships</li>
<li><strong>Use faceting</strong> - create small multiples to show patterns across groups</li>
<li><strong>Customize with scales and themes</strong> - fine-tune appearance and mapping of aesthetic properties</li>
</ol>
<p>By mastering these concepts and functions, you can create publication-ready visualizations that effectively communicate insights from your data.</p>
</div>
<div id="my-favorite-figures-i-ever-made" class="section level2 hasAnchor" number="6.15">
<h2><span class="header-section-number">6.15</span> My favorite figures I ever made<a href="data-visualization-in-r.html#my-favorite-figures-i-ever-made" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>While in my internship, I was able to work with a huge dataset on detected enteroviruses in clinical settings all over Europe. I collected, harmonized, analyzed and visualized all that data which even got published! The first figure displays the number of detections per month throughout the study periods (with summer months in red) (fig A) and the relative intensity of specific virus types. A light color means that in that specific month, that specific enterovirus type was very common (fig B). The second figure shows a classic epicurve per specific virus type (in red) with the total number of detected enteroviruses per month in grey <span class="citation">(Schrijver et al., 2025)</span>.</p>
<div class="float">
<img src="favorite_figure_1.jpeg" alt="Caption text" />
<div class="figcaption">Caption text</div>
</div>
<div class="float">
<img src="favorite_figure_2.png" alt="Caption text" />
<div class="figcaption">Caption text</div>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction-to-the-tidyverse.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="statistics.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/stends2001/EpiBible/blob/main06-tidyverse-data-visualization.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["EpiBible.pdf", "EpiBible.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
