<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 8 Working with epidemiological data | Epibible</title>
  <meta name="description" content="Chapter 8 Working with epidemiological data | Epibible" />
  <meta name="generator" content="bookdown 0.40 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 8 Working with epidemiological data | Epibible" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 8 Working with epidemiological data | Epibible" />
  
  
  

<meta name="author" content="Sten de Schrijver" />


<meta name="date" content="2025-08-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="statistics.html"/>
<link rel="next" href="case-study-dengue-fever-in-brazil.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Epibible</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="about-the-author.html"><a href="about-the-author.html"><i class="fa fa-check"></i>About the Author</a></li>
<li class="chapter" data-level="1" data-path="introduction-to-epidemiology.html"><a href="introduction-to-epidemiology.html"><i class="fa fa-check"></i><b>1</b> Introduction to Epidemiology</a></li>
<li class="chapter" data-level="2" data-path="working-with-this-book.html"><a href="working-with-this-book.html"><i class="fa fa-check"></i><b>2</b> Working with this book</a>
<ul>
<li class="chapter" data-level="2.1" data-path="working-with-this-book.html"><a href="working-with-this-book.html#what-is-bookdown"><i class="fa fa-check"></i><b>2.1</b> What is bookdown?</a></li>
<li class="chapter" data-level="2.2" data-path="working-with-this-book.html"><a href="working-with-this-book.html#what-is-markdown"><i class="fa fa-check"></i><b>2.2</b> What is Markdown</a></li>
<li class="chapter" data-level="2.3" data-path="working-with-this-book.html"><a href="working-with-this-book.html#code-snippets"><i class="fa fa-check"></i><b>2.3</b> Code snippets</a></li>
<li class="chapter" data-level="2.4" data-path="working-with-this-book.html"><a href="working-with-this-book.html#other-formats-in-this-book"><i class="fa fa-check"></i><b>2.4</b> Other formats in this book</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html"><i class="fa fa-check"></i><b>3</b> Getting Started with R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#installing-r-and-rstudio"><i class="fa fa-check"></i><b>3.1</b> Installing R and Rstudio</a></li>
<li class="chapter" data-level="3.2" data-path="getting-started-with-r.html"><a href="getting-started-with-r.html#starting-to-code"><i class="fa fa-check"></i><b>3.2</b> Starting to code</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="r-fundamentals.html"><a href="r-fundamentals.html"><i class="fa fa-check"></i><b>4</b> R fundamentals</a>
<ul>
<li class="chapter" data-level="4.1" data-path="r-fundamentals.html"><a href="r-fundamentals.html#basic-datatypes-in-r"><i class="fa fa-check"></i><b>4.1</b> Basic Datatypes in R</a></li>
<li class="chapter" data-level="4.2" data-path="r-fundamentals.html"><a href="r-fundamentals.html#special-datatypes"><i class="fa fa-check"></i><b>4.2</b> Special datatypes</a></li>
<li class="chapter" data-level="4.3" data-path="r-fundamentals.html"><a href="r-fundamentals.html#converting-between-datatypes"><i class="fa fa-check"></i><b>4.3</b> Converting between datatypes</a></li>
<li class="chapter" data-level="4.4" data-path="r-fundamentals.html"><a href="r-fundamentals.html#data-structures-in-r"><i class="fa fa-check"></i><b>4.4</b> Data structures in R</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="r-fundamentals.html"><a href="r-fundamentals.html#vectors-the-building-blocks"><i class="fa fa-check"></i><b>4.4.1</b> Vectors: The Building Blocks</a></li>
<li class="chapter" data-level="4.4.2" data-path="r-fundamentals.html"><a href="r-fundamentals.html#lists-mixed-data-collections"><i class="fa fa-check"></i><b>4.4.2</b> Lists: Mixed Data Collections</a></li>
<li class="chapter" data-level="4.4.3" data-path="r-fundamentals.html"><a href="r-fundamentals.html#data-frames-the-excel-of-r"><i class="fa fa-check"></i><b>4.4.3</b> Data Frames: The Excel of R</a></li>
<li class="chapter" data-level="4.4.4" data-path="r-fundamentals.html"><a href="r-fundamentals.html#indexing-accessing-your-data"><i class="fa fa-check"></i><b>4.4.4</b> Indexing: Accessing Your Data</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="r-fundamentals.html"><a href="r-fundamentals.html#conditions-and-comparisons"><i class="fa fa-check"></i><b>4.5</b> Conditions and Comparisons</a></li>
<li class="chapter" data-level="4.6" data-path="r-fundamentals.html"><a href="r-fundamentals.html#conditional-execution-with"><i class="fa fa-check"></i><b>4.6</b> Conditional execution with</a></li>
<li class="chapter" data-level="4.7" data-path="r-fundamentals.html"><a href="r-fundamentals.html#repeating-lines-of-code"><i class="fa fa-check"></i><b>4.7</b> Repeating lines of code</a></li>
<li class="chapter" data-level="4.8" data-path="r-fundamentals.html"><a href="r-fundamentals.html#functions"><i class="fa fa-check"></i><b>4.8</b> Functions</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html"><i class="fa fa-check"></i><b>5</b> Introduction to the Tidyverse</a>
<ul>
<li class="chapter" data-level="5.1" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#data-structure-wide-vs.-tidy-data"><i class="fa fa-check"></i><b>5.1</b> Data Structure: Wide vs. Tidy Data</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#understanding-the-difference"><i class="fa fa-check"></i><b>5.1.1</b> Understanding the Difference</a></li>
<li class="chapter" data-level="5.1.2" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#reshaping-data-with-tidyr"><i class="fa fa-check"></i><b>5.1.2</b> Reshaping Data with tidyr</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#core-dplyr-functions-for-data-manipulation"><i class="fa fa-check"></i><b>5.2</b> Core dplyr Functions for Data Manipulation</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#the-pipe-operator"><i class="fa fa-check"></i><b>5.2.1</b> The Pipe Operator (<code>%&gt;%</code>)</a></li>
<li class="chapter" data-level="5.2.2" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#select-choose-columns"><i class="fa fa-check"></i><b>5.2.2</b> <code>select()</code>: Choose Columns</a></li>
<li class="chapter" data-level="5.2.3" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#filter-choose-rows"><i class="fa fa-check"></i><b>5.2.3</b> <code>filter()</code>: Choose Rows</a></li>
<li class="chapter" data-level="5.2.4" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#mutate-create-or-modify-columns"><i class="fa fa-check"></i><b>5.2.4</b> <code>mutate()</code>: Create or Modify Columns</a></li>
<li class="chapter" data-level="5.2.5" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#transmute-create-new-columns-drop-others"><i class="fa fa-check"></i><b>5.2.5</b> <code>transmute()</code>: Create New Columns (Drop Others)</a></li>
<li class="chapter" data-level="5.2.6" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#arrange-sort-rows"><i class="fa fa-check"></i><b>5.2.6</b> <code>arrange()</code>: Sort Rows</a></li>
<li class="chapter" data-level="5.2.7" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#group_by-and-summarise-group-operations"><i class="fa fa-check"></i><b>5.2.7</b> <code>group_by()</code> and <code>summarise()</code>: Group Operations</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#additional-essential-functions"><i class="fa fa-check"></i><b>5.3</b> Additional Essential Functions</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#rename-change-column-names"><i class="fa fa-check"></i><b>5.3.1</b> <code>rename()</code>: Change Column Names</a></li>
<li class="chapter" data-level="5.3.2" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#data-type-conversions"><i class="fa fa-check"></i><b>5.3.2</b> Data Type Conversions</a></li>
<li class="chapter" data-level="5.3.3" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#across-apply-functions-to-multiple-columns"><i class="fa fa-check"></i><b>5.3.3</b> <code>across()</code>: Apply Functions to Multiple Columns</a></li>
<li class="chapter" data-level="5.3.4" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#recode-recode-values"><i class="fa fa-check"></i><b>5.3.4</b> <code>recode()</code>: Recode Values</a></li>
<li class="chapter" data-level="5.3.5" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#case_when-multiple-conditional-logic"><i class="fa fa-check"></i><b>5.3.5</b> <code>case_when()</code>: Multiple Conditional Logic</a></li>
<li class="chapter" data-level="5.3.6" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#replace_na-handle-missing-values"><i class="fa fa-check"></i><b>5.3.6</b> <code>replace_na()</code>: Handle Missing Values</a></li>
<li class="chapter" data-level="5.3.7" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#which-find-positions"><i class="fa fa-check"></i><b>5.3.7</b> <code>which()</code>: Find Positions</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#practical-example-data-analysis-workflow"><i class="fa fa-check"></i><b>5.4</b> Practical Example: Data Analysis Workflow</a></li>
<li class="chapter" data-level="5.5" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#function-summary-table"><i class="fa fa-check"></i><b>5.5</b> Function Summary Table</a></li>
<li class="chapter" data-level="5.6" data-path="introduction-to-the-tidyverse.html"><a href="introduction-to-the-tidyverse.html#conclusion"><i class="fa fa-check"></i><b>5.6</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html"><i class="fa fa-check"></i><b>6</b> Data Visualization in R</a>
<ul>
<li class="chapter" data-level="6.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#ggplot2-the-grammar-of-graphics"><i class="fa fa-check"></i><b>6.1</b> ggplot2: The Grammar of Graphics</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#basic-ggplot2-structure"><i class="fa fa-check"></i><b>6.1.1</b> Basic ggplot2 Structure</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#basic-plot-types"><i class="fa fa-check"></i><b>6.2</b> Basic Plot Types</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#scatter-plots-with-geom_point"><i class="fa fa-check"></i><b>6.2.1</b> Scatter Plots with <code>geom_point()</code></a></li>
<li class="chapter" data-level="6.2.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#line-plots-with-geom_line"><i class="fa fa-check"></i><b>6.2.2</b> Line Plots with <code>geom_line()</code></a></li>
<li class="chapter" data-level="6.2.3" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#bar-plots-with-geom_col-and-geom_bar"><i class="fa fa-check"></i><b>6.2.3</b> Bar Plots with <code>geom_col()</code> and <code>geom_bar()</code></a></li>
<li class="chapter" data-level="6.2.4" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#histograms-with-geom_histogram"><i class="fa fa-check"></i><b>6.2.4</b> Histograms with <code>geom_histogram()</code></a></li>
<li class="chapter" data-level="6.2.5" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#box-plots-with-geom_boxplot"><i class="fa fa-check"></i><b>6.2.5</b> Box Plots with <code>geom_boxplot()</code></a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#aesthetic-mappings"><i class="fa fa-check"></i><b>6.3</b> Aesthetic Mappings</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#understanding-aes"><i class="fa fa-check"></i><b>6.3.1</b> Understanding <code>aes()</code></a></li>
<li class="chapter" data-level="6.3.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#fixed-vs.-mapped-aesthetics"><i class="fa fa-check"></i><b>6.3.2</b> Fixed vs. Mapped Aesthetics</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#faceting-small-multiples"><i class="fa fa-check"></i><b>6.4</b> Faceting: Small Multiples</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#facet_wrap"><i class="fa fa-check"></i><b>6.4.1</b> <code>facet_wrap()</code></a></li>
<li class="chapter" data-level="6.4.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#facet_grid"><i class="fa fa-check"></i><b>6.4.2</b> <code>facet_grid()</code></a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#statistical-transformations"><i class="fa fa-check"></i><b>6.5</b> Statistical Transformations</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#smooth-lines-with-geom_smooth"><i class="fa fa-check"></i><b>6.5.1</b> Smooth Lines with <code>geom_smooth()</code></a></li>
<li class="chapter" data-level="6.5.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#statistical-summaries"><i class="fa fa-check"></i><b>6.5.2</b> Statistical Summaries</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#scales-controlling-aesthetic-mappings"><i class="fa fa-check"></i><b>6.6</b> Scales: Controlling Aesthetic Mappings</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#color-scales"><i class="fa fa-check"></i><b>6.6.1</b> Color Scales</a></li>
<li class="chapter" data-level="6.6.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#axis-scales"><i class="fa fa-check"></i><b>6.6.2</b> Axis Scales</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#coordinates-and-transformations"><i class="fa fa-check"></i><b>6.7</b> Coordinates and Transformations</a></li>
<li class="chapter" data-level="6.8" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#labels-and-themes"><i class="fa fa-check"></i><b>6.8</b> Labels and Themes</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#adding-labels"><i class="fa fa-check"></i><b>6.8.1</b> Adding Labels</a></li>
<li class="chapter" data-level="6.8.2" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#theme-customization"><i class="fa fa-check"></i><b>6.8.2</b> Theme Customization</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#heatmaps"><i class="fa fa-check"></i><b>6.9</b> Heatmaps</a></li>
<li class="chapter" data-level="6.10" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#combining-multiple-geoms"><i class="fa fa-check"></i><b>6.10</b> Combining Multiple Geoms</a></li>
<li class="chapter" data-level="6.11" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#text-and-annotations"><i class="fa fa-check"></i><b>6.11</b> Text and Annotations</a></li>
<li class="chapter" data-level="6.12" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#practical-example-complex-multi-layered-plot"><i class="fa fa-check"></i><b>6.12</b> Practical Example: Complex Multi-layered Plot</a></li>
<li class="chapter" data-level="6.13" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#ggplot2-function-summary-table"><i class="fa fa-check"></i><b>6.13</b> ggplot2 Function Summary Table</a></li>
<li class="chapter" data-level="6.14" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#conclusion-1"><i class="fa fa-check"></i><b>6.14</b> Conclusion</a></li>
<li class="chapter" data-level="6.15" data-path="data-visualization-in-r.html"><a href="data-visualization-in-r.html#my-favorite-figures-i-ever-made"><i class="fa fa-check"></i><b>6.15</b> My favorite figures I ever made</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="statistics.html"><a href="statistics.html"><i class="fa fa-check"></i><b>7</b> Statistics</a></li>
<li class="chapter" data-level="8" data-path="working-with-epidemiological-data.html"><a href="working-with-epidemiological-data.html"><i class="fa fa-check"></i><b>8</b> Working with epidemiological data</a>
<ul>
<li class="chapter" data-level="8.1" data-path="working-with-epidemiological-data.html"><a href="working-with-epidemiological-data.html#acessing-data"><i class="fa fa-check"></i><b>8.1</b> Acessing data</a></li>
<li class="chapter" data-level="8.2" data-path="working-with-epidemiological-data.html"><a href="working-with-epidemiological-data.html#case-study-1-yellow-fever"><i class="fa fa-check"></i><b>8.2</b> Case Study 1: Yellow Fever</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="case-study-dengue-fever-in-brazil.html"><a href="case-study-dengue-fever-in-brazil.html"><i class="fa fa-check"></i><b>9</b> Case study: Dengue Fever in Brazil</a></li>
<li class="chapter" data-level="10" data-path="modelling.html"><a href="modelling.html"><i class="fa fa-check"></i><b>10</b> Modelling</a>
<ul>
<li class="chapter" data-level="10.1" data-path="modelling.html"><a href="modelling.html#compartmental-models"><i class="fa fa-check"></i><b>10.1</b> Compartmental models</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="modelling.html"><a href="modelling.html#sir-model-in-theory"><i class="fa fa-check"></i><b>10.1.1</b> SIR model in theory</a></li>
<li class="chapter" data-level="10.1.2" data-path="modelling.html"><a href="modelling.html#sir-model-in-r"><i class="fa fa-check"></i><b>10.1.2</b> SIR model in R</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="modelling.html"><a href="modelling.html#time-series---forecasting"><i class="fa fa-check"></i><b>10.2</b> Time series - Forecasting</a></li>
<li class="chapter" data-level="10.3" data-path="modelling.html"><a href="modelling.html#using-and-applying-models"><i class="fa fa-check"></i><b>10.3</b> Using and applying models</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="communication-and-sharing-of-code-and-data.html"><a href="communication-and-sharing-of-code-and-data.html"><i class="fa fa-check"></i><b>11</b> Communication and sharing of code and data</a>
<ul>
<li class="chapter" data-level="11.1" data-path="communication-and-sharing-of-code-and-data.html"><a href="communication-and-sharing-of-code-and-data.html#writing-code-best-practices"><i class="fa fa-check"></i><b>11.1</b> Writing code: best practices</a></li>
<li class="chapter" data-level="11.2" data-path="communication-and-sharing-of-code-and-data.html"><a href="communication-and-sharing-of-code-and-data.html#github"><i class="fa fa-check"></i><b>11.2</b> Github</a></li>
<li class="chapter" data-level="11.3" data-path="communication-and-sharing-of-code-and-data.html"><a href="communication-and-sharing-of-code-and-data.html#reports-using-markdown"><i class="fa fa-check"></i><b>11.3</b> Reports using Markdown</a></li>
<li class="chapter" data-level="11.4" data-path="communication-and-sharing-of-code-and-data.html"><a href="communication-and-sharing-of-code-and-data.html#open-science"><i class="fa fa-check"></i><b>11.4</b> Open science</a></li>
<li class="chapter" data-level="11.5" data-path="communication-and-sharing-of-code-and-data.html"><a href="communication-and-sharing-of-code-and-data.html#communities-and-forums"><i class="fa fa-check"></i><b>11.5</b> Communities and forums</a></li>
<li class="chapter" data-level="11.6" data-path="communication-and-sharing-of-code-and-data.html"><a href="communication-and-sharing-of-code-and-data.html#how-to-use-chat-gpt"><i class="fa fa-check"></i><b>11.6</b> How to use Chat-GPT</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="recommended-reading.html"><a href="recommended-reading.html"><i class="fa fa-check"></i><b>12</b> Recommended Reading</a>
<ul>
<li class="chapter" data-level="12.1" data-path="recommended-reading.html"><a href="recommended-reading.html#recommended-textbooks-and-courses"><i class="fa fa-check"></i><b>12.1</b> Recommended textbooks and courses</a></li>
<li class="chapter" data-level="12.2" data-path="recommended-reading.html"><a href="recommended-reading.html#useful-packages"><i class="fa fa-check"></i><b>12.2</b> Useful packages</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Epibible</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="working-with-epidemiological-data" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number">Chapter 8</span> Working with epidemiological data<a href="working-with-epidemiological-data.html#working-with-epidemiological-data" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Data is at the heart of epidemiology. We look at where and when diseases occur, to hopefully better understand their origin or their cause, how to prevent or cure the disease, or to make predictions about the future. That’s why epidemiologists need to be able to work with disease data, and know how and where to look for it! That’s why in this chapter we go over some data-extraction, processing, visualization and analysis. We start simple, with an example of Yellow Fever, and then get into more complex case in which we try to understand cholera outbreaks.</p>
<div id="acessing-data" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> Acessing data<a href="working-with-epidemiological-data.html#acessing-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>raw data</li>
<li>cleaned data</li>
<li>harmonization -&gt; standardization</li>
</ul>
<p>data cleaning: fixing or removing incorrect, incosistent or missing data
data harmonziation: standardization or alignment of data
## (Imperfect) epidemiological data</p>
</div>
<div id="case-study-1-yellow-fever" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Case Study 1: Yellow Fever<a href="working-with-epidemiological-data.html#case-study-1-yellow-fever" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Yellow fever (YF) is a severe and sometimes fatal hemorrhagic fever caused by a flavivirus with a single-stranded, negatively oriented RNA genome. It primarily affects regions in Africa and Latin America, where the virus sustains itself through a sylvatic cycle involving wild mosquitoes and non-human primates. In Brazil, for instance, mosquito species like Haemagogus and Sabethes maintain this cycle in forested areas. While a highly effective vaccine exists, yellow fever outbreaks still occur, particularly when the virus spills over into urban settings <span class="citation">(Chippaux &amp; Chippaux, 2018)</span>.</p>
<p>Historically, yellow fever was confined to Africa until the transatlantic slave trade introduced it to Latin America, where favorable climates and mosquito vectors allowed it to take root. Cities like New Orleans suffered repeated, devastating outbreaks in the past. Brazil saw a decline in cases mid-20th century, but a resurgence occurred between 2016 and 2018, with over 2,000 reported cases and a strikingly high death toll of 681. This resurgence was partly driven by the spread of the virus into urban areas, facilitated by Aedes aegypti and Aedes albopictus, mosquitoes that thrive in cities. Curiously, yellow fever has never established itself in Asia despite the presence of competent vectors and similar arboviruses, a mystery that may relate to immunological cross-reactivity with other flaviviruses like dengue <span class="citation">(Chippaux &amp; Chippaux, 2018)</span>.</p>
<p>The WHO has data data available for download for many different things, including casenumbers for many infectious diseases, including that for YF. The raw data for YF you can find <a href="https://www.who.int/data/gho/data/indicators/indicator-details/GHO/yellow-fever-number-of-reported-cases">here</a>. I have cleaned this data a little so that the dataframe is as concise as possible, and so that all the countrynames correctly map to the ones in the <strong>world_shapefile</strong> dataset.</p>
<div id="installing-packages" class="section level4 hasAnchor" number="8.2.0.1">
<h4><span class="header-section-number">8.2.0.1</span> Installing packages<a href="working-with-epidemiological-data.html#installing-packages" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="working-with-epidemiological-data.html#cb194-1" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb194-2"><a href="working-with-epidemiological-data.html#cb194-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb194-3"><a href="working-with-epidemiological-data.html#cb194-3" tabindex="-1"></a><span class="fu">library</span>(readr)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;readr&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:scales&#39;:
## 
##     col_factor</code></pre>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="working-with-epidemiological-data.html#cb197-1" tabindex="-1"></a><span class="fu">library</span>(glue)</span>
<span id="cb197-2"><a href="working-with-epidemiological-data.html#cb197-2" tabindex="-1"></a></span>
<span id="cb197-3"><a href="working-with-epidemiological-data.html#cb197-3" tabindex="-1"></a><span class="co"># The following packages print a lot of noise when installing so I silence their output</span></span>
<span id="cb197-4"><a href="working-with-epidemiological-data.html#cb197-4" tabindex="-1"></a><span class="co"># by wrapping them in a `suppressPackageStartupMessages({})</span></span>
<span id="cb197-5"><a href="working-with-epidemiological-data.html#cb197-5" tabindex="-1"></a><span class="fu">suppressPackageStartupMessages</span>({</span>
<span id="cb197-6"><a href="working-with-epidemiological-data.html#cb197-6" tabindex="-1"></a>  <span class="fu">library</span>(tidyverse)</span>
<span id="cb197-7"><a href="working-with-epidemiological-data.html#cb197-7" tabindex="-1"></a>  <span class="fu">library</span>(gapminder)</span>
<span id="cb197-8"><a href="working-with-epidemiological-data.html#cb197-8" tabindex="-1"></a>  <span class="fu">library</span>(rnaturalearth)</span>
<span id="cb197-9"><a href="working-with-epidemiological-data.html#cb197-9" tabindex="-1"></a>  <span class="fu">library</span>(rnaturalearthdata)</span>
<span id="cb197-10"><a href="working-with-epidemiological-data.html#cb197-10" tabindex="-1"></a>  <span class="fu">library</span>(sf)</span>
<span id="cb197-11"><a href="working-with-epidemiological-data.html#cb197-11" tabindex="-1"></a>})</span></code></pre></div>
</div>
<div id="installing-world-shapedata" class="section level4 hasAnchor" number="8.2.0.2">
<h4><span class="header-section-number">8.2.0.2</span> Installing world shapedata<a href="working-with-epidemiological-data.html#installing-world-shapedata" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Eventually, I want to show you how to make some plots and some maps. For that, we need to load the shape of the world, so that we can fill in countries with certain colors and such. For that we’ll load the <strong>world shapefile</strong> from the package <em>rnaturalearth</em>. This dataset includes many different columns, but we only require some of them; name, geometry and continent.</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="working-with-epidemiological-data.html#cb198-1" tabindex="-1"></a>world_shapefile              <span class="ot">=</span> <span class="fu">ne_countries</span>(<span class="at">scale =</span> <span class="st">&quot;medium&quot;</span>, <span class="at">returnclass =</span> <span class="st">&quot;sf&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">&quot;name&quot;</span>,<span class="st">&quot;geometry&quot;</span>, <span class="st">&quot;continent&quot;</span>))</span>
<span id="cb198-2"><a href="working-with-epidemiological-data.html#cb198-2" tabindex="-1"></a><span class="fu">colnames</span>(world_shapefile)[<span class="dv">1</span>] <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;country&quot;</span>)</span>
<span id="cb198-3"><a href="working-with-epidemiological-data.html#cb198-3" tabindex="-1"></a>continents_list              <span class="ot">=</span> <span class="fu">unique</span>(world_shapefile<span class="sc">$</span>continent)</span>
<span id="cb198-4"><a href="working-with-epidemiological-data.html#cb198-4" tabindex="-1"></a></span>
<span id="cb198-5"><a href="working-with-epidemiological-data.html#cb198-5" tabindex="-1"></a>countries_continents <span class="ot">&lt;-</span> world_shapefile <span class="sc">%&gt;%</span></span>
<span id="cb198-6"><a href="working-with-epidemiological-data.html#cb198-6" tabindex="-1"></a>  <span class="fu">st_set_geometry</span>(<span class="cn">NULL</span>) <span class="sc">%&gt;%</span></span>
<span id="cb198-7"><a href="working-with-epidemiological-data.html#cb198-7" tabindex="-1"></a>  <span class="fu">select</span>(country, continent)</span>
<span id="cb198-8"><a href="working-with-epidemiological-data.html#cb198-8" tabindex="-1"></a></span>
<span id="cb198-9"><a href="working-with-epidemiological-data.html#cb198-9" tabindex="-1"></a><span class="co"># World map</span></span>
<span id="cb198-10"><a href="working-with-epidemiological-data.html#cb198-10" tabindex="-1"></a></span>
<span id="cb198-11"><a href="working-with-epidemiological-data.html#cb198-11" tabindex="-1"></a><span class="fu">ggplot</span>(world_shapefile) <span class="sc">+</span></span>
<span id="cb198-12"><a href="working-with-epidemiological-data.html#cb198-12" tabindex="-1"></a>    <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> continent), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">linewidth =</span> <span class="fl">0.01</span>) <span class="sc">+</span></span>
<span id="cb198-13"><a href="working-with-epidemiological-data.html#cb198-13" tabindex="-1"></a>    <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb198-14"><a href="working-with-epidemiological-data.html#cb198-14" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb198-15"><a href="working-with-epidemiological-data.html#cb198-15" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">&#39;world shapefile&#39;</span>,</span>
<span id="cb198-16"><a href="working-with-epidemiological-data.html#cb198-16" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb198-17"><a href="working-with-epidemiological-data.html#cb198-17" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb198-18"><a href="working-with-epidemiological-data.html#cb198-18" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;#f7f9fc&quot;</span>),</span>
<span id="cb198-19"><a href="working-with-epidemiological-data.html#cb198-19" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb198-20"><a href="working-with-epidemiological-data.html#cb198-20" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb198-21"><a href="working-with-epidemiological-data.html#cb198-21" tabindex="-1"></a>      <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb198-22"><a href="working-with-epidemiological-data.html#cb198-22" tabindex="-1"></a>    )</span></code></pre></div>
<p><img src="08-working-with-epidemiological-data_files/figure-html/unnamed-chunk-2-1.png" width="1344" style="display: block; margin: auto;" /></p>
</div>
<div id="yellow-fever-data" class="section level4 hasAnchor" number="8.2.0.3">
<h4><span class="header-section-number">8.2.0.3</span> Yellow Fever data<a href="working-with-epidemiological-data.html#yellow-fever-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="working-with-epidemiological-data.html#cb199-1" tabindex="-1"></a>who_yellowfever <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">&quot;data/cleaned_yellowfever.csv&quot;</span>, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb199-2"><a href="working-with-epidemiological-data.html#cb199-2" tabindex="-1"></a></span>
<span id="cb199-3"><a href="working-with-epidemiological-data.html#cb199-3" tabindex="-1"></a><span class="co"># head allows us to preview the table</span></span>
<span id="cb199-4"><a href="working-with-epidemiological-data.html#cb199-4" tabindex="-1"></a><span class="fu">head</span>(who_yellowfever)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 3
##   country            year cases
##   &lt;chr&gt;             &lt;dbl&gt; &lt;dbl&gt;
## 1 Algeria            2024     0
## 2 Andorra            2024     0
## 3 Anguilla           2024     0
## 4 Antigua and Barb.  2024     0
## 5 Armenia            2024     0
## 6 Aruba              2024     0</code></pre>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="working-with-epidemiological-data.html#cb201-1" tabindex="-1"></a><span class="co"># draw up some specifications of the dataset</span></span>
<span id="cb201-2"><a href="working-with-epidemiological-data.html#cb201-2" tabindex="-1"></a>n_countries <span class="ot">=</span> <span class="fu">length</span>(<span class="fu">unique</span>(who_yellowfever<span class="sc">$</span>country))</span>
<span id="cb201-3"><a href="working-with-epidemiological-data.html#cb201-3" tabindex="-1"></a>first_year  <span class="ot">=</span> <span class="fu">min</span>(who_yellowfever<span class="sc">$</span>year)</span>
<span id="cb201-4"><a href="working-with-epidemiological-data.html#cb201-4" tabindex="-1"></a>last_year   <span class="ot">=</span> <span class="fu">max</span>(who_yellowfever<span class="sc">$</span>year)</span>
<span id="cb201-5"><a href="working-with-epidemiological-data.html#cb201-5" tabindex="-1"></a></span>
<span id="cb201-6"><a href="working-with-epidemiological-data.html#cb201-6" tabindex="-1"></a><span class="fu">glue</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">The dataframe contains yearly casedata for {n_countries} countries between {first_year} and {last_year}&quot;</span>)</span></code></pre></div>
<pre><code>## The dataframe contains yearly casedata for 212 countries between 1974 and 2024</code></pre>
</div>
<div id="global-yearly-cases" class="section level4 hasAnchor" number="8.2.0.4">
<h4><span class="header-section-number">8.2.0.4</span> Global yearly cases<a href="working-with-epidemiological-data.html#global-yearly-cases" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let’s first get a global overview of YF in the world the past 50 years. To start with, we will create a graph showing the number of cases in the world per year, and then we’ll show it per continent to see which are the ones most affected.</p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="working-with-epidemiological-data.html#cb203-1" tabindex="-1"></a><span class="co"># Global epicurve</span></span>
<span id="cb203-2"><a href="working-with-epidemiological-data.html#cb203-2" tabindex="-1"></a>global_yearly_casenumbers <span class="ot">&lt;-</span> who_yellowfever <span class="sc">%&gt;%</span></span>
<span id="cb203-3"><a href="working-with-epidemiological-data.html#cb203-3" tabindex="-1"></a>  <span class="fu">group_by</span>(year) <span class="sc">%&gt;%</span></span>
<span id="cb203-4"><a href="working-with-epidemiological-data.html#cb203-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">cases =</span> <span class="fu">sum</span>(cases))</span>
<span id="cb203-5"><a href="working-with-epidemiological-data.html#cb203-5" tabindex="-1"></a></span>
<span id="cb203-6"><a href="working-with-epidemiological-data.html#cb203-6" tabindex="-1"></a></span>
<span id="cb203-7"><a href="working-with-epidemiological-data.html#cb203-7" tabindex="-1"></a><span class="fu">ggplot</span>(global_yearly_casenumbers) <span class="sc">+</span> </span>
<span id="cb203-8"><a href="working-with-epidemiological-data.html#cb203-8" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> cases), <span class="at">color =</span> <span class="st">&#39;black&#39;</span>, <span class="at">linewidth =</span> <span class="fl">1.5</span>) <span class="sc">+</span>  <span class="co"># black outline</span></span>
<span id="cb203-9"><a href="working-with-epidemiological-data.html#cb203-9" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> cases), <span class="at">color =</span> <span class="st">&#39;#ffcc00&#39;</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span>  <span class="co"># yellow line</span></span>
<span id="cb203-10"><a href="working-with-epidemiological-data.html#cb203-10" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">pretty_breaks</span>(<span class="at">n =</span> <span class="dv">20</span>)) <span class="sc">+</span>                <span class="co"># I don&#39;t want a break per year. I do a max of 20 year</span></span>
<span id="cb203-11"><a href="working-with-epidemiological-data.html#cb203-11" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">14</span>)  <span class="sc">+</span> </span>
<span id="cb203-12"><a href="working-with-epidemiological-data.html#cb203-12" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb203-13"><a href="working-with-epidemiological-data.html#cb203-13" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb203-14"><a href="working-with-epidemiological-data.html#cb203-14" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Yellow Fever Cases in the world 1974 - 2024&quot;</span>,</span>
<span id="cb203-15"><a href="working-with-epidemiological-data.html#cb203-15" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;number of cases reported to the WHO&quot;</span></span>
<span id="cb203-16"><a href="working-with-epidemiological-data.html#cb203-16" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="08-working-with-epidemiological-data_files/figure-html/unnamed-chunk-4-1.png" width="1440" style="display: block; margin: auto;" /></p>
</div>
<div id="yearly-cases-per-continent" class="section level4 hasAnchor" number="8.2.0.5">
<h4><span class="header-section-number">8.2.0.5</span> Yearly cases per continent<a href="working-with-epidemiological-data.html#yearly-cases-per-continent" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="working-with-epidemiological-data.html#cb204-1" tabindex="-1"></a>yearly_casenumbers_continent <span class="ot">=</span> <span class="fu">merge</span>(who_yellowfever, countries_continents, <span class="at">by =</span> <span class="st">&quot;country&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb204-2"><a href="working-with-epidemiological-data.html#cb204-2" tabindex="-1"></a>  <span class="fu">group_by</span>(year, continent) <span class="sc">%&gt;%</span> </span>
<span id="cb204-3"><a href="working-with-epidemiological-data.html#cb204-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">cases =</span> <span class="fu">sum</span>(cases), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb204-4"><a href="working-with-epidemiological-data.html#cb204-4" tabindex="-1"></a>  <span class="fu">filter</span>(continent <span class="sc">%in%</span> continents_list)</span>
<span id="cb204-5"><a href="working-with-epidemiological-data.html#cb204-5" tabindex="-1"></a></span>
<span id="cb204-6"><a href="working-with-epidemiological-data.html#cb204-6" tabindex="-1"></a><span class="fu">ggplot</span>(yearly_casenumbers_continent) <span class="sc">+</span> </span>
<span id="cb204-7"><a href="working-with-epidemiological-data.html#cb204-7" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> cases, <span class="at">color =</span> continent), <span class="at">linewidth =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb204-8"><a href="working-with-epidemiological-data.html#cb204-8" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">pretty_breaks</span>(<span class="at">n =</span> <span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb204-9"><a href="working-with-epidemiological-data.html#cb204-9" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span> </span>
<span id="cb204-10"><a href="working-with-epidemiological-data.html#cb204-10" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Dark2&quot;</span>) <span class="sc">+</span>  <span class="co"># 7 distinct colors</span></span>
<span id="cb204-11"><a href="working-with-epidemiological-data.html#cb204-11" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb204-12"><a href="working-with-epidemiological-data.html#cb204-12" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb204-13"><a href="working-with-epidemiological-data.html#cb204-13" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Yellow Fever Cases in the world 1973 - 2024 per continent&quot;</span>,</span>
<span id="cb204-14"><a href="working-with-epidemiological-data.html#cb204-14" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;number of cases reported to the WHO&quot;</span></span>
<span id="cb204-15"><a href="working-with-epidemiological-data.html#cb204-15" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb204-16"><a href="working-with-epidemiological-data.html#cb204-16" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</span></code></pre></div>
<p><img src="08-working-with-epidemiological-data_files/figure-html/unnamed-chunk-5-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>We can clearly tell that since 1974, Africa has experienced the largest burden by YF, though South America suffered between 2016 and 2019 as well. Let’s have a look at the total sum of cases per country in the past, to see which countries and which areas are affected the most.</p>
</div>
<div id="historical-burden" class="section level4 hasAnchor" number="8.2.0.6">
<h4><span class="header-section-number">8.2.0.6</span> Historical burden<a href="working-with-epidemiological-data.html#historical-burden" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="working-with-epidemiological-data.html#cb205-1" tabindex="-1"></a>cases_per_country <span class="ot">=</span> who_yellowfever<span class="sc">%&gt;%</span> </span>
<span id="cb205-2"><a href="working-with-epidemiological-data.html#cb205-2" tabindex="-1"></a>  <span class="fu">group_by</span>(country) <span class="sc">%&gt;%</span></span>
<span id="cb205-3"><a href="working-with-epidemiological-data.html#cb205-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">cases =</span> <span class="fu">sum</span>(cases))</span>
<span id="cb205-4"><a href="working-with-epidemiological-data.html#cb205-4" tabindex="-1"></a></span>
<span id="cb205-5"><a href="working-with-epidemiological-data.html#cb205-5" tabindex="-1"></a>mapdata <span class="ot">=</span> <span class="fu">st_as_sf</span>(<span class="fu">merge</span>(cases_per_country, world_shapefile, <span class="at">on =</span> <span class="st">&#39;country&#39;</span>, <span class="at">all.y =</span> <span class="cn">TRUE</span>))</span>
<span id="cb205-6"><a href="working-with-epidemiological-data.html#cb205-6" tabindex="-1"></a></span>
<span id="cb205-7"><a href="working-with-epidemiological-data.html#cb205-7" tabindex="-1"></a></span>
<span id="cb205-8"><a href="working-with-epidemiological-data.html#cb205-8" tabindex="-1"></a>mapdata<span class="sc">$</span>cases_category <span class="ot">&lt;-</span> <span class="fu">cut</span>(</span>
<span id="cb205-9"><a href="working-with-epidemiological-data.html#cb205-9" tabindex="-1"></a>  mapdata<span class="sc">$</span>cases,</span>
<span id="cb205-10"><a href="working-with-epidemiological-data.html#cb205-10" tabindex="-1"></a>  <span class="at">breaks =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>, <span class="dv">2000</span>, <span class="dv">5000</span>, <span class="dv">10000</span>, <span class="dv">20000</span>, <span class="cn">Inf</span>),  <span class="co"># 8 breaks → 7 intervals</span></span>
<span id="cb205-11"><a href="working-with-epidemiological-data.html#cb205-11" tabindex="-1"></a>  <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;0 - 100&quot;</span>, <span class="st">&quot;101-500&quot;</span>,<span class="st">&quot;501-1000&quot;</span>,     <span class="st">&quot;1001-2000&quot;</span>,   <span class="st">&quot;2001-5000&quot;</span>,    <span class="st">&quot;5001-10000&quot;</span>,  <span class="st">&quot;10001-20000&quot;</span>,  <span class="st">&quot;&gt;20000&quot;</span>),</span>
<span id="cb205-12"><a href="working-with-epidemiological-data.html#cb205-12" tabindex="-1"></a>  <span class="at">include.lowest =</span> <span class="cn">TRUE</span></span>
<span id="cb205-13"><a href="working-with-epidemiological-data.html#cb205-13" tabindex="-1"></a>)</span>
<span id="cb205-14"><a href="working-with-epidemiological-data.html#cb205-14" tabindex="-1"></a></span>
<span id="cb205-15"><a href="working-with-epidemiological-data.html#cb205-15" tabindex="-1"></a></span>
<span id="cb205-16"><a href="working-with-epidemiological-data.html#cb205-16" tabindex="-1"></a>pl <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mapdata) <span class="sc">+</span></span>
<span id="cb205-17"><a href="working-with-epidemiological-data.html#cb205-17" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="fu">aes</span>(<span class="at">fill =</span> cases_category), <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb205-18"><a href="working-with-epidemiological-data.html#cb205-18" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;YlOrRd&quot;</span>, <span class="at">na.value =</span> <span class="st">&quot;gray95&quot;</span>, <span class="at">name =</span> <span class="st">&quot;Cases&quot;</span>) <span class="sc">+</span></span>
<span id="cb205-19"><a href="working-with-epidemiological-data.html#cb205-19" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb205-20"><a href="working-with-epidemiological-data.html#cb205-20" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb205-21"><a href="working-with-epidemiological-data.html#cb205-21" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">&quot;#E0FFFF&quot;</span>),  <span class="co"># clean light background</span></span>
<span id="cb205-22"><a href="working-with-epidemiological-data.html#cb205-22" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">&quot;right&quot;</span>,</span>
<span id="cb205-23"><a href="working-with-epidemiological-data.html#cb205-23" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">size =</span> <span class="dv">16</span>),</span>
<span id="cb205-24"><a href="working-with-epidemiological-data.html#cb205-24" tabindex="-1"></a>      <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb205-25"><a href="working-with-epidemiological-data.html#cb205-25" tabindex="-1"></a>    ) <span class="sc">+</span> </span>
<span id="cb205-26"><a href="working-with-epidemiological-data.html#cb205-26" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&#39;Cumulative cases 1974 - 2024&#39;</span>)</span>
<span id="cb205-27"><a href="working-with-epidemiological-data.html#cb205-27" tabindex="-1"></a></span>
<span id="cb205-28"><a href="working-with-epidemiological-data.html#cb205-28" tabindex="-1"></a>pl</span></code></pre></div>
<p><img src="08-working-with-epidemiological-data_files/figure-html/unnamed-chunk-6-1.png" width="1440" style="display: block; margin: auto;" /></p>
<p>From this we can clearly see that the most affected regions are central and west Africa, as well as central(?) Latin America. This does not allow us to look into temporal dynamics though, so let’s look a bit further into that using a function.</p>
</div>
<div id="country-specific-epicurves" class="section level4 hasAnchor" number="8.2.0.7">
<h4><span class="header-section-number">8.2.0.7</span> Country-specific epicurves<a href="working-with-epidemiological-data.html#country-specific-epicurves" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="working-with-epidemiological-data.html#cb206-1" tabindex="-1"></a>plot_country <span class="ot">=</span> <span class="cf">function</span>(country_filter){</span>
<span id="cb206-2"><a href="working-with-epidemiological-data.html#cb206-2" tabindex="-1"></a>  </span>
<span id="cb206-3"><a href="working-with-epidemiological-data.html#cb206-3" tabindex="-1"></a>  filtered_df <span class="ot">&lt;-</span> who_yellowfever <span class="sc">%&gt;%</span> <span class="fu">filter</span>(country <span class="sc">==</span> country_filter)</span>
<span id="cb206-4"><a href="working-with-epidemiological-data.html#cb206-4" tabindex="-1"></a></span>
<span id="cb206-5"><a href="working-with-epidemiological-data.html#cb206-5" tabindex="-1"></a>  pl <span class="ot">=</span> <span class="fu">ggplot</span>(filtered_df) <span class="sc">+</span> </span>
<span id="cb206-6"><a href="working-with-epidemiological-data.html#cb206-6" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> cases), <span class="at">color =</span> <span class="st">&#39;black&#39;</span>, <span class="at">linewidth =</span> <span class="fl">1.5</span>) <span class="sc">+</span>  <span class="co"># black outline</span></span>
<span id="cb206-7"><a href="working-with-epidemiological-data.html#cb206-7" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> cases), <span class="at">color =</span> <span class="st">&#39;#ffcc00&#39;</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span>  <span class="co"># yellow line</span></span>
<span id="cb206-8"><a href="working-with-epidemiological-data.html#cb206-8" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> year, <span class="at">y =</span> cases), <span class="at">color =</span> <span class="st">&#39;black&#39;</span>, <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span>  <span class="co"># black outline</span></span>
<span id="cb206-9"><a href="working-with-epidemiological-data.html#cb206-9" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">pretty_breaks</span>(<span class="at">n =</span> <span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb206-10"><a href="working-with-epidemiological-data.html#cb206-10" tabindex="-1"></a>      <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">14</span>)  <span class="sc">+</span> </span>
<span id="cb206-11"><a href="working-with-epidemiological-data.html#cb206-11" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;&quot;</span>, <span class="at">y=</span><span class="st">&#39;cases&#39;</span>) <span class="sc">+</span></span>
<span id="cb206-12"><a href="working-with-epidemiological-data.html#cb206-12" tabindex="-1"></a>      <span class="fu">labs</span>(</span>
<span id="cb206-13"><a href="working-with-epidemiological-data.html#cb206-13" tabindex="-1"></a>      <span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">&quot;Yellow Fever Cases in &quot;</span>, country_filter,  <span class="st">&quot; 1973 - 2024&quot;</span>),</span>
<span id="cb206-14"><a href="working-with-epidemiological-data.html#cb206-14" tabindex="-1"></a>      <span class="at">subtitle =</span> <span class="st">&quot;number of cases reported to the WHO&quot;</span></span>
<span id="cb206-15"><a href="working-with-epidemiological-data.html#cb206-15" tabindex="-1"></a>    )</span>
<span id="cb206-16"><a href="working-with-epidemiological-data.html#cb206-16" tabindex="-1"></a>  </span>
<span id="cb206-17"><a href="working-with-epidemiological-data.html#cb206-17" tabindex="-1"></a>  <span class="fu">return</span>(pl)</span>
<span id="cb206-18"><a href="working-with-epidemiological-data.html#cb206-18" tabindex="-1"></a>  </span>
<span id="cb206-19"><a href="working-with-epidemiological-data.html#cb206-19" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="working-with-epidemiological-data.html#cb207-1" tabindex="-1"></a><span class="fu">plot_country</span>(<span class="st">&quot;Dem. Rep. Congo&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in geom_point(aes(x = year, y = cases), color = &quot;black&quot;, linewidth =
## 1): Ignoring unknown parameters: `linewidth`</code></pre>
<p><img src="08-working-with-epidemiological-data_files/figure-html/unnamed-chunk-8-1.png" width="1440" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="working-with-epidemiological-data.html#cb209-1" tabindex="-1"></a><span class="fu">plot_country</span>(<span class="st">&quot;Chad&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in geom_point(aes(x = year, y = cases), color = &quot;black&quot;, linewidth =
## 1): Ignoring unknown parameters: `linewidth`</code></pre>
<p><img src="08-working-with-epidemiological-data_files/figure-html/unnamed-chunk-8-2.png" width="1440" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="working-with-epidemiological-data.html#cb211-1" tabindex="-1"></a><span class="fu">plot_country</span>(<span class="st">&quot;Nigeria&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in geom_point(aes(x = year, y = cases), color = &quot;black&quot;, linewidth =
## 1): Ignoring unknown parameters: `linewidth`</code></pre>
<p><img src="08-working-with-epidemiological-data_files/figure-html/unnamed-chunk-8-3.png" width="1440" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="working-with-epidemiological-data.html#cb213-1" tabindex="-1"></a><span class="fu">plot_country</span>(<span class="st">&quot;Ghana&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in geom_point(aes(x = year, y = cases), color = &quot;black&quot;, linewidth =
## 1): Ignoring unknown parameters: `linewidth`</code></pre>
<p><img src="08-working-with-epidemiological-data_files/figure-html/unnamed-chunk-8-4.png" width="1440" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="working-with-epidemiological-data.html#cb215-1" tabindex="-1"></a><span class="fu">plot_country</span>(<span class="st">&quot;Brazil&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in geom_point(aes(x = year, y = cases), color = &quot;black&quot;, linewidth =
## 1): Ignoring unknown parameters: `linewidth`</code></pre>
<p><img src="08-working-with-epidemiological-data_files/figure-html/unnamed-chunk-8-5.png" width="1440" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="working-with-epidemiological-data.html#cb217-1" tabindex="-1"></a><span class="fu">plot_country</span>(<span class="st">&quot;Peru&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in geom_point(aes(x = year, y = cases), color = &quot;black&quot;, linewidth =
## 1): Ignoring unknown parameters: `linewidth`</code></pre>
<p><img src="08-working-with-epidemiological-data_files/figure-html/unnamed-chunk-8-6.png" width="1440" style="display: block; margin: auto;" />
This is actually already interesting! We can see that some many of these countries have very big outbreaks in a specific year, or over a couple of years, while a peak in one country doesn’t necessarily translate in one elsewhere. Peru, for example, had a big outbreak in 1995, and hasn’t had many cases since. Brazil, however, did not report manby cases until 2017 when it detected a huge outbreak that lasted until 2018.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="statistics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="case-study-dengue-fever-in-brazil.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/stends2001/EpiBible/blob/main08-working-with-epidemiological-data.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["EpiBible.pdf", "EpiBible.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
